(function(){var t,n,e,r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,k,x,C,S,q,N,W,T,E,O,Y,z,X,I,M,A,P,F,j,R,L,B,V,D,G,H,U,J,K,Q,Z,tn,nn,en,rn,on,un,an,sn,cn,ln,fn,hn,dn,pn,vn,gn,mn,wn,bn,yn,_n,kn,xn,Cn,Sn,qn,Nn,Wn,Tn,En,On,Yn,zn,Xn,In,Mn,An,Pn,Fn,jn,Rn,Ln,Bn,Vn,Dn,Gn,Hn,Un,$n,Jn,Kn,Qn,Zn,te,ne,ee,re,ie,oe,ue,ae,se,ce,le,fe,he,de,pe,ve,ge,me,we,be,ye,_e,ke,xe,Ce,Se,qe,Ne,We,Te,Ee,Oe,Ye,ze,Xe,Ie,Me,Ae,Pe,Fe,je,Re,Le,Be,Ve,De,Ge,He,Ue,$e,Je,Ke,Qe,Ze,tr,nr,er,rr,ir,or,ur,ar,sr,cr,lr,fr,hr,dr,pr,vr,gr,mr,wr,br,yr,_r,kr,xr,Cr,Sr,qr,Nr,Wr,Tr,Er,Or,Yr,zr,Xr,Ir,Mr,Ar,Pr,Fr,jr,Rr,Lr,Br,Vr,Dr,Gr,Hr,Ur,$r,Jr,Kr,Qr,Zr,ti,ni,ei,ri,ii,oi,ui,ai,si,ci,li,fi,hi,di,pi,vi,gi,mi,wi,bi,yi,_i,ki,xi,Ci,Si,qi,Ni,Wi,Ti,Ei,Oi,Yi,zi,Xi,Ii,Mi,Ai,Pi,Fi,ji,Ri,Li,Bi,Vi,Di,Gi,Hi,Ui,$i,Ji,Ki,Qi,Zi,to,no,eo,ro,io,oo,uo,ao,so,co,lo,fo,ho,po,vo,go,mo,wo,bo,yo,_o,ko,xo,Co,So,qo,No,Wo,To,Eo,Oo,Yo,zo,Xo,Io,Mo,Ao,Po,Fo,jo,Ro,Lo,Bo,Vo,Do,Go,Ho,Uo,$o,Jo,Ko,Qo,Zo,tu,nu,eu,ru,iu,ou,uu,au,su,cu,lu,fu,hu,du,pu,vu,gu,mu,wu,bu,yu,_u,ku,xu,Cu,Su,qu,Nu,Wu,Tu,Eu,Ou,Yu,zu,Xu,Iu,Mu,Au,Pu,Fu,ju,Ru,Lu,Bu,Vu,Du,Gu,Hu,Uu,$u,Ju,Ku,Qu,Zu,ta,na,ea,ra,ia,oa,ua,aa,sa,ca,la,fa,ha,da,pa,va,ga,ma,wa,ba,ya,_a,ka,xa=[].slice,Ca=function(t,n){function e(){this.constructor=t}for(var r in n)Sa.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},Sa={}.hasOwnProperty;ma=Math.PI,wa=2*ma,an=ma/2,ga=1e-6,H=ga*ga,Rn=ma/180,R=180/ma,Oe=Math.tan(30*Rn),pe=Math.sqrt(3),x=16581375,Me="transparent",Ee="undefined",Se="null",_e="Boolean",Te="String",qe="Number",Ce="Function",Ne="Object",ye="Array",be="Arguments",ke="Date",We="RegExp",xe="Error",pa=function(t){var n;if(n=Object.prototype.toString.call(t),null===t)return Se;if(void 0===t)return Ee;if(t===!0||t===!1||"[object Boolean]"===n)return _e;switch(n){case"[object String]":return Te;case"[object Number]":return qe;case"[object Function]":return Ce;case"[object Object]":return Ne;case"[object Array]":return ye;case"[object Arguments]":return be;case"[object Date]":return ke;case"[object RegExp]":return We;case"[object Error]":return xe;default:return n}},Cn=function(){function t(t,n){this.match=t,this.func=n}return t}(),_i=function(){var t,n;return t=function(n){var e,r,i;switch(r=pa(n)){case Ee:return function(t){return void 0===t};case Se:return function(t){return null===t};case _e:return function(t){return n===Boolean||t===n};case Te:return function(t){return n===String||t===n};case qe:return function(t){return n===Number||t===n||_.isNaN(t)&&_.isNaN(n)};case We:return function(){return n===RegExp};case Error:return function(){return n===Error};case ke:return function(t){return n===Date||t===n};case ye:return 1===n.length&&Ce===(i=pa(n[0]))?(e=t(n[0]),function(t){var n,r,i;if(ye!==pa(t))return!1;for(r=0,i=t.length;i>r;r++)if(n=t[r],!e(n))return!1;return!0}):function(t){return n===Array||cr(n,t)};case Ce:return function(t){var e;return t instanceof n?!0:t&&t.constructor===n?!0:(e=pa(t),n===Boolean&&e===_e||n===String&&e===Te||n===Number&&e===qe)};case Ne:return function(t){var e,r;for(e in n)if(r=n[e],t[e]!==r)return!1;return!0};default:return function(){return!1}}},n=function(n){var e;return e=_.map(n,t),function(t){var n,r,i,o;if(0===t.length)return!1;if(t.length!==e.length)return!1;for(r=i=0,o=e.length;o>i;r=++i)if(n=e[r],!n(t[r]))return!1;return!0}},function(){var t,e;return t=1<=arguments.length?xa.call(arguments,0):[],e=_.map(t,function(t){var e,r,i;return r=2<=t.length?xa.call(t,0,i=t.length-1):(i=0,[]),e=t[i++],new Cn(n(r),e)}),function(){var t,n,r,i;for(t=1<=arguments.length?xa.call(arguments,0):[],r=0,i=e.length;i>r;r++)if(n=e[r],n.match(t))return n.func.apply(null,t);throw new Error("Pattern match failure for args [ "+_.map(t,function(t){return""+t+":"+pa(t)}).join(", ")+" ]")}}}(),sr=function(t,n){return new(t.bind.apply(t,[null].concat(n)))},g=function(){function t(t,n){this.put=t,this.test=n}return t}(),xn=function(){function t(t,n){this.put=t,this.test=n}return t}(),ce=function(){function t(t,n){this.width=t,this.height=n}return t}(),Vn=function(){function t(t,n,e,r){this.left=t,this.top=n,this.width=e,this.height=r}return t}(),Je=function(){function t(t,n,e,r,i,o,u){this.name=t,this.label=n,this.type=e,this.at=r,this.count=i,this.domain=o,this.format=u}return t}(),J=function(t){function n(t,e,r,i,o,u,a,s){this.valueAt=o,n.__super__.constructor.call(this,t,e,r,i,u,a,s)}return Ca(n,t),n}(Je),wn=function(t){function n(t,e,r,i,o,u){n.__super__.constructor.call(this,t,e,Ne,r,i,o,u)}return Ca(n,t),n}(Je),on=function(){function t(){}return t}(),en=function(){function t(t,n,e,r,i,o,u,a,s){this.label=t,this.vectors=n,this.schema=e,this.indices=r,this.cube=i,this.at=o,this.evaluate=u,this.attach=a,this.metadata=s}return t}(),Ae=function(){function t(t){this.value=t}return t}(),Sn=function(t){function n(t){n.__super__.constructor.call(this,t)}return Ca(n,t),n}(Ae),ve=function(t){function n(t){n.__super__.constructor.call(this,t)}return Ca(n,t),n}(Ae),j=function(t){function n(t){n.__super__.constructor.call(this,t)}return Ca(n,t),n}(Ae),a=function(t){function n(t){n.__super__.constructor.call(this,t)}return Ca(n,t),n}(Ae),Q=function(){function t(t){this.name=t}return t}(),bn=function(t){function n(t){this.evaluate=t}return Ca(n,t),n}(Q),Gn=function(t){function n(t){this.evaluate=t}return Ca(n,t),n}(Q),Z=function(){function t(t,n){this.color=t,this.opacity=n}return t}(),ge=function(){function t(t,n,e){this.color=t,this.opacity=n,this.size=e}return t}(),ee=function(){function t(t){this.fields=t}return t}(),Bn=function(){function t(t){this.index=t}return t}(),kn=function(){function t(){}return t}(),zn=function(t){function n(t,n,e,r,i,o,u,a,s){this.position=t,this.shape=n,this.size=e,this.fillColor=r,this.fillOpacity=i,this.strokeColor=o,this.strokeOpacity=u,this.lineWidth=a,this.tooltip=s}return Ca(n,t),n}(kn),Wn=function(t){function n(t,n,e,r,i){this.position=t,this.strokeColor=n,this.strokeOpacity=e,this.lineWidth=r,this.tooltip=i}return Ca(n,t),n}(kn),Un=function(t){function n(t,n,e,r,i){this.position=t,this.strokeColor=n,this.strokeOpacity=e,this.lineWidth=r,this.tooltip=i}return Ca(n,t),n}(kn),Dn=function(t){function n(t,n,e,r,i,o,u,a,s){this.position=t,this.width=n,this.height=e,this.fillColor=r,this.fillOpacity=i,this.strokeColor=o,this.strokeOpacity=u,this.lineWidth=a,this.tooltip=s}return Ca(n,t),n}(kn),e=function(){function t(){}return t}(),vn=function(t){function n(t,n,e,r){this.position=t,this.strokeColor=n,this.strokeOpacity=e,this.lineWidth=r}return Ca(n,t),n}(e),n=function(){function t(){}return t}(),pn=function(t){function n(t,n,e,r,i){this.slope=t,this.intercept=n,this.strokeColor=e,this.strokeOpacity=r,this.lineWidth=i,this.render=Ku}return Ca(n,t),n}(n),_n=function(){function t(){}return t}(),In=function(t){function n(t,n,e,r,i,o,u,a,s,c,l){this.space=t,this.positionX=n,this.positionY=e,this.shape=r,this.size=i,this.fillColor=o,this.fillOpacity=u,this.strokeColor=a,this.strokeOpacity=s,this.lineWidth=c,this.tooltip=l,this.geometry=Xn}return Ca(n,t),n}(_n),Kn=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.space=t,this.q0=n,this.q1=e,this.q2=r,this.q3=i,this.qn=o,this.positionY=u,this.height=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f,this.geometry=Jn}return Ca(n,t),n}(_n),te=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.space=t,this.positionX=n,this.q0=e,this.q1=r,this.q2=i,this.q3=o,this.qn=u,this.width=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f,this.geometry=Zn}return Ca(n,t),n}(_n),b=function(t){function n(t,n,e,r,i,o,u,a,s,c,l){this.space=t,this.positionX=n,this.positionY1=e,this.positionY2=r,this.width=i,this.fillColor=o,this.fillOpacity=u,this.strokeColor=a,this.strokeOpacity=s,this.lineWidth=c,this.tooltip=l,this.geometry=w}return Ca(n,t),n}(_n),u=function(t){function n(t,n,e,r,i,u,a,s,c,l,f){this.space=t,this.positionX1=n,this.positionX2=e,this.positionY=r,this.height=i,this.fillColor=u,this.fillOpacity=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f,this.geometry=o}return Ca(n,t),n}(_n),En=function(t){function n(t,n,e,r,i,o,u){this.space=t,this.positionX=n,this.positionY=e,this.strokeColor=r,this.strokeOpacity=i,this.lineWidth=o,this.tooltip=u,this.geometry=Tn}return Ca(n,t),n}(_n),Ye=function(t){function n(t,n,e,r,i,o,u,a){this.space=t,this.positionX=n,this.positionY=e,this.text=r,this.size=i,this.fillColor=o,this.fillOpacity=u,this.tooltip=a,this.geometry=TextGeometry}return Ca(n,t),n}(_n),G=function(){function t(){}return t}(),Yn=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.positionX=t,this.positionY=n,this.shape=e,this.size=r,this.fill=i,this.fillColor=o,this.fillOpacity=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Ca(n,t),n}(G),$n=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.q0=t,this.q1=n,this.q2=e,this.q3=r,this.qn=i,this.positionY=o,this.height=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Ca(n,t),n}(G),Qn=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.positionX=t,this.q0=n,this.q1=e,this.q2=r,this.q3=i,this.qn=o,this.width=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Ca(n,t),n}(G),m=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.positionX=t,this.positionY1=n,this.positionY2=e,this.width=r,this.fill=i,this.fillColor=o,this.fillOpacity=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Ca(n,t),n}(G),i=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.positionX1=t,this.positionX2=n,this.positionY=e,this.height=r,this.fill=i,this.fillColor=o,this.fillOpacity=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Ca(n,t),n}(G),Nn=function(t){function n(t,n,e,r,i,o,u){this.positionX=t,this.positionY=n,this.stroke=e,this.strokeColor=r,this.strokeOpacity=i,this.lineWidth=o,this.tooltip=u}return Ca(n,t),n}(G),de=function(){function t(t,n){this.x=t,this.y=n}return t}(),he=function(){function t(t,n,e){this.type=t,this.vectors=n,this.domain=e}return t}(),r=function(){function t(){}return t}(),f=function(t){function n(t,n,e,r,i,o,u){this.type=t,this.label=n,this.scale=e,this.domain=r,this.range=i,this.rect=o,this.guide=u}return Ca(n,t),n}(r),Pn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(r),mn=function(t){function n(t,n,e,r,i,o,u){this.type=t,this.label=n,this.scale=e,this.domain=r,this.range=i,this.rect=o,this.guide=u}return Ca(n,t),n}(Pn),ze=function(){function t(t,n){this.value=t,this.label=n}return t}(),D=function(){function t(t,n){this.label=t,this.encode=n}return t}(),N=function(t){function n(t){this.value=t,n.__super__.constructor.call(this,"Constant",ar(this.value))}return Ca(n,t),n}(D),Fe=function(t){function n(t,e,r){this.vector=r,n.__super__.constructor.call(this,t,e)}return Ca(n,t),n}(D),Ie=function(t){function n(t){this.vectors=t,n.__super__.constructor.call(this,"tooltips")}return Ca(n,t),n}(D),An=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Ca(n,t),n}(Fe),k=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Ca(n,t),n}(Fe),qn=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Ca(n,t),n}(Fe),fe=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Ca(n,t),n}(Fe),ue=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Ca(n,t),n}(Fe),v=function(){function t(){}return t}(),y=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(v),A=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(v),Mn=function(t){function n(t){this.coordinates=t}return Ca(n,t),n}(v),tn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(v),nn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(v),me=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(v),we=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(v),le=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(v),tr=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(v),cn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(v),gn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(v),oe=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(v),Xe=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(v),q=function(t){function n(t){this.value=t}return Ca(n,t),n}(A),Pe=function(t){function n(t){this.field=t}return Ca(n,t),n}(A),W=function(t){function n(t){this.value=t}return Ca(n,t),n}(tn),je=function(t){function n(t,n){this.field=t,this.range=n}return Ca(n,t),n}(tn),T=function(t){function n(t){this.value=t}return Ca(n,t),n}(nn),Re=function(t){function n(t,n){this.field=t,this.range=n}return Ca(n,t),n}(nn),X=function(t){function n(t){this.value=t}return Ca(n,t),n}(me),Ge=function(t){function n(t,n){this.field=t,this.range=n}return Ca(n,t),n}(me),I=function(t){function n(t){this.value=t}return Ca(n,t),n}(we),He=function(t){function n(t,n){this.field=t,this.range=n}return Ca(n,t),n}(we),z=function(t){function n(t){this.value=t}return Ca(n,t),n}(le),De=function(t){function n(t,n){this.field=t,this.range=n}return Ca(n,t),n}(le),M=function(t){function n(t){this.value=t}return Ca(n,t),n}(tr),$e=function(t){function n(t,n){this.field=t,this.range=n}return Ca(n,t),n}(tr),E=function(t){function n(t){this.value=t}return Ca(n,t),n}(cn),Le=function(t){function n(t,n){this.field=t,this.range=n}return Ca(n,t),n}(cn),O=function(t){function n(t){this.value=t}return Ca(n,t),n}(gn),Be=function(t){function n(t,n){this.field=t,this.range=n}return Ca(n,t),n}(gn),Y=function(t){function n(t){this.value=t}return Ca(n,t),n}(oe),Ve=function(t){function n(t,n){this.field=t,this.range=n}return Ca(n,t),n}(oe),Ue=function(t){function n(t){this.fields=t}return Ca(n,t),n}(Xe),U=function(){function t(t,n){this.min=t,this.max=n}return t}(),Ln=function(){function t(){}return t}(),h=function(t){function n(t){this.values=t}return Ca(n,t),n}(Ln),Fn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(Ln),ie=function(t){function n(t,n){this.min=t,this.max=n}return Ca(n,t),n}(Fn),V=function(t){function n(t,n,e){this.min=t,this.mid=n,this.max=e}return Ca(n,t),n}(Fn),S=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Ca(n,t),n}(Ln),re=function(t){function n(t,n){this.min=t,this.max=n}return Ca(n,t),n}(S),B=function(t){function n(t,n,e){this.min=t,this.mid=n,this.max=e}return Ca(n,t),n}(S),rn=function(){function t(t,n,e,r,i){this.encode=t,this.mask=n,this.highlight=e,this.render=r,this.select=i}return t}(),F=function(){function t(t){this.read=t}return t}(),l=function(){function t(t,n,e,r){this.element=t,this.context=n,this.bounds=e,this.ratio=r}return t}(),Ke=function(){function t(t,n,e,r,i,o,u,a,s,c,l){this.box=t,this.container=n,this.baseCanvas=e,this.highlightCanvas=r,this.hoverCanvas=i,this.maskCanvas=o,this.clipCanvas=u,this.marquee=a,this.tooltip=s,this.mask=c,this.clip=l}return t}(),fn=function(){function t(t,n,e,r,i,o){this.encodings=t,this.encoders=n,this.mask=e,this.highlight=r,this.render=i,this.select=o}return t}(),Qe=function(){function t(t,n,e,r,i,o,u,a){this.viewport=t,this.frame=n,this.test=e,this.highlight=r,this.hover=i,this.selectAt=o,this.selectWithin=u,this.render=a}return t}(),On=function(){function t(t,n,e){this.element=t,this.subscribe=n,this.unsubscribe=e}return t}(),s=function(){function t(t,n){this.width=t,this.height=n}return t}(),Hn=function(){function t(t,n,e,r,i){this.center=t,this.left=n,this.top=e,this.right=r,this.bottom=i}return t}(),yn=function(){function t(t,n,e,r){this.left=t,this.top=n,this.right=e,this.bottom=r}return t}(),c=function(){function t(t,n,e){var r;this.width=t,this.height=n,this.margin=e,this.regions=new Hn(r=new Vn(e.left,e.top,t-e.left-e.right,n-e.top-e.bottom),new Vn(0,e.top,e.left,r.height),new Vn(e.left+r.width,e.top,e.right,r.height),new Vn(e.left,0,r.width,e.top),new Vn(e.left,e.top+r.height,r.width,e.bottom))}return t}(),jn=function(){function t(t,n,e,r){this.where=t,this.limit=n,this.group=e,this.having=r}return t}(),d=function(){function t(t,n){this.key=t,this.value=n}return t}(),t=new d(0,"All"),P=function(){function t(t,n,e,r){this.frame=t,this.hierarchy=n,this.cells=e,this.dimension=r}return t}(),hn=function(){function t(t,n,e){this.category=t,this.indices=n,this.children=e}return t}(),p=function(){function t(t,n){this.levels=t,this.indices=n}return t}(),K=function(){function t(t,n,e,r,i){this.at=t,this.valueAt=n,this.count=e,this.domain=r,this.format=i}return t}(),un=function(){function t(t){this.fields=t}return t}(),Ze=function(){function t(t,n){this.fields=t,this.predicate=n}return t}(),dn=function(){function t(t,n){this.offset=t,this.length=n}return t}(),sn=function(){function t(t,n){this.fields=t,this.predicate=n}return t}(),ln=function(){function t(t,n){this.vectors=t,this.index=n}return t}(),ne=function(){function t(t,n){this.vectors=t,this.indices=n}return t}(),L=function(){function t(t){this.vectors=t}return t}(),fr=function(t){var n;return n=parseFloat(t),_.isNaN(n)?void 0:n},lr=function(t){var n;return n=parseInt(t,10),_.isNaN(n)?void 0:n},hr=function(t){return null!=t?t:void 0},ha=function(t){return t*t},mr=function(t,n){return function(e){return t>e?t:e>n?n:e}},gr=mr(0,1),yi=8,Or=function(t){return t.slice(0)},vo=function(t,n){var e,r,i,o,u,a,s,c;for(i=[],o=0,a=t.length;a>o;o++)for(e=t[o],c=n(e),u=0,s=c.length;s>u;u++)r=c[u],i.push(r);return i},Ao=function(){var t,n;return n=arguments[0],t=2<=arguments.length?xa.call(arguments,1):[],function(){return n.apply(null,t)}},ar=function(t){return function(){return t}},cr=function(t,n){var e,r,i,o;if(t&&n&&t.length===n.length){for(e=i=0,o=t.length;o>i;e=++i)if(r=t[e],r!==n[e])return!1;return!0}return!1},co=function(){var t,n,e,r,i,o,u,a,s;for(n=arguments[0],i=2<=arguments.length?xa.call(arguments,1):[],e=[],o=0,a=n.length;a>o;o++)for(t=n[o],u=0,s=i.length;s>u;u++)r=i[u],t instanceof r&&e.push(t);return e},ho=function(){var t,n,e,r,i,o,u,a;for(n=arguments[0],r=2<=arguments.length?xa.call(arguments,1):[],i=0,u=n.length;u>i;i++)for(t=n[i],o=0,a=r.length;a>o;o++)if(e=r[o],t instanceof e)return t},po=function(t,n){var e,r,i,o;for(o=[],r=0,i=n.length;i>r;r++)e=n[r],o.push(ho(t,e));return o},Hr=function(t,n){return n>t?new U(t,n):new U(n,t)},qr=function(t){var n,e,r,i,o;for(e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,i=0,o=t.length;o>i;i++)r=t[i],void 0!==r&&(e>=r&&(e=r),r>=n&&(n=r));return new U(e,n)},Nr=function(t,n){var e,r,i,o,u;for(i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,e=u=0;t>=0?t>u:u>t;e=t>=0?++u:--u)void 0!==(o=n(e))&&(i>=o&&(i=o),o>=r&&(r=o));return new U(i,r)},Er=function(t){return function(n){return n.min>=t&&n.max>t?1:n.min<t&&n.max<=t?-1:0}},Tr=Er(0),xr=function(t,n){return new U(Math.min(t.min,n.min),Math.max(t.max,n.max))},Co=function(t){return function(n){return n.min>t&&n.max>t?new U(t,n.max):n.min<t&&n.max<t?new U(n.min,t):n}},xo=Co(0),Ei=function(t,n,e){return $.ajax({dataType:t,url:n,success:function(t){return e(null,t)},error:function(t,n,r){return e(r)}})},ni=function(t,n,e){var r,i,o;return i=function(){return n.length},r=function(t){return n[t]},o=e?function(t){return e(n[t],t)}:r,new wn(t,t,r,i,n,o)},mi=function(t,n,e,r){return ka(t,t,n,e,r)},ka=function(t,n,e,r,i){var o,u,a,s;return a=qr(r),u=function(){return r.length},o=function(t){return r[t]},s=i?function(t){return i(r[t],t)}:o,new Je(t,n,e,o,u,a,s)},Qr=function(t,n,e,r,i,o){var u,a;return u=Nr(r,i),a=o?function(t){return o(i(t),t)}:i,new Je(t,n,e,i,r,u,a)},so=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,p,v,g;for(g=0,p={},l=n(),o=new Array(l),u=function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)f=e[t],r.push(p[f]=new d(g++,f));return r}(),c=v=0;l>=0?l>v:v>l;c=l>=0?++v:--v)a=t(c),f=void 0!==a?a:"?",(i=p[f])||u.push(p[f]=i=new d(g++,f)),o[c]=i;return r=function(t){return o[t]},h=function(t){return o[t].value},s=function(t){return o[t].value},new K(r,h,n,u,s)},Ur=function(t,n,e,r){var i,o,u;return o=function(){return e.length},i=function(t){return e[t]},u=so(i,o,r||[]),new J(t,t,n,u.at,u.valueAt,o,u.domain,u.format)},zr=function(t,n){var e,r,i,o,u,a;return i="All",r=new d(0,i),a=function(){return i},e=function(){return r},o=function(){return n},u=function(){return i},new J(t,t,Te,e,a,o,[r],u)},Kr=function(t,n,e,r,i){var o,u;return u=_.indexBy(n,function(t){return t.name}),o=new en(t,n,u,e,r,null,null,null,i||{}),o.evaluate=function(n){var e,i,a,s;return i=_.isArray(n)?n:[n],a=function(){var a,c,l;for(l=[],a=0,c=i.length;c>a;a++)if(e=i[a],e instanceof bn)l.push(o.evaluate(e.evaluate(o)));else if(e instanceof Gn){if(!r)throw new Error("Cannot compute aggregate ["+e.name+"] on an unaggregated frame.");l.push(o.evaluate(e.evaluate(o,r)))}else{if(!(e instanceof Q))throw new Error("Cannot evaluate ["+n+"] on frame ["+t+"].");if(!(s=u[e.name]))throw new Error("Vector ["+e.name+"] does not exist in frame ["+t+"].");l.push(s)}return l}(),_.flatten(a)},o.attach=function(e){if(u[e.name])throw new Error("Cannot attach vector ["+e.name+"]: a vector by that name already exists in frame ["+t+"]");return n.push(e),u[e.name]=e,e},o.exists=function(t){return u[t]?!0:!1},o},Fi=function(t){var n,e,r,i,o,u,a,s,c,l,f;for(u=new Array(t.indices.length),e=_.map(t.vectors,function(t){return t instanceof J?t.valueAt:t.at}),f=t.indices,a=0,c=f.length;c>a;a++)for(r=f[a],u[r]=o=new Array(t.vectors.length),i=s=0,l=e.length;l>s;i=++s)n=e[i],o[i]=n(r);return u},si=function(t){return new jn(co(t,Ze),co(t,dn),co(t,un),co(t,sn))},Jr=function(t){return _.map(t,function(t){return new Q(t)})},$r=function(t){return new bn(function(n){var e,r,i,o,u,a,s,c;if(s=_.head(n.evaluate(t)),s instanceof J)return t;for(u=s.count(),e=s.at,i=new Array(u),o=c=0;u>=0?u>c:c>u;o=u>=0?++c:--c)void 0!==(a=e(o))&&(i[o]=""+a);return n.attach(r=Ur("factor("+s.label+")",Te,i)),[new Q(r.name)]})},Xr=function(t){return new bn(function(n){return n.attach(zr(t,n.indices.length)),[new Q(t)]})},Ko=_i([String,function(t){return Ko(new Q(t))}],[Q,function(t){return $r(t)}],[ve,function(t){var n;return n=t.value,Xr(n)}]),pi=function(t,n){return new bn(function(e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,k,x,C,S,q;if(b=_.head(e.evaluate(t)),b instanceof J)throw new Error("Cannot stack factor ["+b.label+"]: expecting vector.");for(d=b.count(),m=new Array(d),c=new Array(d),g="low("+b.name+", "+n+")",s="high("+b.name+", "+n+")",r=b.at,o=e.cube,n=Math.min(n,o.dimension),i=o.cells,v=a=0,y=new Array(n),q=e.indices,k=0,S=q.length;S>k;k++){for(l=q[k],p=i[l].levels,f=x=0;n>=0?n>x:x>n;f=n>=0?++x:--x)if(y[f]!==p[f].category){for(v=a=0,h=C=0;n>=0?n>C:C>n;h=n>=0?++C:--C)y[h]=p[h].category;break}w=r(l),0>w?(m[l]=v,c[l]=v+=w):(m[l]=a,c[l]=a+=w)}return u=function(t,n){return b.format(n)},e.attach(ka(g,b.name,b.type,m,u)),e.attach(ka(s,b.name,b.type,c,u)),[new Q(g),new Q(s)]})},Wu=_i([String,Number,function(t,n){return Wu(new Q(t),n)}],[Q,Number,function(t,n){return pi(t,n)}]),Au=function(t){var n;return n=mr(0,t.length-1),function(e){return t[n(-1+Math.round(e*t.length))]}},Wr=function(t){var n,e,r,i,o,u,a,s;return s=function(){var n,e,r;for(r=[],n=0,e=t.length;e>n;n++)a=t[n],(a||0===a)&&r.push(a);return r}(),s.sort(function(t,n){return t-n}),e=s[0],n=s[s.length-1],u=Au(s),r=u(.25),i=u(.5),o=u(.75),[e,r,i,o,n]},er=function(t){var n,e,r,i,o;for(e=0,n=0,i=0,o=t.length;o>i;i++)r=t[i],void 0!==r&&(e+=r,n++);return e/n},rr=function(t){var n,e,r,i;for(n=0,r=0,i=t.length;i>r;r++)e=t[r],void 0!==e&&n++;return n},ir=function(t){var n,e,r,i;for(n=Number.NEGATIVE_INFINITY,r=0,i=t.length;i>r;r++)e=t[r],void 0!==e&&e>=n&&(n=e);return n},or=function(t){var n,e,r,i;for(n=Number.POSITIVE_INFINITY,r=0,i=t.length;i>r;r++)e=t[r],void 0!==e&&n>=e&&(n=e);return n},ur=function(t){var n,e,r,i;for(n=0,r=0,i=t.length;i>r;r++)e=t[r],void 0!==e&&(n+=e);return n},Yr=function(t,n,e,r,i){return new Gn(function(o,u){var a,s,c,l,f,h,d,p,v,g,m,w,b,y,k,x;if(d=n+"("+t.name+")",o.exists(d))return new Q(d);for(g=_.head(u.frame.evaluate(t)),a=g.at,l=new Array(u.cells.length),k=u.cells,h=m=0,b=k.length;b>m;h=++m){for(s=k[h],v=[],x=s.indices,w=0,y=x.length;y>w;w++)f=x[w],void 0!==(p=a(f))&&v.push(p);l[h]=i(v)}return o.attach(c=mi(d,e,l,r)),[new Q(c.name)]})},Bo=function(t,n,e,r){return _i([String,function(i){return Yr(new Q(i),t,n,e,r)}],[Q,function(i){return Yr(i,t,n,e,r)}])},Ho=Bo("count",qe,_.identity,rr),Vo=Bo("avg",qe,_.identity,er),du=Bo("max",qe,_.identity,ir),pu=Bo("min",qe,_.identity,or),Ou=Bo("sum",qe,_.identity,ur),eu=function(){var t,n,e;return n=1<=arguments.length?xa.call(arguments,0):[],e=function(){var e,r,i;for(i=[],e=0,r=n.length;r>e;e++)if(t=n[e],t instanceof Q)i.push(t);else{if(!_.isString(t))throw new Error("Cannot group by ["+t+"]");i.push(new Q(t))}return i}(),new un(e)},Lo=_i([[String],Function,function(t,n){return new Ze(Jr(t),n)}]),Xu=function(){var t,n,e;return n=2<=arguments.length?xa.call(arguments,0,e=arguments.length-1):(e=0,[]),t=arguments[e++],Lo(n,t)},cu=_i([Number,Number,function(t,n){return new dn(t,n)}],[Number,function(t){return new dn(0,t)}]),Ro=_i([[String],Function,function(t,n){return new sn(Jr(t),n)}],[[Q],Function,function(t,n){return new sn(t,n)}]),iu=function(){var t,n,e;return n=2<=arguments.length?xa.call(arguments,0,e=arguments.length-1):(e=0,[]),t=arguments[e++],Ro(n,t)},Jo=function(t){return function(n){return n===t}},vu=function(t){return function(n){return n!==t}},hu=function(t){return function(n){return t>n}},ru=function(t){return function(n){return n>t}},au=function(t){return function(n){return t>=n}},nu=function(t){return function(n){return n>=t}},su=function(t){if(We!==pa(t))throw new Error("like ["+t+"]: expecting RegExp");return function(n){return t.test(n)}},uu=function(t){return function(n){var e,r,i;for(r=0,i=t.length;i>r;r++)if(e=t[r],e===n)return!0;return!1}},gu=function(t){return function(n){var e,r,i;for(r=0,i=t.length;i>r;r++)if(e=t[r],e===n)return!1;return!0}},Pu=function(n,e){var r,i,o,u,a,s,c,l,f,h,d;return c=e.where.length?Kr(n.label,n.vectors,fo(n,e.where)):n,h=e.group.length?(s=vo(e.group,function(t){return t.fields}),u=function(){var t,n,e;for(e=[],t=0,n=s.length;n>t;t++){if(a=s[t],d=_.head(c.evaluate(a)),!(d instanceof J))throw new Error("Cannot group by ["+a.name+"]: not a Factor.");e.push(d)}return e}(),l={0:new hn(t,c.indices,{})},dr(l,u,0),i=[],yr(l[0].children,s.length-1,i,0,new Array(s.length)),o=new P(c,l,i,s.length),r=nr(c.label+"'",o,u),e.having.length?Kr(r.label,r.vectors,fo(r,e.having),r.cube):r):c,e.limit.length?(f=e.limit[e.limit.length-1],Kr(h.label,h.vectors,h.indices.slice(f.offset,f.offset+f.length))):h},fo=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p,v,g,m;for(h=t.indices,f=0,v=n.length;v>f;f++){for(c=n[f],a=[],l=function(){var n,e,r,i;for(r=c.fields,i=[],n=0,e=r.length;e>n;n++)o=r[n],i.push(_.head(t.evaluate(o)));return i}(),i=_.map(l,function(t){return t instanceof J?t.valueAt:t.at}),d=0,g=h.length;g>d;d++){for(u=h[d],e=new Array(l.length),s=p=0,m=i.length;m>p;s=++p)r=i[s],e[s]=r(u);c.predicate.apply(null,e)&&a.push(u)}h=a}return h},nr=function(t,n,e){var r,i,o;return r=_.range(n.cells.length),o=function(){var t,r,o;for(o=[],i=t=0,r=n.dimension;r>=0?r>t:t>r;i=r>=0?++t:--t)o.push(ao(n,e[i],i));return o}(),Kr(t,o,r,n)},dr=function(t,n,e){var r,i,o,u,a,s,c,l,f,h;r=n[e].at;for(s in t){for(c=t[s],u=c.children,h=c.indices,l=0,f=h.length;f>l;l++)a=h[l],i=r(a),(o=u[i.key])||(u[i.key]=o=new hn(i,[],{})),o.indices.push(a);e<n.length-1&&dr(u,n,e+1)}},yr=function(t,n,e,r,i){var o,u;for(o in t)u=t[o],i[r]=u,r===n?e.push(new p(Or(i),u.indices)):yr(u.children,n,e,r+1,i)},ao=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v;for(a=new Array(t.cells.length),s={},c=[],v=t.cells,f=d=0,p=v.length;p>d;f=++d)o=v[f],a[f]=i=o.levels[e].category,s[i.value]||(s[i.value]=i,c.push(i));return r=function(t){return a[t]},h=function(t){return a[t].value},l=function(t){return a[t].value},u=function(){return a.length},new J(n.label,n.label,n.type,r,h,u,c,l)},C={c10:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],c20:["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],c20b:["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],c20c:["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"]},Po=function(t){return t>10?C.c20:C.c10},br=function(t){var n,e,r,i;return i=t.rgb(),r=i[0],e=i[1],n=i[2],chroma.rgb(r,e,n)},kr=function(t,n){return n>=0&&1>n?br(t).alpha(n).css():t.css()},Oi=function(t,n,e,r){var i;return i=Math.sqrt(r/ma),t.beginPath(),t.arc(n,e,i,0,wa,!1),t.closePath()},Xi=function(t,n,e,r){var i;return i=.5*Math.sqrt(r),t.save(),t.translate(n,e),t.beginPath(),t.moveTo(i,i),t.lineTo(-i,i),t.lineTo(-i,-i),t.lineTo(i,-i),t.closePath(),t.restore()},Yi=function(t,n,e,r){var i,o;return i=.5*Math.sqrt(r/5),o=3*i,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(o,i),t.lineTo(i,i),t.lineTo(i,o),t.lineTo(-i,o),t.lineTo(-i,i),t.lineTo(-o,i),t.lineTo(-o,-i),t.lineTo(-i,-i),t.lineTo(-i,-o),t.lineTo(i,-o),t.lineTo(i,-i),t.lineTo(o,-i),t.closePath(),t.restore()},zi=function(t,n,e,r){var i,o;return o=Math.sqrt(r/(2*Oe)),i=o*Oe,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(i,0),t.lineTo(0,o),t.lineTo(-i,0),t.lineTo(0,-o),t.closePath(),t.restore()},Pi=function(t,n,e,r){var i,o;return i=Math.sqrt(r/pe),o=i*pe/2,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(0,-o),t.lineTo(i,o),t.lineTo(-i,o),t.closePath(),t.restore()},Ii=function(t,n,e,r){var i,o;return i=Math.sqrt(r/pe),o=i*pe/2,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(0,o),t.lineTo(i,-o),t.lineTo(-i,-o),t.closePath(),t.restore()},Ai=function(t,n,e,r){var i,o;return o=Math.sqrt(r/pe),i=o*pe/2,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(i,0),t.lineTo(-i,o),t.lineTo(-i,-o),t.closePath(),t.restore()},Mi=function(t,n,e,r){var i,o;return o=Math.sqrt(r/pe),i=o*pe/2,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(-i,0),t.lineTo(i,-o),t.lineTo(i,o),t.closePath(),t.restore()},se={circle:Oi,square:Xi,cross:Yi,diamond:zi,triangleUp:Pi,triangleDown:Ii,triangleLeft:Mi,triangleRight:Ai},ae={c8:["circle","square","cross","diamond","triangleUp","triangleDown","triangleLeft","triangleRight"]},Fo=function(){return ae.c8},ua=function(t){return function(n){return void 0!==n?t(n):void 0}},ii=function(t,n){var e;return e=d3.scale.linear().domain([t.min,t.max]).range([n.min,n.max]).nice(),[ua(e),e.tickFormat,e.ticks]},oi=function(t,n){var e,r,i,o,u,a,s;for(a=0,o={},u=0,s=t.length;s>u;u++)e=t[u],o[e.key]=a++;return r=(n.max-n.min)/t.length/2,i=n.min,ua(function(t){return i+2*o[t.key]*r+r})},Fr=function(t,n){var e,r;return r=n.values,e=r.length,ua(function(t){return r[t.key%e]})},hi=function(t,n){return ua(d3.scale.linear().domain([t.min,t.max]).range([n.min,n.max]))},Vr=function(t,n){return ua(d3.scale.linear().domain([t.min,t.mid,t.max]).range([n.min,n.mid,n.max]))
},fi=function(t,n){return ua(chroma.scale([n.min,n.max]).domain([t.min,t.max]).mode("lch"))},Br=function(t,n){var e,r;return e=chroma.scale([n.min,n.mid]).domain([t.min,t.mid]).mode("lch"),r=chroma.scale([n.mid,n.max]).domain([t.mid,t.max]).mode("lch"),function(n){return void 0!==n?n<t.mid?e(n):r(n):void 0}},Rr=_i([ie,S,fi],[V,S,Br]),ti=_i([ie,ie,hi],[V,V,Vr]),pr=function(t){var n;return n=t.toString(16),1===n.length?"0"+n:n},jr=function(t){var n,e,r,i;return n=t.context,r=t.ratio,e=function(){return"#fff"},i=function(t,e){var i,o,u,a,s;return s=n.getImageData(t*r,e*r,1,1).data,a=s[0],u=s[1],o=s[2],i=s[3],255===a&&255===u&&255===o&&255===i},new g(e,i)},ri=function(t){var n,e,r,i,o,u;return n=t.context,i=t.ratio,u=0,e={},r=function(t){var n,r,i,o;return r=u++,u>=x&&(u=0),e[r]=t,o=r>>16&255,i=r>>8&255,n=255&r,"#"+pr(o)+pr(i)+pr(n)},o=function(t,r){var o,u,a,s,c,l;return l=n.getImageData(t*i,r*i,1,1).data,c=l[0],s=l[1],u=l[2],o=l[3],255===o?(a=(c<<16)+(s<<8)+u,e[a]):void 0},new xn(r,o)},Ki=function(t,n){var e,r,i,o,u,a,s;return s=t.scale,r=t.domain,a=t.range,o=t.guide,u=n.label,e=n.at,i=function(t){return s(e(t))},new An(u,i,n,r,a,o)},Vi=function(t,n){return new N(t.scale(n))},Bi=function(t,n){var e,r,i,o,u,a,s;return n instanceof je||n instanceof Ge?(s=_.head(t.evaluate(n.field)),s instanceof J?(n.range||(n.range=new h(Po(s.domain.length))),u=Fr(s.domain,n.range),e=s.at,i=function(t){return chroma(u(e(t)))},new k(s.label,i,s,s.domain,n.range,null)):(r=function(){switch(Tr(s.domain)){case 1:return new ie(s.domain.min,s.domain.max);case-1:return new ie(s.domain.min,s.domain.max);default:return new V(s.domain.min,0,s.domain.max)}}(),a=Tr(r),o=n.range?n.range instanceof B?r instanceof ie?1===a?new re(n.range.mid,n.range.max):new re(n.range.min,n.range.mid):n.range:(r instanceof V?r=new ie(r.min,r.max):void 0,n.range):r instanceof ie?1===a?new re("#deebf7","#3182bd"):new re("#e6550d","#fee6ce"):new B("#fc8d59","#ffffbf"),u=Rr(r,o),e=s.at,i=function(t){return u(e(t))},new k(s.label,i,s,r,o,null))):new N(n.value)},Ui=function(t,n){var e,r,i,o,u,a;if(n instanceof Re||n instanceof He){if(a=_.head(t.evaluate(n.field)),a instanceof J)throw new Error("Could not encode opacity. Vector ["+a.label+"] is a Factor.");return r=new ie(a.domain.min,a.domain.max),o=n.range?new ie(gr(n.range.min),gr(n.range.max)):n.range=new ie(.05,1),u=ti(r,o),e=a.at,i=function(t){return u(e(t))},new qn(a.label,i,a,r,o,null)}return new N(gr(n.value))},ro=function(t,n){var e,r;return t&&n?(e=t.encode,r=n.encode,new Fe("("+t.label+", "+n.label+")",function(t){return kr(e(t),r(t))})):void 0},uo=function(t,n){return function(e,r,i){var o,u,a,s,c,l;if(r instanceof t){if(l=_.head(e.evaluate(r.field)),l instanceof J)throw new Error("Could not encode size. Vector ["+l.label+"] is a Factor.");return u=new ie(l.domain.min,l.domain.max),s=r.range?new ie(gr(r.range.min),gr(r.range.max)):r.range=new ie(.05,1),c=ti(u,s),o=l.at,a=function(t){return i*c(o(t))},new n(l.label,a,u,s,null)}return new N(i*gr(r.value))}},no=uo(De,fe),oo=uo($e,fe),Gi=uo(Le,fe),ji=function(t,n){var e,r,i,o,u,a;if(n instanceof De){if(a=_.head(t.evaluate(n.field)),a instanceof J)throw new Error("Could not encode size. Vector ["+a.label+"] is a Factor.");return r=new ie(a.domain.min,a.domain.max),o=n.range?new ie(ha(n.range.min),ha(n.range.max)):n.range=new ie(ha(yi),ha(30)),u=ti(r,o),e=a.at,i=function(t){return u(e(t))},new fe(a.label,i,a,r,o,null)}return new N(ha(n.value))},Hi=function(t,n){var e,r,i,o,u,a;if(n instanceof Be){if(a=_.head(t.evaluate(n.field)),a instanceof J)throw new Error("Could not encode lineWidth. Vector ["+a.label+"] is a Factor.");return r=new ie(a.domain.min,a.domain.max),o=n.range?new ie(n.range.min,n.range.max):n.range=new ie(1.5,15),u=ti(r,o),e=a.at,i=function(t){return u(e(t))},new fe(a.label,i,a,r,o,null)}return new N(n.value)},to=function(t,n){var e,r,i,o;if(n instanceof Ve){if(o=_.head(t.evaluate(n.field)),!(o instanceof J))throw new Error("Could not encode shape. Vector ["+o.label+"] is not a Factor.");return n.range||(n.range=new h(Fo(o.domain.length))),i=Fr(o.domain,n.range),e=o.at,r=function(t){return se[i(e(t))]},new ue(o.label,r,o,o.domain,n.range,null)}return new N(se[n.value]||se.circle)},io=function(t,n){var e,r;return n?(r=function(){var r,i,o,u;for(o=n.fields,u=[],r=0,i=o.length;i>r;r++)e=o[r],u.push(_.head(t.evaluate(e)));return u}(),new Ie(r)):void 0},So=function(t,n){return[null!=t?t:new W(chroma(_.head(C.c10))),null!=n?n:new T(1)]},No=function(t,n,e){return[null!=t?t:new X(chroma(_.head(C.c10))),null!=n?n:new I(1),null!=e?e:new O(1.5)]},qo=function(t,n,e,r,i,o,u){var a,s,c,l;return a=t||n,s=e||r||i,a||s||(o&&(a=!0),u&&(s=!0)),a&&(c=So(t,n),t=c[0],n=c[1]),s&&(l=No(e,r,i),e=l[0],r=l[1],i=l[2]),[t,n,e,r,i]},Di=function(t,n){var e,r;return n.fillColor||n.fillOpacity?[e=Bi(t,n.fillColor),r=Ui(t,n.fillOpacity),ro(e,r)]:[]},eo=function(t,n){var e,r;return n.strokeColor||n.strokeOpacity||n.lineWidth?[e=Bi(t,n.strokeColor),r=Ui(t,n.strokeOpacity),ro(e,r),Hi(t,n.lineWidth)]:[]},wr=function(t,n,e,r,i){return t.beginPath(),t.rect(n,e,r,i),t.clip()},Ti=function(t,n,e){return t.lineWidth=e,t.strokeStyle=n,t.stroke()},xi=function(t,n){return t.fillStyle=n,t.fill()},Ci=function(t,n,e,r,i){return t.beginPath(),t.moveTo(n,e),t.lineTo(r,i),t.stroke()},qi=function(t,n,e,r,i){return t.beginPath(),r>e?t.rect(n-i/2,e,i,r-e):t.rect(n-i/2,r,i,e-r),t.closePath()},Si=function(t,n,e,r,i){return t.beginPath(),e>n?t.rect(n,r-i/2,e-n,i):t.rect(e,r-i/2,n-e,i),t.closePath()},Ni=function(t,n,e,r,i,o,u,a,s,c){var l,f;return void 0!==n&&void 0!==e&&void 0!==r&&void 0!==i&&void 0!==o&&void 0!==u&&void 0!==a&&void 0!==s&&void 0!==c?(t.strokeStyle=s,t.lineWidth=c,Si(t,e,i,u,a),t.stroke(),l=a/2,f=a/4,Ci(t,r,u-l,r,u+l),Ci(t,e,u,n,u),Ci(t,i,u,o,u),Ci(t,n,u-f,n,u+f),Ci(t,o,u-f,o,u+f)):void 0},Wi=function(t,n,e,r,i,o,u,a,s,c){var l,f;return void 0!==n&&void 0!==e&&void 0!==r&&void 0!==i&&void 0!==o&&void 0!==u&&void 0!==a&&void 0!==s&&void 0!==c?(t.strokeStyle=s,t.lineWidth=c,qi(t,n,r,o,a),t.stroke(),l=a/2,f=a/4,Ci(t,n-l,i,n+l,i),Ci(t,n,r,n,e),Ci(t,n,o,n,u),Ci(t,n-f,e,n+f,e),Ci(t,n-f,u,n+f,u)):void 0},Ku=function(t,n,e,r){var i,o,u,a,s,c,l,f,h;u=t.slope,i=t.intercept,a=t.strokeColor,s=t.strokeOpacity,o=t.lineWidth,void 0!==i?0===u?e instanceof Pn&&(c=n.range.min,l=n.range.max,f=h=e.scale(i)):n instanceof Pn&&e instanceof Pn&&(c=n.scale(n.domain.min),l=n.scale(n.domain.max),f=e.scale(u*n.domain.min+i),h=e.scale(u*e.domain.max+i)):n instanceof Pn&&(c=l=n.scale(u),f=e.range.min,h=e.range.max),void 0!==c&&void 0!==f&&void 0!==l&&void 0!==h&&(r.save(),r.strokeStyle=kr(a,s),r.lineWidth=o,Ci(r,c,f,l,h),r.restore())},Zr=function(t){var n,e,r,i,o,u;return u=t.position.coordinates,r=u[0],n=u[1],i=t.strokeColor,o=t.strokeOpacity,e=t.lineWidth,new pn(r?r.value:0,n?n.value:void 0,i?i.value:chroma("red"),o?o.value:1,e?e.value:1.5)},ai=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p;return o=n[0],u=n[1],c=new de([o],[u]),a=null!=(h=t.shape)?h:new Y("circle"),s=null!=(d=t.size)?d:new z(yi),p=qo(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!1,!0),e=p[0],r=p[1],l=p[2],f=p[3],i=p[4],new In(c,o,u,a,s,e,r,l,f,i,t.tooltip)},Ji=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m;return s=Ki(e,n.positionX),c=Ki(r,n.positionY),l=to(t,n.shape),f=ji(t,n.size),g=Di(t,n),o=g[0],u=g[1],i=g[2],m=eo(t,n),d=m[0],p=m[1],h=m[2],a=m[3],v=io(t,n.tooltip),new Yn(s,c,l,f,i,o,u,h,d,p,a,v)},yo=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(u=n.positionX,a=n.positionY,s=n.shape,c=n.size,r=n.fill,l=n.stroke,o=n.lineWidth,e.save(),d=0,v=t.length;v>d;d++)i=t[d],f=u(i),h=a(i),void 0!==f&&void 0!==h&&(s(i)(e,f,h,c(i)),e.lineWidth=2+(l?o(i):1),e.stroke());for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.fillStyle=e.strokeStyle="black",p=0,g=t.length;g>p;p++)i=t[p],f=u(i),h=a(i),void 0!==f&&void 0!==h&&(s(i)(e,f,h,c(i)),l&&(e.lineWidth=o(i),e.stroke()),r&&e.fill());return e.restore()},Xo=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v;for(a=n.positionX,s=n.positionY,c=n.shape,l=n.size,f=n.stroke,o=n.lineWidth,e.save(),p=0,v=t.length;v>p;p++)i=t[p],h=a(i),d=s(i),void 0!==h&&void 0!==d&&(u=r.put(i),c(i)(e,h,d,l(i)),e.fillStyle=u,e.fill(),f&&(e.lineWidth=o(i),e.strokeStyle=u,e.stroke()));return e.restore()},ta=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p;for(u=n.positionX,a=n.positionY,s=n.shape,c=n.size,r=n.fill,l=n.stroke,o=n.lineWidth,e.save(),d=0,p=t.length;p>d;d++)i=t[d],f=u(i),h=a(i),void 0!==f&&void 0!==h&&(s(i)(e,f,h,c(i)),l&&(e.lineWidth=o(i),e.strokeStyle=l(i),e.stroke()),r&&(e.fillStyle=r(i),e.fill()));return e.restore()},ca=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d;for(a=n.positionX,s=n.positionY,c=[],h=0,d=t.length;d>h;h++)u=t[h],l=a(u),f=s(u),void 0!==l&&void 0!==f&&l>=e&&i>=l&&f>=r&&o>=f&&c.push(u);return c},da=function(t){return _.map(t,function(t){return t.type}).join(", ")},ci=function(t,n){var e,r,i,o,a,s,c,l,f,h,d,p,v,g,m,w,y,_,k,x,C,S,q;switch(g=da(n)){case"String, Number":return a=n[0],h=n[1],d=new de([a],[h]),m=null!=(w=t.width)?w:new M(.8),y=qo(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!0,!1),e=y[0],r=y[1],p=y[2],v=y[3],o=y[4],new b(d,a,void 0,h,m,e,r,p,v,o,t.tooltip);case"String, Number, Number":return a=n[0],f=n[1],h=n[2],d=new de([a],[f,h]),m=null!=(_=t.width)?_:new M(.8),k=qo(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!0,!1),e=k[0],r=k[1],p=k[2],v=k[3],o=k[4],new b(d,a,f,h,m,e,r,p,v,o,t.tooltip);case"Number, String":return c=n[0],l=n[1],d=new de([c],[l]),i=null!=(x=t.height)?x:new E(.8),C=qo(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!0,!1),e=C[0],r=C[1],p=C[2],v=C[3],o=C[4],new u(d,void 0,c,l,i,e,r,p,v,o,t.tooltip);case"Number, Number, String":return s=n[0],c=n[1],l=n[2],d=new de([s,c],[l]),i=null!=(S=t.height)?S:new E(.8),q=qo(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!0,!1),e=q[0],r=q[1],p=q[2],v=q[3],o=q[4],new u(d,s,c,l,i,e,r,p,v,o,t.tooltip);default:throw new Error("Cannot create rect marks with vectors of type ["+g+"]")}},Li=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,w;return s=Ki(e,n.positionX),c=n.positionY1?Ki(r,n.positionY1):Vi(r,0),l=Ki(r,n.positionY2),v=no(t,n.width,e.rect.width/e.domain.length),g=Di(t,n),o=g[0],u=g[1],i=g[2],w=eo(t,n),h=w[0],d=w[1],f=w[2],a=w[3],p=io(t,n.tooltip),new m(s,c,l,v,i,o,u,f,h,d,a,p)},Ri=function(t,n,e,r){var o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,_,k;switch(n.space.x.length){case 1:w=n.space.x[0],l=Vi(e,0),f=Ki(e,w);break;default:y=n.space.x,m=y[0],w=y[1],l=Ki(e,m),f=Ki(e,w)}return b=n.space.y[0],h=Ki(r,b),s=no(t,n.height,r.rect.height/r.domain.length),_=Di(t,n),u=_[0],a=_[1],o=_[2],k=eo(t,n),p=k[0],v=k[1],d=k[2],c=k[3],g=io(t,n.tooltip),new i(l,f,h,s,o,u,a,d,p,v,c,g)},wo=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w;for(u=n.positionX,a=n.positionY1,s=n.positionY2,f=n.width,r=n.fill,c=n.stroke,o=n.lineWidth,e.save(),v=0,m=t.length;m>v;v++)i=t[v],h=u(i),d=a(i),p=s(i),l=f(i),void 0!==h&&void 0!==d&&void 0!==p&&void 0!==l&&(qi(e,h,d,p,l),e.lineWidth=2+(c?o(i):1),e.stroke());for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.fillStyle=e.strokeStyle="black",g=0,w=t.length;w>g;g++)i=t[g],h=u(i),d=a(i),p=s(i),l=f(i),void 0!==h&&void 0!==d&&void 0!==p&&void 0!==l&&(qi(e,h,d,p,l),c&&(e.lineWidth=o(i),e.stroke()),r&&e.fill());return e.restore()},mo=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w;for(s=n.positionX1,c=n.positionX2,l=n.positionY,o=n.height,r=n.fill,f=n.stroke,a=n.lineWidth,e.save(),v=0,m=t.length;m>v;v++)u=t[v],h=s(u),d=c(u),p=l(u),i=o(u),void 0!==h&&void 0!==d&&void 0!==p&&void 0!==i&&(Si(e,h,d,p,i),e.lineWidth=2+(f?a(u):1),e.stroke());for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.fillStyle=e.strokeStyle="black",g=0,w=t.length;w>g;g++)u=t[g],h=s(u),d=c(u),p=l(u),i=o(u),void 0!==h&&void 0!==d&&void 0!==p&&void 0!==i&&(Si(e,h,d,p,i),f&&(e.lineWidth=a(u),e.stroke()),r&&e.fill());return e.restore()},Yo=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m;for(a=n.positionX,s=n.positionY1,c=n.positionY2,h=n.width,l=n.stroke,o=n.lineWidth,e.save(),g=0,m=t.length;m>g;g++)i=t[g],d=a(i),p=s(i),v=c(i),f=h(i),void 0!==d&&void 0!==p&&void 0!==v&&void 0!==f&&(u=r.put(i),qi(e,d,p,v,f),xi(e,u),l&&Ti(e,u,o(i)));return e.restore()},Oo=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m;for(c=n.positionX1,l=n.positionX2,f=n.positionY,o=n.height,h=n.stroke,a=n.lineWidth,e.save(),g=0,m=t.length;m>g;g++)u=t[g],d=c(u),p=l(u),v=f(u),i=o(u),void 0!==d&&void 0!==p&&void 0!==v&&void 0!==i&&(s=r.put(u),Si(e,d,p,v,i),xi(e,s),h&&Ti(e,s,a(u)));return e.restore()},Gu=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(u=n.positionX,a=n.positionY1,s=n.positionY2,f=n.width,r=n.fill,c=n.stroke,o=n.lineWidth,e.save(),v=0,g=t.length;g>v;v++)i=t[v],h=u(i),d=a(i),p=s(i),l=f(i),void 0!==h&&void 0!==d&&void 0!==p&&void 0!==l&&(qi(e,h,d,p,l),c&&Ti(e,c(i),o(i)),r&&xi(e,r(i)));return e.restore()},Du=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(s=n.positionX1,c=n.positionX2,l=n.positionY,o=n.height,r=n.fill,f=n.stroke,a=n.lineWidth,e.save(),v=0,g=t.length;g>v;v++)u=t[v],h=s(u),d=c(u),p=l(u),i=o(u),void 0!==h&&void 0!==d&&void 0!==p&&void 0!==i&&(Si(e,h,d,p,i),f&&Ti(e,f(u),a(u)),r&&xi(e,r(u)));return e.restore()},sa=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d,p,v,g,m,w,b,y;for(a=n.positionX,s=n.positionY1,c=n.positionY2,h=n.width,l=[],b=0,y=t.length;y>b;b++)u=t[b],d=a(u),g=s(u),m=c(u),g>m&&(w=g,g=m,m=w),f=h(u),void 0!==d&&void 0!==g&&void 0!==m&&void 0!==f&&(p=d-f/2,v=d+f/2,e>v||p>i||r>m||g>o||l.push(u));return l},aa=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d,p,v,g,m,w,b,y;for(c=n.positionX1,l=n.positionX2,f=n.positionY,a=n.height,h=[],b=0,y=t.length;y>b;b++)s=t[b],d=c(s),p=l(s),g=f(s),d>p&&(v=d,d=p,p=v),u=a(s),void 0!==d&&void 0!==p&&void 0!==g&&void 0!==u&&(m=g-u/2,w=g+u/2,e>p||d>i||r>w||m>o||h.push(s));return h},li=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b;switch(h=da(n)){case"String, Number, Number, Number, Number, Number":return p=n[0],i=n[1],o=n[2],u=n[3],a=n[4],s=n[5],c=new de([p],[i,o,u,a,s]),d=null!=(g=t.width)?g:new M(.8),m=No(t.strokeColor,t.strokeOpacity,t.lineWidth),l=m[0],f=m[1],r=m[2],new te(c,p,i,o,u,a,s,d,l,f,r,t.tooltip);case"Number, Number, Number, Number, Number, String":return i=n[0],o=n[1],u=n[2],a=n[3],s=n[4],v=n[5],c=new de([i,o,u,a,s],[v]),e=null!=(w=t.height)?w:new M(.8),b=No(t.strokeColor,t.strokeOpacity,t.lineWidth),l=b[0],f=b[1],r=b[2],new Kn(c,i,o,u,a,s,v,e,l,f,r,t.tooltip)}},Qi=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g;return u=Ki(e,n.q0),a=Ki(e,n.q1),s=Ki(e,n.q2),c=Ki(e,n.q3),l=Ki(e,n.qn),v=Ki(r,n.positionY),i=no(t,n.height,r.rect.height/r.domain.length),g=eo(t,n),h=g[0],d=g[1],f=g[2],o=g[3],p=io(t,n.tooltip),new $n(u,a,s,c,l,v,i,f,h,d,o,p)},_o=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(u=n.positionY,a=n.q0,s=n.q1,c=n.q2,l=n.q3,f=n.qn,r=n.height,h=n.stroke,o=n.lineWidth,e.save(),d=0,v=t.length;v>d;d++)i=t[d],Ni(e,a(i),s(i),c(i),l(i),f(i),u(i),r(i),h(i),2+(h?o(i):1));for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.strokeStyle="black",p=0,g=t.length;g>p;p++)i=t[p],Ni(e,a(i),s(i),c(i),l(i),f(i),u(i),r(i),h(i),o(i));return e.restore()},Io=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y;for(c=n.positionY,l=n.q0,f=n.q1,h=n.q2,d=n.q3,p=n.qn,o=n.height,v=n.stroke,a=n.lineWidth,e.save(),b=0,y=t.length;y>b;b++)u=t[b],g=l(u),m=p(u),w=c(u),i=o(u),void 0!==g&&void 0!==m&&void 0!==w&&void 0!==i&&(s=r.put(u),Si(e,g,m,w,i),xi(e,s),Ti(e,s,a(u)));return e.restore()},ea=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p;for(u=n.positionY,a=n.q0,s=n.q1,c=n.q2,l=n.q3,f=n.qn,r=n.height,h=n.stroke,o=n.lineWidth,e.save(),d=0,p=t.length;p>d;d++)i=t[d],Ni(e,a(i),s(i),c(i),l(i),f(i),u(i),r(i),h(i),o(i));return e.restore()},la=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,_,k,x,C,S;for(l=n.positionY,f=n.q0,h=n.q1,d=n.q2,p=n.q3,v=n.qn,a=n.height,m=n.stroke,c=n.lineWidth,g=[],C=0,S=t.length;S>C;C++)s=t[C],w=f(s),b=v(s),_=l(s),w>b&&(y=w,w=b,b=y),u=a(s),void 0!==w&&void 0!==b&&void 0!==_&&void 0!==u&&(k=_-u/2,x=_+u/2,e>b||w>i||r>x||k>o||g.push(s));return g},Zi=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g;return v=Ki(e,n.positionX),o=Ki(r,n.q0),u=Ki(r,n.q1),a=Ki(r,n.q2),s=Ki(r,n.q3),c=Ki(r,n.qn),p=no(t,n.width,e.rect.width/e.domain.length),g=eo(t,n),f=g[0],h=g[1],l=g[2],i=g[3],d=io(t,n.tooltip),new Qn(v,o,u,a,s,c,p,l,f,h,i,d)},ko=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(o=n.positionX,u=n.q0,a=n.q1,s=n.q2,c=n.q3,l=n.qn,h=n.width,f=n.stroke,i=n.lineWidth,e.save(),d=0,v=t.length;v>d;d++)r=t[d],Wi(e,o(r),u(r),a(r),s(r),c(r),l(r),h(r),f(r),2+(f?i(r):1));for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.strokeStyle="black",p=0,g=t.length;g>p;p++)r=t[p],Wi(e,o(r),u(r),a(r),s(r),c(r),l(r),h(r),f(r),i(r));return e.restore()},Mo=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y;for(a=n.positionX,s=n.q0,c=n.q1,l=n.q2,f=n.q3,h=n.qn,v=n.width,d=n.stroke,o=n.lineWidth,e.save(),b=0,y=t.length;y>b;b++)i=t[b],g=a(i),m=s(i),w=h(i),p=v(i),void 0!==g&&void 0!==m&&void 0!==w&&void 0!==p&&(u=r.put(i),qi(e,g,m,w,p),xi(e,u),Ti(e,u,o(i)));return e.restore()},ra=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p;for(o=n.positionX,u=n.q0,a=n.q1,s=n.q2,c=n.q3,l=n.qn,h=n.width,f=n.stroke,i=n.lineWidth,e.save(),d=0,p=t.length;p>d;d++)r=t[d],Wi(e,o(r),u(r),a(r),s(r),c(r),l(r),h(r),f(r),i(r));return e.restore()},fa=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,_,k,x,C,S;for(s=n.positionX,c=n.q0,l=n.q1,f=n.q2,h=n.q3,d=n.qn,m=n.width,v=n.stroke,a=n.lineWidth,p=[],C=0,S=t.length;S>C;C++)u=t[C],w=s(u),_=c(u),k=d(u),_>k&&(x=_,_=k,k=x),g=m(u),void 0!==w&&void 0!==_&&void 0!==k&&void 0!==g&&(b=w-g/2,y=w+g/2,e>y||b>i||r>k||_>o||p.push(u));return p},ui=function(t,n){var e,r,i,o,u,a,s;return r=n[0],i=n[1],o=new de([r],[i]),s=No(t.strokeColor,t.strokeOpacity,t.lineWidth),u=s[0],a=s[1],e=s[2],new En(o,r,i,u,a,e,t.tooltip)},$i=function(t,n,e,r){var i,o,u,a,s,c,l,f;return o=Ki(e,n.positionX),u=Ki(r,n.positionY),f=eo(t,n),s=f[0],c=f[1],a=f[2],i=f[3],l=io(t,n.tooltip),new Nn(o,u,a,s,c,i,l)},bo=function(t,n,e){var r,i,o,u,a,s,c;for(i=n.positionX,o=n.positionY,e.save(),s=0,c=t.length;c>s;s++)r=t[s],u=i(r),a=o(r),e.lineWidth=1.5,e.strokeStyle="black",void 0!==u&&void 0!==a&&(Oi(e,u,a,64),e.stroke());return e.restore()},zo=function(t,n,e,r){var i,o,u,a,s,c,l;for(o=n.positionX,u=n.positionY,e.save(),c=0,l=t.length;l>c;c++)i=t[c],a=o(i),s=u(i),void 0!==a&&void 0!==s&&(Oi(e,a,s,64),e.fillStyle=r.put(i),e.fill());return e.restore()},Qu=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,_;if(u=n.positionX,a=n.positionY,s=n.stroke,o=n.lineWidth,s instanceof N&&o instanceof N){for(e.strokeStyle=s(),e.lineWidth=o(),e.save(),w=!1,m=0,y=t.length;y>m;m++)i=t[m],f=u(i),p=a(i),void 0!==f&&void 0!==p?w?e.lineTo(f,p):(e.beginPath(),w=!0,e.moveTo(f,p)):(w&&e.stroke(),w=!1);return e.restore()}for(e.save(),e.lineCap="round",w=!1,h=void 0,v=void 0,c=void 0,b=0,_=t.length;_>b;b++)i=t[b],d=u(i),g=a(i),void 0!==d&&void 0!==g?(l=s(i),w&&(l!==c?(r=e.createLinearGradient(h,v,d,g),r.addColorStop(0,c||Me),r.addColorStop(1,l||Me),e.strokeStyle=r):e.strokeStyle=l,e.lineWidth=o(i),e.beginPath(),e.moveTo(h,v),e.lineTo(d,g),e.stroke()),w=!0,h=d,v=g,c=l):w=!1;return e.restore()},ei=_i([zn,Array,ai],[Wn,Array,ui],[Dn,Array,ci],[Un,Array,li]),Ir=_i([vn,Zr]),Xn=new rn(Ji,Xo,yo,ta,ca),Tn=new rn($i,zo,bo,Qu,ca),w=new rn(Li,Yo,wo,Gu,sa),o=new rn(Ri,Oo,mo,Du,aa),Jn=new rn(Qi,Io,_o,ea,la),Zn=new rn(Zi,Mo,ko,ra,fa),Do=_i([Number,null,function(t){return new s(t,void 0)}],[null,Number,function(t,n){return new s(void 0,n)}],[Number,Number,function(t,n){return new s(t,n)}],[null,null,function(){return new s(void 0,void 0)}]),tu=_i([en,_.identity],[Function,function(t){return new F(t)}]),zu=_i([Number,function(t){return new Sn(t)}],[Boolean,function(t){return new a(t)}],[Date,function(t){return new j(t)}],[String,function(t){return new ve(t)}]),$o=function(){var t;t=1<=arguments.length?xa.call(arguments,0):[]},_u=_i([Array,function(t){return new h(t)}],[Number,function(t){return t>0?new ie(0,t):0>t?new ie(t,0):new V(-1,0,1)}],[String,function(t){return new re(t,"black")}],[Number,Number,function(t,n){return n>=t?new ie(t,n):new ie(n,t)}],[String,String,function(t,n){return new re(t,n)}],[Number,Number,Number,function(t,n,e){var r,i,o,u;return u=_.sortBy([t,n,e],_.identity),r=u[0],i=u[1],o=u[2],new V(r,i,o)}],[String,String,String,function(t,n,e){return new B(t,n,e)}]),_r=function(t){var n,e,r,i,o;for(o=[],r=0,i=t.length;i>r;r++)if(n=t[r],n instanceof Q)o.push(n);else{if(Te!==(e=pa(n)))throw new Error("Cannot create vector reference from ["+n+"] of type ["+e+"].");o.push(new Q(n))}return o},yu=function(){var t,n,e;return n=1<=arguments.length?xa.call(arguments,0):[],new Mn(_.every(n,function(t){return t instanceof Ae})?function(){var e,r,i;for(i=[],e=0,r=n.length;r>e;e++)t=n[e],i.push(new q(t.value));return i}():function(){var t,r,i,o;for(i=_r(n),o=[],t=0,r=i.length;r>t;t++)e=i[t],o.push(new Pe(e));return o}())},Qo=_i([ve,function(t){return new W(chroma(t.value))}],[String,function(t){return new je(new Q(t))}],[Q,function(t){return new je(t)}],[String,S,function(t,n){return new je(new Q(t),n)}],[Q,S,function(t,n){return new je(t,n)}],[String,h,function(t,n){return new je(new Q(t),n)}],[Q,h,function(t,n){return new je(t,n)}]),Zo=_i([Sn,function(t){return new T(t.value)}],[String,function(t){return new Re(new Q(t))}],[Q,function(t){return new Re(t)}],[String,ie,function(t,n){return new Re(new Q(t),n)}],[Q,ie,function(t,n){return new Re(t,n)}]),Tu=_i([ve,function(t){return new X(chroma(t.value))}],[String,function(t){return new Ge(new Q(t))}],[Q,function(t){return new Ge(t)}],[String,S,function(t,n){return new Ge(new Q(t),n)}],[Q,S,function(t,n){return new Ge(t,n)}],[String,h,function(t,n){return new Ge(new Q(t),n)}],[Q,h,function(t,n){return new Ge(t,n)}]),Eu=_i([Sn,function(t){return new I(t.value)}],[String,function(t){return new He(new Q(t))}],[Q,function(t){return new He(t)}],[String,ie,function(t,n){return new He(new Q(t),n)}],[Q,ie,function(t,n){return new He(t,n)}]),ki=function(t,n){return _i([Sn,function(n){return new t(n.value)}],[String,function(t){return new n(new Q(t))}],[Q,function(t){return new n(t)}],[String,ie,function(t,e){return new n(new Q(t),e)}],[Q,ie,function(t,e){return new n(t,e)}])},Nu=ki(z,De),Iu=ki(M,$e),ou=ki(E,Le),fu=_i([Sn,function(t){return new O(t.value)}],[String,function(t){return new Be(new Q(t))}],[Q,function(t){return new Be(t)}],[String,ie,function(t,n){return new Be(new Q(t),n)}],[Q,ie,function(t,n){return new Be(t,n)}]),qu=_i([ve,function(t){return new Y(t.value)}],[String,function(t){return new Ve(new Q(t))}],[Q,function(t){return new Ve(t)}],[String,h,function(t,n){return new Ve(new Q(t),n)}],[Q,h,function(t,n){return new Ve(t,n)}]),Yu=function(){var t;return t=1<=arguments.length?xa.call(arguments,0):[],new Ue(_r(t))},Cu=function(){var t,n;return n=1<=arguments.length?xa.call(arguments,0):[],1===n.length&&_.isNumber(t=_.head(n))?new Bn(t):new ee(_r(n))},ju=function(t){var n,e,r,i,o;for(o=[],e=0,r=t.length;r>e;e++)switch(n=t[e],n.type){case"string":o.push({label:n.name,type:"String",domain:null!=(i=n.lightningDomain)?i:[],parse:hr});break;case"integer":o.push({label:n.name,type:"Number",parse:lr});break;case"number":o.push({label:n.name,type:"Number",parse:fr});break;default:throw new Error("Invalid type ["+n.type+"] for schema field ["+n.name+"]")}return o},Fu=function(t,n,e,r){var i,o,u,a,s,c,l,f;return a=Papa.parse(e,{skipEmptyLines:!0}),c=a.data,r&&c.shift(),f=function(){var t,r,a,f,h;for(h=[],u=t=0,a=n.length;a>t;u=++t){for(i=n[u],e=new Array(c.length),o=r=0,f=c.length;f>r;o=++r)s=c[o],void 0!==(l=i.parse(s[u]))&&(e[o]=l);switch(i.type){case"String":h.push(Ur(i.label,i.type,e,i.domain));break;case"Number":h.push(mi(i.label,i.type,e,_.identity));break;default:h.push(void 0)}}return h}(),Kr(t,f,_.range(c.length))},Go=function(t,n,e,r,i){return function(o){var u,a,s,c,l,f;return l=Math.floor((e-n)/r),u=function(t){return n+t*r},s=function(t,n){var e;return e=function(t){return n(u(t))},Qr(t,t,"Number",l,e,_.identity)},f=function(){var t;t=[];for(c in i)a=i[c],t.push(s(c,a));return t}(),f.unshift(Qr(t,t,"Number",l,u,_.identity)),o(null,Kr("computed",f,_.range(l)))}},Uo=function(t){return function(n){return Ei("json",t+"/datapackage.json",function(e,r){var i,o;return e?n(e):(i=_.head(r.resources))?(o=i.path)?Ei("text",t+"/"+o,function(t,e){if(t)return n(t);try{return n(null,Fu(r.name,ju(i.schema),e,!0))}catch(o){return t=o,n(t)}}):n(new Error("Resource is missing attribute [path].")):n(new Error("No resources found in data package."))})}},Gr=function(){var t,n;return t=arguments[0],n=2<=arguments.length?xa.call(arguments,1):[],function(){var e;return e=1<=arguments.length?xa.call(arguments,0):[],sr(t,po(e,n))}},bu=Gr(zn,Mn,oe,le,tn,nn,me,we,gn,Xe),ku=Gr(Dn,Mn,tr,cn,tn,nn,me,we,gn,Xe),wu=Gr(Wn,Mn,me,we,gn,Xe),xu=Gr(Un,Mn,tr,cn,me,we,gn,Xe),lu=Gr(vn,Mn,me,we,gn),mu=function(t,n){var e;return e=function(t,n){var r,i,o,u;if(_.isArray(t)){for(i=t.length,o=[];i--;)r=t[i],null!==r&&_.isObject(r)?(e(r,n),o.push(n(r))):o.push(void 0);return o}u=[];for(i in t)Sa.call(t,i)&&(r=t[i],null!==r&&_.isObject(r)?(e(r,n),u.push(n(r))):u.push(void 0));return u},function(r){var i;return i=t.parse(r),e(i,function(t){var n;"CallExpression"===t.type&&"Identifier"===t.callee.type?_.isFunction(jo[n=t.callee.name])&&(t.callee={type:"MemberExpression",computed:!1,object:{type:"Identifier",name:"plot"},property:{type:"Identifier",name:n}}):"Identifier"===t.type&&_.isFunction(jo[n=t.name])&&(delete t.name,t.type="MemberExpression",t.computed=!1,t.object={type:"Identifier",name:"plot"},t.property={type:"Identifier",name:n})}),n.generate(i)}},Su={maxCanvasSize:new ce(795,600),visualizationSize:new ce(300,300),axisLabelFont:"10px monospace",axisTickColor:"#4d4d4d",axisTitleFont:"bold 10px monospace",axisLabelColor:"#4d4d4d",gridLineColor:"#eee",originLineColor:"#ccc"},Mu=function(t){return Math.round(t)+"px"},Lr=function(t,n){var e,r,i,o;e=document.createElement(t),i=e.style;for(r in n)o=n[r],i[r]=o;return e},Ru=function(t){for(var n;n=t.firstChild;)t.removeChild(n)},vi=function(t){var n,e;n=document.createElement("style"),n.type="text/css",n.innerHTML=t,e=_.head(document.getElementsByTagName("head")),e.appendChild(n)},gi=function(t){var n,e,r,i,o,u,a;e=document.createElement("table"),e.appendChild(r=document.createElement("tbody"));for(n in t)a=t[n],r.appendChild(u=document.createElement("tr")),u.appendChild(i=document.createElement("td")),i.appendChild(document.createTextNode(n+":")),u.appendChild(o=document.createElement("th")),o.appendChild(document.createTextNode(a));return e},Pr=function(t){var n,e,r,i,o,u,a;return a=t.width,o=t.height,i=document.createElement("canvas"),e=i.getContext("2d"),r=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,u=r/n,i.style.position="absolute",r!==n?(i.width=a*u,i.height=o*u,e.scale(u,u),i.style.width=Mu(a),i.style.height=Mu(o)):(i.width=a,i.height=o),new l(i,e,t,u)},wi=function(t){var n,e,r,i,o,u,a,s,c,l,f,h;return h=function(){var n,e;for(e=[],a=n=1;5>=n;a=++n)e.push(Pr(t));return e}(),n=h[0],o=h[1],u=h[2],l=h[3],r=h[4],i=Lr("div",{position:"relative",overflow:"visible",width:Mu(t.width),height:Mu(t.height)}),i.className="lz",s=Lr("div",{position:"absolute",left:Mu(0),top:Mu(0),width:Mu(0),height:Mu(0),display:"none",outline:"1px dotted #999",background:"rgba(0, 0, 0, 0.05)"}),f=Lr("div",{position:"absolute",left:Mu(0),top:Mu(0),"max-width":Mu(.9*t.width),display:"none"}),f.className="lz-tooltip",i.appendChild(n.element),i.appendChild(o.element),i.appendChild(s),i.appendChild(u.element),i.appendChild(f),c=ri(l),e=jr(r),new Ke(t,i,n,o,u,l,r,s,f,c,e)},go=function(t){var n,e,r;return e=null!=(r=t.target)?r:t.srcElement,n=e.getBoundingClientRect(),[t.clientX-n.left,t.clientY-n.top]},vr=function(t,n,e,r,i){var o,u,a,s,c,l,f,h,d,p;u=$(document),o=$(t),s=n.style,c=h=l=d=f=p=0,a=!1,o.on("mousemove",function(t){var n;return c=t.offsetX,h=t.offsetY,(void 0===c||void 0===h)&&(n=go(t),c=n[0],h=n[1]),a?(s.left=Mu(c>l?l:c),s.top=Mu(h>d?d:h),s.width=Mu(Math.abs(c-l)),s.height=Mu(Math.abs(h-d))):e(c,h)}),o.on("mousedown",function(t){var n;return t.preventDefault(),l=t.offsetX,d=t.offsetY,(void 0===l||void 0===d)&&(n=go(t),l=n[0],d=n[1]),a=!0,s.display="block",s.left=Mu(l),s.top=Mu(d),u.on("mouseup",function(t){var n;return t.preventDefault(),f=t.offsetX,p=t.offsetY,(void 0===f||void 0===p)&&(n=go(t),f=n[0],p=n[1]),a=!1,s.display="none",s.width=Mu(0),s.height=Mu(0),u.off("mouseup"),Math.abs(l-f)>5||Math.abs(d-p)>5?r(l,d,f,p):i(l,d)})})},Dr=function(){var t,n,e,r;return r={},n=function(t,n){var e;return(e=r[t])?e.push(n):r[t]=[n]},e=function(t,n){var e,i,o,u,a;if(t)if(n){if(o=r[t])for(e=u=0,a=o.length;a>u;e=++u)if(i=o[e],i===n){o.splice(e,1);break}}else delete r[t]},t=function(){var t,n,e,i,o,u;if(n=arguments[0],t=2<=arguments.length?xa.call(arguments,1):[],i=r[n])for(o=0,u=i.length;u>o;o++)e=i[o],e.apply(null,t)},[n,e,t]},bi=function(t,n,e,r,i,o,u){var a,s,c,l,f,h,d,p,v,g,m,w,b,y,_,k,x,C,S,q,N,W,T;return T=wi(t),a=T.baseCanvas,d=T.highlightCanvas,v=T.hoverCanvas,c=T.clipCanvas,w=T.maskCanvas,g=T.marquee,C=T.tooltip,m=T.mask,s=T.clip,S=t.regions.center,N=n.indices,q=void 0,x=function(n,r){var i,o,u,a,l;if(o=m.test(n,r),void 0!==o)for(i=c.context,i.clearRect(0,0,t.width,t.height),a=0,l=e.length;l>a;a++)if(u=e[a],i.save(),i.translate(S.left,S.top),u.mask([o],u.encoders,i,s),i.restore(),s.test(n,r))return o},l=function(t,n,e){var r;return r=gi(e),Ru(C),C.appendChild(r),C.style.display="block",b(t,n)},W=7,b=function(n,e){var r,i,o,u;if("none"!==C.style.display)return u=C.clientWidth,o=C.clientHeight,r=n+W,i=e-W-o,r+u>t.width&&(r=n-W-u),0>i&&(i=e+W),0>r&&(r=0),0>i&&(i=0),C.style.left=Mu(r),C.style.top=Mu(i)},f=function(){return C.style.display="none"},p=function(r,i){var o,a,s,c,h,d,p,g,m,w,y,_,k,C,N;if(c=x(r,i),c!==q){if(q=c,s=v.context,s.clearRect(0,0,t.width,t.height),f(),void 0!==c){for(s.save(),s.translate(S.left,S.top),g=0,y=e.length;y>g;g++)h=e[g],h.highlight([c],h.encoders,s);for(s.restore(),u("hover",new ln(n.vectors,c)),d={},m=0,_=e.length;_>m;m++){h=e[m],C=h.encodings;for(o in C)if(a=C[o])if(a instanceof Fe)(p=a.vector)&&(d[p.label]=p.format(c));else if(a instanceof Ie)for(N=a.vectors,w=0,k=N.length;k>w;w++)p=N[w],d[p.label]=p.format(c)}l(r,i,d)}}else b(r,i)},h=function(n){var r,i,o,u;if(r=d.context,r.clearRect(0,0,t.width,t.height),n.length){for(a.element.style.opacity=.5,r.save(),r.translate(S.left,S.top),o=0,u=e.length;u>o;o++)i=e[o],i.highlight(n,i.encoders,r),i.render(n,i.encoders,r);r.restore()}else a.element.style.opacity=1},_=function(t,e){var r;r=x(t,e),void 0!==r?(h([r]),u("select",new ne(n.vectors,[r]))):(h([]),u("deselect",new L(n.vectors)))},k=function(t,r,i,o){var a,s,c,l,f,d,p,v;for(l=-S.left+(t>i?i:t),c=-S.left+(t>i?t:i),d=-S.top+(r>o?o:r),f=-S.top+(r>o?r:o),p=0,v=e.length;v>p;p++)a=e[p],s=a.select(N,a.encoders,l,d,c,f),h(s),s.length?u("select",new ne(n.vectors,s)):u("deselect",new L(n.vectors))},y=function(){var n,u,s,c,l,f,h,d;for(u=a.context,c=w.context,Uu(u,i,S),$u(u,o,S),u.save(),u.translate(S.left,S.top),c.save(),c.translate(S.left,S.top),l=0,h=e.length;h>l;l++)s=e[l],s.render(N,s.encoders,u),s.mask(N,s.encoders,c,m);for(f=0,d=r.length;d>f;f++)n=r[f],n.render(n,i,o,u);c.restore(),u.restore(),Bu(u,i,t.regions.bottom),Vu(u,o,t.regions.left)},vr(v.element,g,p,k,_),new Qe(T,n,x,h,p,_,k,y)},Lu=function(t,n,e,r,i){var o,u,a,s,c,l,h,d,p,v,g,m,w,b,y,_,k,x,C,S,q;if(t.font=Su.axisLabelFont,t.fillStyle=Su.axisLabelColor,t.strokeStyle=Su.axisTickColor,t.textBaseline="middle",_=ba+4,d=e-_,t.save(),wr(t,_,0,d,r),t.textAlign="right",y=e-5,l=e-6,n instanceof f){for(o=n.guide(),v=Math.floor(r/(ba+2)),a=Math.floor(o.length/v),s=k=0,C=o.length;C>k;s=++k)u=o[s],m=n.scale(u),b=-.5+Math.round(m),Ci(t,y,b,e,b),(0===a||0!==s&&0===s%a)&&t.fillText(u.value,l,m,d-6);
Ci(t,e-.5,0,e-.5,r)}else{if(!(n instanceof Pn))throw new Error("Invalid axis type.");for(g=6,p=r-6,q=n.guide(),x=0,S=q.length;S>x;x++)w=q[x],c=w.label,m=n.scale(w.value),b=Math.max(.5,-.5+Math.round(m)),Ci(t,y,b,e,b),h=g>m?g:m>p?p:m,t.fillText(c,l,h,d-6);Ci(t,e-.5,0,e-.5,r)}return t.restore(),t.font=Su.axisTitleFont,t.textAlign="center",t.translate(_/2,r/2),t.rotate(i*an),t.fillText(n.label,0,0,r),t.restore()},Hu=function(t,n,e,r){var i,o,u,a,s;if(t.strokeStyle=Su.gridLineColor,n instanceof f)Ci(t,0,.5,e,.5),Ci(t,0,r-.5,e,r-.5);else if(n instanceof Pn){for(s=n.guide(),u=0,a=s.length;a>u;u++)i=s[u],o=Math.max(.5,-.5+Math.round(n.scale(i.value))),Ci(t,0,o,e,o);n.domain.min<=0&&0<=n.domain.max&&(t.strokeStyle=Su.originLineColor,o=Math.max(.5,-.5+Math.round(n.scale(0))),Ci(t,0,o,e,o))}},Uu=function(t,n,e){return t.save(),t.translate(e.left,e.top+e.height),t.rotate(-an),Hu(t,n,e.height,e.width),t.restore()},$u=function(t,n,e){return t.save(),t.translate(e.left,e.top),Hu(t,n,e.width,e.height),t.restore()},Bu=function(t,n,e){return t.save(),t.translate(e.left,e.top+e.height),t.rotate(-an),Lu(t,n,e.height,e.width,1),t.restore()},Vu=function(t,n,e){return t.save(),t.translate(e.left,e.top),Lu(t,n,e.width,e.height,-1),t.restore()},Ju=function(t){var n;return n=document.createElement("div"),n.innerHTML=t,n.childNodes[0]},lo=function(t,n){var e,r,i,o,u,a,s;for(r={},i=[],a=0,s=n.length;s>a;a++)o=n[a],u=(e=t.at(o)).key,r[u]||(r[u]=!0,i.push(e));return i},di=function(t,n){var e,r,i,o,u,a;for(r=null,e=null,a=null,o=0,u=t.length;u>o;o++)if(i=t[o],null===r)switch(r=i.type){case Te:a=i,e=lo(i,n);break;case qe:e=i.domain;break;default:throw new Error("ni")}else{if(r!==i.type)throw new Error("Incompatible axis vector ["+i.label+"]. Expect type ["+r+"], got ["+i.type+"]");switch(r){case Te:if(a!==i)throw new Error("Incompatible categorical vector ["+i.label+"]. Expected ["+a.label+"].");break;case qe:e=xr(e,i.domain);break;default:throw new Error("ni")}}return new he(r,t,e)},Ar=function(t){var n,e;return n=function(){var n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(e.label);return i}(),_.unique(n).join(", ")},Cr=function(t,n){var e,r,i,o,u,a,c,l,h,d,p,v,g;if(c=new Vn(0,0,400,400),e=Mr(t,"",n,new ie(0,c.width),c),a=ba+4+6+10,e instanceof f){for(u=0,r=e.guide(),h=0,p=r.length;p>h;h++)i=r[h],u<(o=(""+i.value).length)&&(u=o);return new s(Math.ceil(u*ba+a),Math.ceil(r.length*(ba+8)))}if(e instanceof Pn){for(u=0,r=e.guide(),g=e.guide(),d=0,v=g.length;v>d;d++)l=g[d],u<(o=l.label.length)&&(u=o);return new s(Math.ceil(u*ba+a),Su.visualizationSize.height)}throw new Error("Invalid axis type.")},Mr=function(t,n,e,r,i){var o,u,a,s,c;switch(t){case Te:return u=oi(e,r),o=function(){return e},new f(t,n,u,e,r,i,o);case qe:return c=ii(e,r),u=c[0],a=c[1],s=c[2],o=function(t){var n,e,r,i,o,u;for(null==t&&(t=10),n=a(t),o=s(t),u=[],r=0,i=o.length;i>r;r++)e=o[r],u.push(new ze(e,n(e)));return u},new mn(t,n,u,e,r,i,o);default:throw new Error("Unhandled axis type ["+t+"].")}},oa=function(t,n){var e,r;return r=si(n),e=Pu(t,r),ho(n,ee)?ia(e,n):ho(n,Bn)?na(e,n):Zu(e,n)},na=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p,v,g,m;return u=ho(n,Bn),i=u.index,m=diecut("table.lz-record","tbody","tr","th","td"),s=m[0],c=m[1],h=m[2],f=m[3],l=m[4],d=function(){var n,e;n=t.schema,e=[];for(o in n)g=n[o],v=g.format(i),r=function(){switch(g.type){case Te:return void 0!==v?_.escape(v):"-";case qe:return void 0!==v?_.escape(v):"-";case Ne:return void 0!==v?v:"-";default:throw new Error("Cannot render table cell of type "+g.type)}}(),e.push(h([f(_.escape(g.label)),l(r)]));return e}(),e=Ju(s(c(d))),a=_.noop,p=_.noop,new On(e,a,p)},ia=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,k,x,C;return o=ho(n,ee),k=function(){var n,e,i,u;if(o.fields.length){for(i=o.fields,u=[],n=0,e=i.length;e>n;n++)r=i[n],u.push(t.evaluate(r));return u}return t.vectors}(),x=_.flatten(k),C=diecut("table.lz-table","thead","tbody","tr","th","th.lz-number","td","td.lz-number"),a=C[0],d=C[1],s=C[2],g=C[3],h=C[4],p=C[5],c=C[6],l=C[7],v=function(){var t,n,e;for(e=[],t=0,n=x.length;n>t;t++)switch(y=x[t],y.type){case qe:e.push(p(_.escape(y.label)));break;default:e.push(h(_.escape(y.label)))}return e}(),m=function(){var n,e,r,o;for(r=t.indices,o=[],n=0,e=r.length;e>n;n++)i=r[n],f=function(){var t,n,e;for(e=[],t=0,n=x.length;n>t;t++)switch(y=x[t],b=y.format(i),y.type){case Te:e.push(c(void 0!==b?_.escape(b):"-"));break;case qe:e.push(l(void 0!==b?_.escape(b):"-"));break;case Ne:e.push(c(void 0!==b?b:"-"));break;default:throw new Error("Cannot render table cell of type "+y.type)}return e}(),o.push(g(f));return o}(),e=Ju(a([d(g(v)),s(m)])),u=_.noop,w=_.noop,new On(e,u,w)},Sr=function(t,n){return t.type===qe&&n.type===Te?xo(t.domain):t.domain},Zu=function(t,n){var r,i,o,u,a,l,f,h,d,p,v,g,m,w,b,y,k,x,C,S,q,N,W,T,E,O,Y,z,X,I;return b=_.map(co(n,kn),function(n){var e,r;return r=function(){var r,i,o,u;for(o=n.position.coordinates,u=[],r=0,i=o.length;i>r;r++)e=o[r],u.push(t.evaluate(e.field));return u}(),ei(n,_.flatten(r))}),q=_.map(b,function(t){return t.space}),T=vo(q,function(t){return t.x}),E=vo(q,function(t){return t.y}),C=di(T,t.indices),S=di(E,t.indices),g=Sr(C,S),m=Sr(S,C),i=Cr(C.type,g),o=Cr(S.type,m),h=null!=(Y=ho(n,s))?Y:new s(void 0,void 0),p=null!=(z=h.width)?z:Math.min(Su.maxCanvasSize.width,o.width+i.height),d=null!=(X=h.height)?X:Math.min(Su.maxCanvasSize.height,i.width+o.height),v=new c(p,d,new yn(Math.min(.3*Su.maxCanvasSize.width,o.width),0,0,Math.min(.3*Su.maxCanvasSize.height,i.width))),u=v.regions.bottom,a=v.regions.left,k=new ie(0,u.width),x=S.type===qe?new ie(a.height,0):new ie(0,a.height),l=Mr(C.type,Ar(T),g,k,u),f=Mr(S.type,Ar(E),m,x,a),w=_.map(b,function(n){var e,r,i,o,u;i=n.geometry,r=i.encode(t,n,l,f),e={};for(o in r)u=r[o],(null!=u?u.encode:void 0)&&(e[o]=u.encode);return new fn(r,e,i.mask,i.highlight,i.render,i.select)}),r=_.map(co(n,e),function(t){return Ir(t)}),I=Dr(),N=I[0],W=I[1],y=I[2],O=bi(v,t,w,r,l,f,y),O.render(),new On(O.viewport.container,N,W)},va=_i([F,Array,Function,function(t,n,e){return t.read(function(t,r){return t?e(t):va(r,n,e)})}],[en,Array,Function,function(t,n,e){var r;try{return e(null,oa(t,n))}catch(i){return r=i,e(r)}}]),Eo=function(){return vi(".lz-tooltip {\n  background: #2c2c2c;\n  color: #fff;\n  font-size: 12px;\n}\n.lz-tooltip th, .lz-tooltip td {\n  padding: 0px 4px;\n  vertical-align: middle;\n}\n.lz-tooltip th {\n  text-align: left;\n}\n.lz-table tbody tr:hover {\n  outline: 1px solid black;\n  cursor: pointer;\n}\n.lz-table th, .lz-table td {\n  padding: 0px 8px;\n  vertical-align: middle;\n}\n.lz-table tbody > tr:nth-child(odd) {\n  background-color: #f3f3f3;\n}\n.lz-table .lz-number {\n  text-align: right;\n}\n.lz-record th, .lz-record td {\n  padding: 0px 8px;\n  vertical-align: middle;\n}\n.lz-record th {\n  text-align: right;\n}\n.lz-record tbody > tr:nth-child(odd) {\n  background-color: #f3f3f3;\n}")},_a=null,ba=18,To=function(){var t,n;return _a=t=Pr(new s(100,100)),n=t.context,n.font=Su.axisLabelFont,ba=n.measureText("M").width},ya=!1,Wo=function(){return ya?void 0:(Eo(),To(),ya=!0)},jo=function(){var t,n;return n=1<=arguments.length?xa.call(arguments,0):[],(t=ho(n,F,en))?(Wo(),function(e){var r;return r=_.isElement(e)?function(t,n){return t?e.innerHTML=t.message:e.appendChild(n.element)}:_.isFunction(e)?e:void 0,r?va(t,_.without(n,t),r):void 0}):function(){var t;return t=1<=arguments.length?xa.call(arguments,0):[],jo.apply(null,n.concat(t))}},jo.VERSION="0.1.13",jo.settings=Su,jo.bounds=Do,jo.from=tu,jo.value=zu,jo.domain=$o,jo.range=_u,jo.position=yu,jo.fillColor=Qo,jo.fillOpacity=Zo,jo.strokeColor=Tu,jo.strokeOpacity=Eu,jo.size=Nu,jo.width=Iu,jo.height=ou,jo.lineWidth=fu,jo.shape=qu,jo.tooltip=Yu,jo.factor=Ko,jo.stack=Wu,jo.groupBy=eu,jo.where=Xu,jo.limit=cu,jo.having=iu,jo.eq=Jo,jo.ne=vu,jo.lt=hu,jo.gt=ru,jo.le=au,jo.ge=nu,jo.like=su,jo.avg=Vo,jo.count=Ho,jo.max=du,jo.min=pu,jo.sum=Ou,jo.parse=mu,jo.point=bu,jo.rect=ku,jo.path=wu,jo.schema=xu,jo.line=lu,jo.select=Cu,jo.dataPackage=Uo,jo.computed=Go,jo.createFrame=Kr,jo.createVector=mi,jo.createList=ni,jo.createFactor=Ur,null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=jo:window.plot=jo}).call(this);
