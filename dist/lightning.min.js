(function(){var t,n,e,r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,k,x,C,S,q,N,W,T,O,E,Y,X,I,M,z,A,P,F,j,L,R,B,V,D,H,G,U,K,J,Q,Z,tn,nn,en,rn,on,un,an,sn,cn,ln,fn,hn,dn,pn,vn,gn,mn,wn,bn,yn,_n,kn,xn,Cn,Sn,qn,Nn,Wn,Tn,On,En,Yn,Xn,In,Mn,zn,An,Pn,Fn,jn,Ln,Rn,Bn,Vn,Dn,Hn,$n,Gn,Un,Kn,Jn,Qn,Zn,te,ne,ee,re,ie,oe,ue,ae,se,ce,le,fe,he,de,pe,ve,ge,me,we,be,ye,_e,ke,xe,Ce,Se,qe,Ne,We,Te,Oe,Ee,Ye,Xe,Ie,Me,ze,Ae,Pe,Fe,je,Le,Re,Be,Ve,De,He,$e,Ge,Ue,Ke,Je,Qe,Ze,tr,nr,er,rr,ir,or,ur,ar,sr,cr,lr,fr,hr,dr,pr,vr,gr,mr,wr,br,yr,_r,kr,xr,Cr,Sr,qr,Nr,Wr,Tr,Or,Er,Yr,Xr,Ir,Mr,zr,Ar,Pr,Fr,jr,Lr,Rr,Br,Vr,Dr,Hr,$r,Gr,Ur,Kr,Jr,Qr,Zr,ti,ni,ei,ri,ii,oi,ui,ai,si,ci,li,fi,hi,di,pi,vi,gi,mi,wi,bi,yi,_i,ki,xi,Ci,Si,qi,Ni,Wi,Ti,Oi,Ei,Yi,Xi,Ii,Mi,zi,Ai,Pi,Fi,ji,Li,Ri,Bi,Vi,Di,Hi,$i,Gi,Ui,Ki,Ji,Qi,Zi,to,no,eo,ro,io,oo,uo,ao,so,co,lo,fo,ho,po,vo,go,mo,wo,bo,yo,_o,ko,xo,Co,So,qo,No,Wo,To,Oo,Eo,Yo,Xo,Io,Mo,zo,Ao,Po,Fo,jo,Lo,Ro,Bo,Vo,Do,Ho,$o,Go,Uo,Ko,Jo,Qo,Zo,tu,nu,eu,ru,iu,ou,uu,au,su,cu,lu,fu,hu,du,pu,vu,gu,mu,wu,bu,yu,_u,ku,xu,Cu,Su,qu,Nu,Wu,Tu,Ou,Eu,Yu,Xu,Iu,Mu,zu,Au,Pu,Fu,ju,Lu,Ru,Bu,Vu,Du,Hu,$u,Gu,Uu,Ku,Ju,Qu,Zu,ta,na,ea,ra,ia,oa,ua,aa,sa,ca,la,fa,ha,da,pa,va,ga,ma,wa,ba,ya,_a,ka,xa,Ca,Sa,qa,Na,Wa,Ta=[].slice,Oa=function(t,n){function e(){this.constructor=t}for(var r in n)Ea.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},Ea={}.hasOwnProperty;xa=Math.PI,Ca=2*xa,fn=xa/2,ka=1e-6,Q=ka*ka,Hn=xa/180,B=180/xa,Ae=Math.tan(30*Hn),ye=Math.sqrt(3),C=16581375,Le="transparent",ze="undefined",Ee="null",Ne="Boolean",Me="String",Ye="Number",Oe="Function",Xe="Object",qe="Array",Se="Arguments",We="Date",Ie="RegExp",Te="Error",ya=function(t){var n;if(n=Object.prototype.toString.call(t),null===t)return Ee;if(void 0===t)return ze;if(t===!0||t===!1||"[object Boolean]"===n)return Ne;switch(n){case"[object String]":return Me;case"[object Number]":return Ye;case"[object Function]":return Oe;case"[object Object]":return Xe;case"[object Array]":return qe;case"[object Arguments]":return Se;case"[object Date]":return We;case"[object RegExp]":return Ie;case"[object Error]":return Te;default:return n}},Tn=function(){function t(t,n){this.match=t,this.func=n}return t}(),qi=function(){var t,n;return t=function(n){var e,r,i;switch(r=ya(n)){case ze:return function(t){return void 0===t};case Ee:return function(t){return null===t};case Ne:return function(t){return n===Boolean||t===n};case Me:return function(t){return n===String||t===n};case Ye:return function(t){return n===Number||t===n||_.isNaN(t)&&_.isNaN(n)};case Ie:return function(){return n===RegExp};case Error:return function(){return n===Error};case We:return function(t){return n===Date||t===n};case qe:return 1===n.length&&Oe===(i=ya(n[0]))?(e=t(n[0]),function(t){var n,r,i;if(qe!==ya(t))return!1;for(r=0,i=t.length;i>r;r++)if(n=t[r],!e(n))return!1;return!0}):function(t){return n===Array||pr(n,t)};case Oe:return function(t){var e;return t instanceof n?!0:t&&t.constructor===n?!0:(e=ya(t),n===Boolean&&e===Ne||n===String&&e===Me||n===Number&&e===Ye)};case Xe:return function(t){var e,r;for(e in n)if(r=n[e],t[e]!==r)return!1;return!0};default:return function(){return!1}}},n=function(n){var e;return e=_.map(n,t),function(t){var n,r,i,o;if(0===t.length)return!1;if(t.length!==e.length)return!1;for(r=i=0,o=e.length;o>i;r=++i)if(n=e[r],!n(t[r]))return!1;return!0}},function(){var t,e;return t=1<=arguments.length?Ta.call(arguments,0):[],e=_.map(t,function(t){var e,r,i;return r=2<=t.length?Ta.call(t,0,i=t.length-1):(i=0,[]),e=t[i++],new Tn(n(r),e)}),function(){var t,n,r,i;for(t=1<=arguments.length?Ta.call(arguments,0):[],r=0,i=e.length;i>r;r++)if(n=e[r],n.match(t))return n.func.apply(null,t);throw new Error("Pattern match failure for args [ "+_.map(t,function(t){return""+t+":"+ya(t)}).join(", ")+" ]")}}}(),dr=function(t,n){return new(t.bind.apply(t,[null].concat(n)))},m=function(){function t(t,n){this.put=t,this.test=n}return t}(),Wn=function(){function t(t,n){this.put=t,this.test=n}return t}(),ve=function(){function t(t,n){this.width=t,this.height=n}return t}(),Un=function(){function t(t,n,e,r){this.left=t,this.top=n,this.width=e,this.height=r}return t}(),nr=function(){function t(t,n,e,r,i,o,u){this.name=t,this.label=n,this.type=e,this.at=r,this.count=i,this.domain=o,this.format=u}return t}(),tn=function(t){function n(t,e,r,i,o,u,a,s){this.valueAt=o,n.__super__.constructor.call(this,t,e,r,i,u,a,s)}return Oa(n,t),n}(nr),xn=function(t){function n(t,e,r,i,o,u){n.__super__.constructor.call(this,t,e,Xe,r,i,o,u)}return Oa(n,t),n}(nr),cn=function(){function t(){}return t}(),an=function(){function t(t,n,e,r,i,o,u,a,s){this.label=t,this.vectors=n,this.schema=e,this.indices=r,this.cube=i,this.at=o,this.evaluate=u,this.attach=a,this.metadata=s}return t}(),Re=function(){function t(t){this.value=t}return t}(),On=function(t){function n(t){n.__super__.constructor.call(this,t)}return Oa(n,t),n}(Re),_e=function(t){function n(t){n.__super__.constructor.call(this,t)}return Oa(n,t),n}(Re),R=function(t){function n(t){n.__super__.constructor.call(this,t)}return Oa(n,t),n}(Re),a=function(t){function n(t){n.__super__.constructor.call(this,t)}return Oa(n,t),n}(Re),en=function(){function t(t){this.name=t}return t}(),Cn=function(t){function n(t){this.evaluate=t}return Oa(n,t),n}(en),Jn=function(t){function n(t){this.evaluate=t}return Oa(n,t),n}(en),rn=function(){function t(t,n){this.color=t,this.opacity=n}return t}(),ke=function(){function t(t,n,e){this.color=t,this.opacity=n,this.size=e}return t}(),se=function(){function t(t){this.fields=t}return t}(),Gn=function(){function t(t){this.index=t}return t}(),Nn=function(){function t(){}return t}(),Pn=function(t){function n(t,n,e,r,i,o,u,a,s){this.position=t,this.shape=n,this.size=e,this.fillColor=r,this.fillOpacity=i,this.strokeColor=o,this.strokeOpacity=u,this.lineWidth=a,this.tooltip=s}return Oa(n,t),n}(Nn),Xn=function(t){function n(t,n,e,r,i){this.position=t,this.strokeColor=n,this.strokeOpacity=e,this.lineWidth=r,this.tooltip=i}return Oa(n,t),n}(Nn),te=function(t){function n(t,n,e,r,i){this.position=t,this.strokeColor=n,this.strokeOpacity=e,this.lineWidth=r,this.tooltip=i}return Oa(n,t),n}(Nn),Kn=function(t){function n(t,n,e,r,i,o,u,a,s){this.position=t,this.width=n,this.height=e,this.fillColor=r,this.fillOpacity=i,this.strokeColor=o,this.strokeOpacity=u,this.lineWidth=a,this.tooltip=s}return Oa(n,t),n}(Nn),e=function(){function t(){}return t}(),yn=function(t){function n(t,n,e,r){this.position=t,this.strokeColor=n,this.strokeOpacity=e,this.lineWidth=r}return Oa(n,t),n}(e),n=function(){function t(){}return t}(),bn=function(t){function n(t,n,e,r,i){this.slope=t,this.intercept=n,this.strokeColor=e,this.strokeOpacity=r,this.lineWidth=i,this.render=ra}return Oa(n,t),n}(n),qn=function(){function t(){}return t}(),jn=function(t){function n(t,n,e,r,i,o,u,a,s,c,l){this.space=t,this.positionX=n,this.positionY=e,this.shape=r,this.size=i,this.fillColor=o,this.fillOpacity=u,this.strokeColor=a,this.strokeOpacity=s,this.lineWidth=c,this.tooltip=l,this.geometry=Fn}return Oa(n,t),n}(qn),re=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.space=t,this.q0=n,this.q1=e,this.q2=r,this.q3=i,this.qn=o,this.positionY=u,this.height=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f,this.geometry=ee}return Oa(n,t),n}(qn),ue=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.space=t,this.positionX=n,this.q0=e,this.q1=r,this.q2=i,this.q3=o,this.qn=u,this.width=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f,this.geometry=oe}return Oa(n,t),n}(qn),y=function(t){function n(t,n,e,r,i,o,u,a,s,c,l){this.space=t,this.positionX=n,this.positionY1=e,this.positionY2=r,this.width=i,this.fillColor=o,this.fillOpacity=u,this.strokeColor=a,this.strokeOpacity=s,this.lineWidth=c,this.tooltip=l,this.geometry=b}return Oa(n,t),n}(qn),u=function(t){function n(t,n,e,r,i,u,a,s,c,l,f){this.space=t,this.positionX1=n,this.positionX2=e,this.positionY=r,this.height=i,this.fillColor=u,this.fillOpacity=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f,this.geometry=o}return Oa(n,t),n}(qn),Mn=function(t){function n(t,n,e,r,i,o,u){this.space=t,this.positionX=n,this.positionY=e,this.strokeColor=r,this.strokeOpacity=i,this.lineWidth=o,this.tooltip=u,this.geometry=In}return Oa(n,t),n}(qn),J=function(){function t(){}return t}(),An=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.positionX=t,this.positionY=n,this.shape=e,this.size=r,this.fill=i,this.fillColor=o,this.fillOpacity=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Oa(n,t),n}(J),ne=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.q0=t,this.q1=n,this.q2=e,this.q3=r,this.qn=i,this.positionY=o,this.height=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Oa(n,t),n}(J),ie=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.positionX=t,this.q0=n,this.q1=e,this.q2=r,this.q3=i,this.qn=o,this.width=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Oa(n,t),n}(J),w=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.positionX=t,this.positionY1=n,this.positionY2=e,this.width=r,this.fill=i,this.fillColor=o,this.fillOpacity=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Oa(n,t),n}(J),i=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.positionX1=t,this.positionX2=n,this.positionY=e,this.height=r,this.fill=i,this.fillColor=o,this.fillOpacity=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Oa(n,t),n}(J),Yn=function(t){function n(t,n,e,r,i,o,u){this.positionX=t,this.positionY=n,this.stroke=e,this.strokeColor=r,this.strokeOpacity=i,this.lineWidth=o,this.tooltip=u}return Oa(n,t),n}(J),be=function(){function t(t,n){this.x=t,this.y=n}return t}(),we=function(){function t(t,n,e){this.type=t,this.vectors=n,this.domain=e}return t}(),r=function(){function t(){}return t}(),f=function(t){function n(t,n,e,r,i,o,u){this.type=t,this.label=n,this.scale=e,this.domain=r,this.range=i,this.rect=o,this.guide=u}return Oa(n,t),n}(r),Bn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}(r),kn=function(t){function n(t,n,e,r,i,o,u){this.type=t,this.label=n,this.scale=e,this.domain=r,this.range=i,this.rect=o,this.guide=u}return Oa(n,t),n}(Bn),Pe=function(){function t(t,n){this.value=t,this.label=n}return t}(),K=function(){function t(t,n){this.label=t,this.encode=n}return t}(),T=function(t){function n(t){this.value=t,n.__super__.constructor.call(this,"Constant",hr(this.value))}return Oa(n,t),n}(K),Ve=function(t){function n(t,e,r){this.vector=r,n.__super__.constructor.call(this,t,e)}return Oa(n,t),n}(K),je=function(t){function n(t){this.vectors=t,n.__super__.constructor.call(this,"tooltips")}return Oa(n,t),n}(K),Rn=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Oa(n,t),n}(Ve),x=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Oa(n,t),n}(Ve),En=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Oa(n,t),n}(Ve),me=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Oa(n,t),n}(Ve),he=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Oa(n,t),n}(Ve),g=function(){function t(){}return t}(),k=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}(g),F=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}(g),Ln=function(t){function n(t){this.coordinates=t}return Oa(n,t),n}(g),on=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}(g),un=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}(g),xe=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}(g),Ce=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}(g),ge=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}(g),or=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}(g),pn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}(g),_n=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}(g),fe=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}(g),Fe=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}(g),W=function(t){function n(t){this.value=t}return Oa(n,t),n}(F),Be=function(t){function n(t){this.field=t}return Oa(n,t),n}(F),O=function(t){function n(t){this.value=t}return Oa(n,t),n}(on),De=function(t){function n(t,n){this.field=t,this.range=n}return Oa(n,t),n}(on),E=function(t){function n(t){this.value=t}return Oa(n,t),n}(un),He=function(t){function n(t,n){this.field=t,this.range=n}return Oa(n,t),n}(un),z=function(t){function n(t){this.value=t}return Oa(n,t),n}(xe),Je=function(t){function n(t,n){this.field=t,this.range=n}return Oa(n,t),n}(xe),A=function(t){function n(t){this.value=t}return Oa(n,t),n}(Ce),Qe=function(t){function n(t,n){this.field=t,this.range=n}return Oa(n,t),n}(Ce),M=function(t){function n(t){this.value=t}return Oa(n,t),n}(ge),Ke=function(t){function n(t,n){this.field=t,this.range=n}return Oa(n,t),n}(ge),P=function(t){function n(t){this.value=t}return Oa(n,t),n}(or),tr=function(t){function n(t,n){this.field=t,this.range=n}return Oa(n,t),n}(or),Y=function(t){function n(t){this.value=t}return Oa(n,t),n}(pn),$e=function(t){function n(t,n){this.field=t,this.range=n}return Oa(n,t),n}(pn),X=function(t){function n(t){this.value=t}return Oa(n,t),n}(_n),Ge=function(t){function n(t,n){this.field=t,this.range=n}return Oa(n,t),n}(_n),I=function(t){function n(t){this.value=t}return Oa(n,t),n}(fe),Ue=function(t){function n(t,n){this.field=t,this.range=n}return Oa(n,t),n}(fe),Ze=function(t){function n(t){this.fields=t}return Oa(n,t),n}(Fe),Z=function(){function t(t,n){this.min=t,this.max=n}return t}(),G=function(){function t(t,n){this.min=t,this.max=n}return t}(),U=function(){function t(t,n){this.min=t,this.max=n}return t}(),$n=function(){function t(){}return t}(),h=function(t){function n(t){this.values=t}return Oa(n,t),n}($n),Vn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}($n),le=function(t){function n(t,n){this.min=t,this.max=n}return Oa(n,t),n}(Vn),H=function(t){function n(t,n,e){this.min=t,this.mid=n,this.max=e}return Oa(n,t),n}(Vn),q=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Oa(n,t),n}($n),ce=function(t){function n(t,n){this.min=t,this.max=n}return Oa(n,t),n}(q),D=function(t){function n(t,n,e){this.min=t,this.mid=n,this.max=e}return Oa(n,t),n}(q),sn=function(){function t(t,n,e,r,i){this.encode=t,this.mask=n,this.highlight=e,this.render=r,this.select=i}return t}(),L=function(){function t(t){this.read=t}return t}(),l=function(){function t(t,n,e,r){this.element=t,this.context=n,this.bounds=e,this.ratio=r}return t}(),er=function(){function t(t,n,e,r,i,o,u,a,s,c,l){this.box=t,this.container=n,this.baseCanvas=e,this.highlightCanvas=r,this.hoverCanvas=i,this.maskCanvas=o,this.clipCanvas=u,this.marquee=a,this.tooltip=s,this.mask=c,this.clip=l}return t}(),gn=function(){function t(t,n,e,r,i,o){this.encodings=t,this.encoders=n,this.mask=e,this.highlight=r,this.render=i,this.select=o}return t}(),rr=function(){function t(t,n,e,r,i,o,u,a){this.viewport=t,this.frame=n,this.test=e,this.highlight=r,this.hover=i,this.selectAt=o,this.selectWithin=u,this.render=a}return t}(),zn=function(){function t(t,n,e){this.element=t,this.subscribe=n,this.unsubscribe=e}return t}(),s=function(){function t(t,n){this.width=t,this.height=n}return t}(),Qn=function(){function t(t,n,e,r,i){this.center=t,this.left=n,this.top=e,this.right=r,this.bottom=i}return t}(),Sn=function(){function t(t,n,e,r){this.left=t,this.top=n,this.right=e,this.bottom=r}return t}(),c=function(){function t(t,n,e){var r;this.width=t,this.height=n,this.margin=e,this.regions=new Qn(r=new Un(e.left,e.top,t-e.left-e.right,n-e.top-e.bottom),new Un(0,e.top,e.left,r.height),new Un(e.left+r.width,e.top,e.right,r.height),new Un(e.left,0,r.width,e.top),new Un(e.left,e.top+r.height,r.width,e.bottom))}return t}(),Dn=function(){function t(t,n,e,r){this.where=t,this.limit=n,this.group=e,this.having=r}return t}(),d=function(){function t(t,n){this.key=t,this.value=n}return t}(),t=new d(0,"All"),j=function(){function t(t,n,e,r){this.frame=t,this.hierarchy=n,this.cells=e,this.dimension=r}return t}(),mn=function(){function t(t,n,e){this.category=t,this.indices=n,this.children=e}return t}(),p=function(){function t(t,n){this.levels=t,this.indices=n}return t}(),nn=function(){function t(t,n,e,r,i){this.at=t,this.valueAt=n,this.count=e,this.domain=r,this.format=i}return t}(),ln=function(){function t(t){this.fields=t}return t}(),ir=function(){function t(t,n){this.fields=t,this.predicate=n}return t}(),wn=function(){function t(t,n){this.offset=t,this.length=n}return t}(),hn=function(){function t(t,n){this.fields=t,this.predicate=n}return t}(),vn=function(){function t(t,n){this.vectors=t,this.index=n}return t}(),ae=function(){function t(t,n){this.vectors=t,this.indices=n}return t}(),V=function(){function t(t){this.vectors=t}return t}(),N=function(){function t(t){this.vector=t}return t}(),dn=function(){function t(t){this.vector=t}return t}(),Zn=function(){function t(t){this.index=t}return t}(),v=function(){function t(t,n){this.vector=t,this.index=n}return t}(),mr=function(t){var n;return n=parseFloat(t),_.isNaN(n)?void 0:n},gr=function(t){var n;return n=parseInt(t,10),_.isNaN(n)?void 0:n},vr=function(t){return null!=t?t:void 0},wa=function(t){return t*t},kr=function(t,n){return function(e){return t>e?t:e>n?n:e}},_r=kr(0,1),Si=8,zr=function(t){return t.slice(0)},yo=function(t,n){var e,r,i,o,u,a,s,c;for(i=[],o=0,a=t.length;a>o;o++)for(e=t[o],c=n(e),u=0,s=c.length;s>u;u++)r=c[u],i.push(r);return i},Ro=function(){var t,n;return n=arguments[0],t=2<=arguments.length?Ta.call(arguments,1):[],function(){return n.apply(null,t)}},hr=function(t){return function(){return t}},pr=function(t,n){var e,r,i,o;if(t&&n&&t.length===n.length){for(e=i=0,o=t.length;o>i;e=++i)if(r=t[e],r!==n[e])return!1;return!0}return!1},vo=function(){var t,n,e,r,i,o,u,a,s;for(n=arguments[0],i=2<=arguments.length?Ta.call(arguments,1):[],e=[],o=0,a=n.length;a>o;o++)for(t=n[o],u=0,s=i.length;s>u;u++)r=i[u],t instanceof r&&e.push(t);return e},wo=function(){var t,n,e,r,i,o,u,a;for(n=arguments[0],r=2<=arguments.length?Ta.call(arguments,1):[],i=0,u=n.length;u>i;i++)for(t=n[i],o=0,a=r.length;a>o;o++)if(e=r[o],t instanceof e)return t},bo=function(t,n){var e,r,i,o;for(o=[],r=0,i=n.length;i>r;r++)e=n[r],o.push(wo(t,e));return o},Qr=function(t,n){return n>t?new Z(t,n):new Z(n,t)},Er=function(t){var n,e,r,i,o;for(e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,i=0,o=t.length;o>i;i++)r=t[i],void 0!==r&&(e>=r&&(e=r),r>=n&&(n=r));return new Z(e,n)},Yr=function(t,n){var e,r,i,o,u;for(i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,e=u=0;t>=0?t>u:u>t;e=t>=0?++u:--u)void 0!==(o=n(e))&&(i>=o&&(i=o),o>=r&&(r=o));return new Z(i,r)},Mr=function(t){return function(n){return n.min>=t&&n.max>t?1:n.min<t&&n.max<=t?-1:0}},Ir=Mr(0),Wr=function(t,n){return new Z(Math.min(t.min,n.min),Math.max(t.max,n.max))},To=function(t){return function(n){return n.min>t&&n.max>t?new Z(t,n.max):n.min<t&&n.max<t?new Z(n.min,t):n}},Wo=To(0),Mi=function(t,n,e){return $.ajax({dataType:t,url:n,success:function(t){return e(null,t)},error:function(t,n,r){return e(r)}})},ui=function(t,n,e){var r,i,o;return i=function(){return n.length},r=function(t){return n[t]},o=e?function(t){return e(n[t],t)}:r,new xn(t,t,r,i,n,o)},ki=function(t,n,e,r){return Wa(t,t,n,e,r)},Wa=function(t,n,e,r,i){var o,u,a,s;return a=Er(r),u=function(){return r.length},o=function(t){return r[t]},s=i?function(t){return i(r[t],t)}:o,new nr(t,n,e,o,u,a,s)},ri=function(t,n,e,r,i,o){var u,a;return u=Yr(r,i),a=o?function(t){return o(i(t),t)}:i,new nr(t,n,e,i,r,u,a)},po=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,p,v,g,m;for(m=0,v={},f=n(),u=new Array(f),a=function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)h=e[t],r.push(v[h]=new d(m++,h));return r}(),l=g=0;f>=0?f>g:g>f;l=f>=0?++g:--g)s=t(l),h=void 0!==s?s:"?",(o=v[h])||a.push(v[h]=o=new d(m++,h)),u[l]=o;return i=function(t){return u[t]},p=function(t){return u[t].value},c=r?function(t){return r(u[t].value)}:function(t){return void 0!==(h=u[t].value)?_.escape(h):h},new nn(i,p,n,a,c)},Zr=function(t,n,e,r,i){var o,u,a;return u=function(){return e.length},o=function(t){return e[t]},a=po(o,u,r||[],i),new tn(t,t,n,a.at,a.valueAt,u,a.domain,a.format)},Pr=function(t,n){var e,r,i,o,u,a;return i="All",r=new d(0,i),a=function(){return i},e=function(){return r},o=function(){return n},u=function(){return i},new tn(t,t,Me,e,a,o,[r],u)},ei=function(t,n,e,r,i){var o,u;return u=_.indexBy(n,function(t){return t.name}),o=new an(t,n,u,e,r,null,null,null,i||{}),o.evaluate=function(n){var e,i,a,s;return i=_.isArray(n)?n:[n],a=function(){var a,c,l;for(l=[],a=0,c=i.length;c>a;a++)if(e=i[a],e instanceof Cn)l.push(o.evaluate(e.evaluate(o)));else if(e instanceof Jn){if(!r)throw new Error("Cannot compute aggregate ["+e.name+"] on an unaggregated frame.");l.push(o.evaluate(e.evaluate(o,r)))}else{if(!(e instanceof en))throw new Error("Cannot evaluate ["+n+"] on frame ["+t+"].");if(!(s=u[e.name]))throw new Error("Vector ["+e.name+"] does not exist in frame ["+t+"].");l.push(s)}return l}(),_.flatten(a)},o.attach=function(e){if(u[e.name])throw new Error("Cannot attach vector ["+e.name+"]: a vector by that name already exists in frame ["+t+"]");return n.push(e),u[e.name]=e,e},o.exists=function(t){return u[t]?!0:!1},o},Vi=function(t){var n,e,r,i,o,u,a,s,c,l,f;for(u=new Array(t.indices.length),e=_.map(t.vectors,function(t){return t instanceof tn?t.valueAt:t.at}),f=t.indices,a=0,c=f.length;c>a;a++)for(r=f[a],u[r]=o=new Array(t.vectors.length),i=s=0,l=e.length;l>s;i=++s)n=e[i],o[i]=n(r);return u},di=function(t){return new Dn(vo(t,ir),vo(t,wn),vo(t,ln),vo(t,hn))},ni=function(t){return _.map(t,function(t){return new en(t)})},ti=function(t){return new Cn(function(n){var e,r,i,o,u,a,s,c;if(s=_.head(n.evaluate(t)),s instanceof tn)return t;for(u=s.count(),e=s.at,i=new Array(u),o=c=0;u>=0?u>c:c>u;o=u>=0?++c:--c)void 0!==(a=e(o))&&(i[o]=""+a);return n.attach(r=Zr("factor("+s.label+")",Me,i)),[new en(r.name)]})},Fr=function(t){return new Cn(function(n){return n.attach(Pr(t,n.indices.length)),[new en(t)]})},ru=qi([String,function(t){return ru(new en(t))}],[en,function(t){return ti(t)}],[_e,function(t){var n;return n=t.value,Fr(n)}]),bi=function(t,n){return new Cn(function(e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,k,x,C,S,q;if(b=_.head(e.evaluate(t)),b instanceof tn)throw new Error("Cannot stack factor ["+b.label+"]: expecting vector.");for(d=b.count(),m=new Array(d),c=new Array(d),g="low("+b.name+", "+n+")",s="high("+b.name+", "+n+")",r=b.at,o=e.cube,n=Math.min(n,o.dimension),i=o.cells,v=a=0,y=new Array(n),q=e.indices,k=0,S=q.length;S>k;k++){for(l=q[k],p=i[l].levels,f=x=0;n>=0?n>x:x>n;f=n>=0?++x:--x)if(y[f]!==p[f].category){for(v=a=0,h=C=0;n>=0?n>C:C>n;h=n>=0?++C:--C)y[h]=p[h].category;break}w=r(l),0>w?(m[l]=v,c[l]=v+=w):(m[l]=a,c[l]=a+=w)}return u=function(t,n){return b.format(n)},e.attach(Wa(g,b.name,b.type,m,u)),e.attach(Wa(s,b.name,b.type,c,u)),[new en(g),new en(s)]})},Iu=qi([String,Number,function(t,n){return Iu(new en(t),n)}],[en,Number,function(t,n){return bi(t,n)}]),Bu=function(t){var n;return n=kr(0,t.length-1),function(e){return t[n(-1+Math.round(e*t.length))]}},Xr=function(t){var n,e,r,i,o,u,a,s;return s=function(){var n,e,r;for(r=[],n=0,e=t.length;e>n;n++)a=t[n],(a||0===a)&&r.push(a);return r}(),s.sort(function(t,n){return t-n}),e=s[0],n=s[s.length-1],u=Bu(s),r=u(.25),i=u(.5),o=u(.75),[e,r,i,o,n]},ar=function(t){var n,e,r,i,o;for(e=0,n=0,i=0,o=t.length;o>i;i++)r=t[i],void 0!==r&&(e+=r,n++);return e/n},sr=function(t){var n,e,r,i;for(n=0,r=0,i=t.length;i>r;r++)e=t[r],void 0!==e&&n++;return n},cr=function(t){var n,e,r,i;for(n=Number.NEGATIVE_INFINITY,r=0,i=t.length;i>r;r++)e=t[r],void 0!==e&&e>=n&&(n=e);return n},lr=function(t){var n,e,r,i;for(n=Number.POSITIVE_INFINITY,r=0,i=t.length;i>r;r++)e=t[r],void 0!==e&&n>=e&&(n=e);return n},fr=function(t){var n,e,r,i;for(n=0,r=0,i=t.length;i>r;r++)e=t[r],void 0!==e&&(n+=e);return n},Ar=function(t,n,e,r,i){return new Jn(function(o,u){var a,s,c,l,f,h,d,p,v,g,m,w,b,y,k,x;if(d=n+"("+t.name+")",o.exists(d))return new en(d);for(g=_.head(u.frame.evaluate(t)),a=g.at,l=new Array(u.cells.length),k=u.cells,h=m=0,b=k.length;b>m;h=++m){for(s=k[h],v=[],x=s.indices,w=0,y=x.length;y>w;w++)f=x[w],void 0!==(p=a(f))&&v.push(p);l[h]=i(v)}return o.attach(c=ki(d,e,l,r)),[new en(c.name)]})},Go=function(t,n,e,r){return qi([String,function(i){return Ar(new en(i),t,n,e,r)}],[en,function(i){return Ar(i,t,n,e,r)}])},Qo=Go("count",Ye,_.identity,sr),Uo=Go("avg",Ye,_.identity,ar),bu=Go("max",Ye,_.identity,cr),yu=Go("min",Ye,_.identity,lr),Au=Go("sum",Ye,_.identity,fr),su=function(){var t,n,e;return n=1<=arguments.length?Ta.call(arguments,0):[],e=function(){var e,r,i;for(i=[],e=0,r=n.length;r>e;e++)if(t=n[e],t instanceof en)i.push(t);else{if(!_.isString(t))throw new Error("Cannot group by ["+t+"]");i.push(new en(t))}return i}(),new ln(e)},$o=qi([[String],Function,function(t,n){return new ir(ni(t),n)}]),ju=function(){var t,n,e;return n=2<=arguments.length?Ta.call(arguments,0,e=arguments.length-1):(e=0,[]),t=arguments[e++],$o(n,t)},vu=qi([Number,Number,function(t,n){return new wn(t,n)}],[Number,function(t){return new wn(0,t)}]),Ho=qi([[String],Function,function(t,n){return new hn(ni(t),n)}],[[en],Function,function(t,n){return new hn(t,n)}]),lu=function(){var t,n,e;return n=2<=arguments.length?Ta.call(arguments,0,e=arguments.length-1):(e=0,[]),t=arguments[e++],Ho(n,t)},eu=function(t){return function(n){return n===t}},_u=function(t){return function(n){return n!==t}},wu=function(t){return function(n){return t>n}},cu=function(t){return function(n){return n>t}},du=function(t){return function(n){return t>=n}},au=function(t){return function(n){return n>=t}},pu=function(t){if(Ie!==ya(t))throw new Error("like ["+t+"]: expecting RegExp");return function(n){return t.test(n)}},hu=function(t){return function(n){var e,r,i;for(r=0,i=t.length;i>r;r++)if(e=t[r],e===n)return!0;return!1}},ku=function(t){return function(n){var e,r,i;for(r=0,i=t.length;i>r;r++)if(e=t[r],e===n)return!1;return!0}},Vu=function(n,e){var r,i,o,u,a,s,c,l,f,h,d;return c=e.where.length?ei(n.label,n.vectors,mo(n,e.where)):n,h=e.group.length?(s=yo(e.group,function(t){return t.fields}),u=function(){var t,n,e;for(e=[],t=0,n=s.length;n>t;t++){if(a=s[t],d=_.head(c.evaluate(a)),!(d instanceof tn))throw new Error("Cannot group by ["+a.name+"]: not a Factor.");e.push(d)}return e}(),l={0:new mn(t,c.indices,{})},wr(l,u,0),i=[],Sr(l[0].children,s.length-1,i,0,new Array(s.length)),o=new j(c,l,i,s.length),r=ur(c.label+"'",o,u),e.having.length?ei(r.label,r.vectors,mo(r,e.having),r.cube):r):c,e.limit.length?(f=e.limit[e.limit.length-1],ei(h.label,h.vectors,h.indices.slice(f.offset,f.offset+f.length))):h},mo=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p,v,g,m;for(h=t.indices,f=0,v=n.length;v>f;f++){for(c=n[f],a=[],l=function(){var n,e,r,i;for(r=c.fields,i=[],n=0,e=r.length;e>n;n++)o=r[n],i.push(_.head(t.evaluate(o)));return i}(),i=_.map(l,function(t){return t instanceof tn?t.valueAt:t.at}),d=0,g=h.length;g>d;d++){for(u=h[d],e=new Array(l.length),s=p=0,m=i.length;m>p;s=++p)r=i[s],e[s]=r(u);c.predicate.apply(null,e)&&a.push(u)}h=a}return h},ur=function(t,n,e){var r,i,o;return r=_.range(n.cells.length),o=function(){var t,r,o;for(o=[],i=t=0,r=n.dimension;r>=0?r>t:t>r;i=r>=0?++t:--t)o.push(ho(n,e[i],i));return o}(),ei(t,o,r,n)},wr=function(t,n,e){var r,i,o,u,a,s,c,l,f,h;r=n[e].at;for(s in t){for(c=t[s],u=c.children,h=c.indices,l=0,f=h.length;f>l;l++)a=h[l],i=r(a),(o=u[i.key])||(u[i.key]=o=new mn(i,[],{})),o.indices.push(a);e<n.length-1&&wr(u,n,e+1)}},Sr=function(t,n,e,r,i){var o,u;for(o in t)u=t[o],i[r]=u,r===n?e.push(new p(zr(i),u.indices)):Sr(u.children,n,e,r+1,i)},ho=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v;for(a=new Array(t.cells.length),s={},c=[],v=t.cells,f=d=0,p=v.length;p>d;f=++d)o=v[f],a[f]=i=o.levels[e].category,s[i.value]||(s[i.value]=i,c.push(i));return r=function(t){return a[t]},h=function(t){return a[t].value},l=function(t){return a[t].value},u=function(){return a.length},new tn(n.label,n.label,n.type,r,h,u,c,l)},S={c10:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],c20:["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],c20b:["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],c20c:["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"]},Bo=function(t){return t>10?S.c20:S.c10},Cr=function(t){var n,e,r,i;return i=t.rgb(),r=i[0],e=i[1],n=i[2],chroma.rgb(r,e,n)},Nr=function(t,n){return n>=0&&1>n?Cr(t).alpha(n).css():t.css()},zi=function(t,n,e,r){var i;return i=Math.sqrt(r/xa),t.beginPath(),t.arc(n,e,i,0,Ca,!1),t.closePath()},Fi=function(t,n,e,r){var i;return i=.5*Math.sqrt(r),t.save(),t.translate(n,e),t.beginPath(),t.moveTo(i,i),t.lineTo(-i,i),t.lineTo(-i,-i),t.lineTo(i,-i),t.closePath(),t.restore()},Ai=function(t,n,e,r){var i,o;return i=.5*Math.sqrt(r/5),o=3*i,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(o,i),t.lineTo(i,i),t.lineTo(i,o),t.lineTo(-i,o),t.lineTo(-i,i),t.lineTo(-o,i),t.lineTo(-o,-i),t.lineTo(-i,-i),t.lineTo(-i,-o),t.lineTo(i,-o),t.lineTo(i,-i),t.lineTo(o,-i),t.closePath(),t.restore()},Pi=function(t,n,e,r){var i,o;return o=Math.sqrt(r/(2*Ae)),i=o*Ae,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(i,0),t.lineTo(0,o),t.lineTo(-i,0),t.lineTo(0,-o),t.closePath(),t.restore()},Bi=function(t,n,e,r){var i,o;return i=Math.sqrt(r/ye),o=i*ye/2,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(0,-o),t.lineTo(i,o),t.lineTo(-i,o),t.closePath(),t.restore()},ji=function(t,n,e,r){var i,o;return i=Math.sqrt(r/ye),o=i*ye/2,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(0,o),t.lineTo(i,-o),t.lineTo(-i,-o),t.closePath(),t.restore()},Ri=function(t,n,e,r){var i,o;return o=Math.sqrt(r/ye),i=o*ye/2,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(i,0),t.lineTo(-i,o),t.lineTo(-i,-o),t.closePath(),t.restore()},Li=function(t,n,e,r){var i,o;return o=Math.sqrt(r/ye),i=o*ye/2,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(-i,0),t.lineTo(i,-o),t.lineTo(i,o),t.closePath(),t.restore()},pe={circle:zi,square:Fi,cross:Ai,diamond:Pi,triangleUp:Bi,triangleDown:ji,triangleLeft:Li,triangleRight:Ri},de={c8:["circle","square","cross","diamond","triangleUp","triangleDown","triangleLeft","triangleRight"]},Vo=function(){return de.c8},ha=function(t){return function(n){return void 0!==n?t(n):void 0}},ci=function(t,n){var e;return e=d3.scale.linear().domain([t.min,t.max]).range([n.min,n.max]).nice(),[ha(e),e.tickFormat,e.ticks]},li=function(t,n){var e,r,i,o,u,a,s;for(a=0,o={},u=0,s=t.length;s>u;u++)e=t[u],o[e.key]=a++;return r=(n.max-n.min)/t.length/2,i=n.min,ha(function(t){return i+2*o[t.key]*r+r})},Vr=function(t,n){var e,r;
return r=n.values,e=r.length,ha(function(t){return r[t.key%e]})},mi=function(t,n){return ha(d3.scale.linear().domain([t.min,t.max]).range([n.min,n.max]))},Ur=function(t,n){return ha(d3.scale.linear().domain([t.min,t.mid,t.max]).range([n.min,n.mid,n.max]))},gi=function(t,n){return ha(chroma.scale([n.min,n.max]).domain([t.min,t.max]).mode("lch"))},Gr=function(t,n){var e,r;return e=chroma.scale([n.min,n.mid]).domain([t.min,t.mid]).mode("lch"),r=chroma.scale([n.mid,n.max]).domain([t.mid,t.max]).mode("lch"),function(n){return void 0!==n?n<t.mid?e(n):r(n):void 0}},Hr=qi([le,q,gi],[H,q,Gr]),oi=qi([le,le,mi],[H,H,Ur]),br=function(t){var n;return n=t.toString(16),1===n.length?"0"+n:n},Dr=function(t){var n,e,r,i;return n=t.context,r=t.ratio,e=function(){return"#fff"},i=function(t,e){var i,o,u,a,s;return s=n.getImageData(t*r,e*r,1,1).data,a=s[0],u=s[1],o=s[2],i=s[3],255===a&&255===u&&255===o&&255===i},new m(e,i)},si=function(t){var n,e,r,i,o,u;return n=t.context,i=t.ratio,u=0,e={},r=function(t){var n,r,i,o;return r=u++,u>=C&&(u=0),e[r]=t,o=r>>16&255,i=r>>8&255,n=255&r,"#"+br(o)+br(i)+br(n)},o=function(t,r){var o,u,a,s,c,l;return l=n.getImageData(t*i,r*i,1,1).data,c=l[0],s=l[1],u=l[2],o=l[3],255===o?(a=(c<<16)+(s<<8)+u,e[a]):void 0},new Wn(r,o)},eo=function(t,n){var e,r,i,o,u,a,s;return s=t.scale,r=t.domain,a=t.range,o=t.guide,u=n.label,e=n.at,i=function(t){return s(e(t))},new Rn(u,i,n,r,a,o)},Ui=function(t,n){return new T(t.scale(n))},Gi=function(t,n){var e,r,i,o,u,a,s;return n instanceof De||n instanceof Je?(s=_.head(t.evaluate(n.field)),s instanceof tn?(n.range||(n.range=new h(Bo(s.domain.length))),u=Vr(s.domain,n.range),e=s.at,i=function(t){return chroma(u(e(t)))},new x(s.label,i,s,s.domain,n.range,null)):(r=function(){switch(Ir(s.domain)){case 1:return new le(s.domain.min,s.domain.max);case-1:return new le(s.domain.min,s.domain.max);default:return new H(s.domain.min,0,s.domain.max)}}(),a=Ir(r),o=n.range?n.range instanceof D?r instanceof le?1===a?new ce(n.range.mid,n.range.max):new ce(n.range.min,n.range.mid):n.range:(r instanceof H?r=new le(r.min,r.max):void 0,n.range):r instanceof le?1===a?new ce("#deebf7","#3182bd"):new ce("#e6550d","#fee6ce"):new D("#fc8d59","#ffffbf"),u=Hr(r,o),e=s.at,i=function(t){return u(e(t))},new x(s.label,i,s,r,o,null))):new T(n.value)},Zi=function(t,n){var e,r,i,o,u,a;if(n instanceof He||n instanceof Qe){if(a=_.head(t.evaluate(n.field)),a instanceof tn)throw new Error("Could not encode opacity. Vector ["+a.label+"] is a Factor.");return r=new le(a.domain.min,a.domain.max),o=n.range?new le(_r(n.range.min),_r(n.range.max)):n.range=new le(.05,1),u=oi(r,o),e=a.at,i=function(t){return u(e(t))},new En(a.label,i,a,r,o,null)}return new T(_r(n.value))},so=function(t,n){var e,r;return t&&n?(e=t.encode,r=n.encode,new Ve("("+t.label+", "+n.label+")",function(t){return Nr(e(t),r(t))})):void 0},fo=function(t,n){return function(e,r,i){var o,u,a,s,c,l;if(r instanceof t){if(l=_.head(e.evaluate(r.field)),l instanceof tn)throw new Error("Could not encode size. Vector ["+l.label+"] is a Factor.");return u=new le(l.domain.min,l.domain.max),s=r.range?new le(_r(r.range.min),_r(r.range.max)):r.range=new le(.05,1),c=oi(u,s),o=l.at,a=function(t){return i*c(o(t))},new n(l.label,a,u,s,null)}return new T(i*_r(r.value))}},uo=fo(Ke,me),lo=fo(tr,me),Ji=fo($e,me),Di=function(t,n){var e,r,i,o,u,a;if(n instanceof Ke){if(a=_.head(t.evaluate(n.field)),a instanceof tn)throw new Error("Could not encode size. Vector ["+a.label+"] is a Factor.");return r=new le(a.domain.min,a.domain.max),o=n.range?new le(wa(n.range.min),wa(n.range.max)):n.range=new le(wa(Si),wa(30)),u=oi(r,o),e=a.at,i=function(t){return u(e(t))},new me(a.label,i,a,r,o,null)}return new T(wa(n.value))},Qi=function(t,n){var e,r,i,o,u,a;if(n instanceof Ge){if(a=_.head(t.evaluate(n.field)),a instanceof tn)throw new Error("Could not encode lineWidth. Vector ["+a.label+"] is a Factor.");return r=new le(a.domain.min,a.domain.max),o=n.range?new le(n.range.min,n.range.max):n.range=new le(1.5,15),u=oi(r,o),e=a.at,i=function(t){return u(e(t))},new me(a.label,i,a,r,o,null)}return new T(n.value)},oo=function(t,n){var e,r,i,o;if(n instanceof Ue){if(o=_.head(t.evaluate(n.field)),!(o instanceof tn))throw new Error("Could not encode shape. Vector ["+o.label+"] is not a Factor.");return n.range||(n.range=new h(Vo(o.domain.length))),i=Vr(o.domain,n.range),e=o.at,r=function(t){return pe[i(e(t))]},new he(o.label,r,o,o.domain,n.range,null)}return new T(pe[n.value]||pe.circle)},co=function(t,n){var e,r;return n?(r=function(){var r,i,o,u;for(o=n.fields,u=[],r=0,i=o.length;i>r;r++)e=o[r],u.push(_.head(t.evaluate(e)));return u}(),new je(r)):void 0},Oo=function(t,n){return[null!=t?t:new O(chroma(_.head(S.c10))),null!=n?n:new E(1)]},Yo=function(t,n,e){return[null!=t?t:new z(chroma(_.head(S.c10))),null!=n?n:new A(1),null!=e?e:new X(1.5)]},Eo=function(t,n,e,r,i,o,u){var a,s,c,l;return a=t||n,s=e||r||i,a||s||(o&&(a=!0),u&&(s=!0)),a&&(c=Oo(t,n),t=c[0],n=c[1]),s&&(l=Yo(e,r,i),e=l[0],r=l[1],i=l[2]),[t,n,e,r,i]},Ki=function(t,n){var e,r;return n.fillColor||n.fillOpacity?[e=Gi(t,n.fillColor),r=Zi(t,n.fillOpacity),so(e,r)]:[]},ao=function(t,n){var e,r;return n.strokeColor||n.strokeOpacity||n.lineWidth?[e=Gi(t,n.strokeColor),r=Zi(t,n.strokeOpacity),so(e,r),Qi(t,n.lineWidth)]:[]},xr=function(t,n,e,r,i){return t.beginPath(),t.rect(n,e,r,i),t.clip()},Ii=function(t,n,e){return t.lineWidth=e,t.strokeStyle=n,t.stroke()},Wi=function(t,n){return t.fillStyle=n,t.fill()},Ti=function(t,n,e,r,i){return t.beginPath(),t.moveTo(n,e),t.lineTo(r,i),t.stroke()},Ei=function(t,n,e,r,i){return t.beginPath(),r>e?t.rect(n-i/2,e,i,r-e):t.rect(n-i/2,r,i,e-r),t.closePath()},Oi=function(t,n,e,r,i){return t.beginPath(),e>n?t.rect(n,r-i/2,e-n,i):t.rect(e,r-i/2,n-e,i),t.closePath()},Yi=function(t,n,e,r,i,o,u,a,s,c){var l,f;return void 0!==n&&void 0!==e&&void 0!==r&&void 0!==i&&void 0!==o&&void 0!==u&&void 0!==a&&void 0!==s&&void 0!==c?(t.strokeStyle=s,t.lineWidth=c,Oi(t,e,i,u,a),t.stroke(),l=a/2,f=a/4,Ti(t,r,u-l,r,u+l),Ti(t,e,u,n,u),Ti(t,i,u,o,u),Ti(t,n,u-f,n,u+f),Ti(t,o,u-f,o,u+f)):void 0},Xi=function(t,n,e,r,i,o,u,a,s,c){var l,f;return void 0!==n&&void 0!==e&&void 0!==r&&void 0!==i&&void 0!==o&&void 0!==u&&void 0!==a&&void 0!==s&&void 0!==c?(t.strokeStyle=s,t.lineWidth=c,Ei(t,n,r,o,a),t.stroke(),l=a/2,f=a/4,Ti(t,n-l,i,n+l,i),Ti(t,n,r,n,e),Ti(t,n,o,n,u),Ti(t,n-f,e,n+f,e),Ti(t,n-f,u,n+f,u)):void 0},ra=function(t,n,e,r){var i,o,u,a,s,c,l,f,h;u=t.slope,i=t.intercept,a=t.strokeColor,s=t.strokeOpacity,o=t.lineWidth,void 0!==i?0===u?e instanceof Bn&&(c=n.range.min,l=n.range.max,f=h=e.scale(i)):n instanceof Bn&&e instanceof Bn&&(c=n.scale(n.domain.min),l=n.scale(n.domain.max),f=e.scale(u*n.domain.min+i),h=e.scale(u*e.domain.max+i)):n instanceof Bn&&(c=l=n.scale(u),f=e.range.min,h=e.range.max),void 0!==c&&void 0!==f&&void 0!==l&&void 0!==h&&(r.save(),r.strokeStyle=Nr(a,s),r.lineWidth=o,Ti(r,c,f,l,h),r.restore())},ii=function(t){var n,e,r,i,o,u;return u=t.position.coordinates,r=u[0],n=u[1],i=t.strokeColor,o=t.strokeOpacity,e=t.lineWidth,new bn(r?r.value:0,n?n.value:void 0,i?i.value:chroma("red"),o?o.value:1,e?e.value:1.5)},hi=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p;return o=n[0],u=n[1],c=new be([o],[u]),a=null!=(h=t.shape)?h:new I("circle"),s=null!=(d=t.size)?d:new M(Si),p=Eo(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!1,!0),e=p[0],r=p[1],l=p[2],f=p[3],i=p[4],new jn(c,o,u,a,s,e,r,l,f,i,t.tooltip)},no=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m;return s=eo(e,n.positionX),c=eo(r,n.positionY),l=oo(t,n.shape),f=Di(t,n.size),g=Ki(t,n),o=g[0],u=g[1],i=g[2],m=ao(t,n),d=m[0],p=m[1],h=m[2],a=m[3],v=co(t,n.tooltip),new An(s,c,l,f,i,o,u,h,d,p,a,v)},So=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(u=n.positionX,a=n.positionY,s=n.shape,c=n.size,r=n.fill,l=n.stroke,o=n.lineWidth,e.save(),d=0,v=t.length;v>d;d++)i=t[d],f=u(i),h=a(i),void 0!==f&&void 0!==h&&(s(i)(e,f,h,c(i)),e.lineWidth=2+(l?o(i):1),e.stroke());for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.fillStyle=e.strokeStyle="black",p=0,g=t.length;g>p;p++)i=t[p],f=u(i),h=a(i),void 0!==f&&void 0!==h&&(s(i)(e,f,h,c(i)),l&&(e.lineWidth=o(i),e.stroke()),r&&e.fill());return e.restore()},Fo=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v;for(a=n.positionX,s=n.positionY,c=n.shape,l=n.size,f=n.stroke,o=n.lineWidth,e.save(),p=0,v=t.length;v>p;p++)i=t[p],h=a(i),d=s(i),void 0!==h&&void 0!==d&&(u=r.put(i),c(i)(e,h,d,l(i)),e.fillStyle=u,e.fill(),f&&(e.lineWidth=o(i),e.strokeStyle=u,e.stroke()));return e.restore()},ua=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p;for(u=n.positionX,a=n.positionY,s=n.shape,c=n.size,r=n.fill,l=n.stroke,o=n.lineWidth,e.save(),d=0,p=t.length;p>d;d++)i=t[d],f=u(i),h=a(i),void 0!==f&&void 0!==h&&(s(i)(e,f,h,c(i)),l&&(e.lineWidth=o(i),e.strokeStyle=l(i),e.stroke()),r&&(e.fillStyle=r(i),e.fill()));return e.restore()},va=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d;for(a=n.positionX,s=n.positionY,c=[],h=0,d=t.length;d>h;h++)u=t[h],l=a(u),f=s(u),void 0!==l&&void 0!==f&&l>=e&&i>=l&&f>=r&&o>=f&&c.push(u);return c},ba=function(t){return _.map(t,function(t){return t.type}).join(", ")},pi=function(t,n){var e,r,i,o,a,s,c,l,f,h,d,p,v,g,m,w,b,_,k,x,C,S,q;switch(g=ba(n)){case"String, Number":return a=n[0],h=n[1],d=new be([a],[h]),m=null!=(w=t.width)?w:new P(.8),b=Eo(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!0,!1),e=b[0],r=b[1],p=b[2],v=b[3],o=b[4],new y(d,a,void 0,h,m,e,r,p,v,o,t.tooltip);case"String, Number, Number":return a=n[0],f=n[1],h=n[2],d=new be([a],[f,h]),m=null!=(_=t.width)?_:new P(.8),k=Eo(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!0,!1),e=k[0],r=k[1],p=k[2],v=k[3],o=k[4],new y(d,a,f,h,m,e,r,p,v,o,t.tooltip);case"Number, String":return c=n[0],l=n[1],d=new be([c],[l]),i=null!=(x=t.height)?x:new Y(.8),C=Eo(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!0,!1),e=C[0],r=C[1],p=C[2],v=C[3],o=C[4],new u(d,void 0,c,l,i,e,r,p,v,o,t.tooltip);case"Number, Number, String":return s=n[0],c=n[1],l=n[2],d=new be([s,c],[l]),i=null!=(S=t.height)?S:new Y(.8),q=Eo(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!0,!1),e=q[0],r=q[1],p=q[2],v=q[3],o=q[4],new u(d,s,c,l,i,e,r,p,v,o,t.tooltip);default:throw new Error("Cannot create rect marks with vectors of type ["+g+"]")}},$i=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m;return s=eo(e,n.positionX),c=n.positionY1?eo(r,n.positionY1):Ui(r,0),l=eo(r,n.positionY2),v=uo(t,n.width,e.rect.width/e.domain.length),g=Ki(t,n),o=g[0],u=g[1],i=g[2],m=ao(t,n),h=m[0],d=m[1],f=m[2],a=m[3],p=co(t,n.tooltip),new w(s,c,l,v,i,o,u,f,h,d,a,p)},Hi=function(t,n,e,r){var o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,_,k;switch(n.space.x.length){case 1:w=n.space.x[0],l=Ui(e,0),f=eo(e,w);break;default:y=n.space.x,m=y[0],w=y[1],l=eo(e,m),f=eo(e,w)}return b=n.space.y[0],h=eo(r,b),s=uo(t,n.height,r.rect.height/r.domain.length),_=Ki(t,n),u=_[0],a=_[1],o=_[2],k=ao(t,n),p=k[0],v=k[1],d=k[2],c=k[3],g=co(t,n.tooltip),new i(l,f,h,s,o,u,a,d,p,v,c,g)},xo=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w;for(u=n.positionX,a=n.positionY1,s=n.positionY2,f=n.width,r=n.fill,c=n.stroke,o=n.lineWidth,e.save(),v=0,m=t.length;m>v;v++)i=t[v],h=u(i),d=a(i),p=s(i),l=f(i),void 0!==h&&void 0!==d&&void 0!==p&&void 0!==l&&(Ei(e,h,d,p,l),e.lineWidth=2+(c?o(i):1),e.stroke());for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.fillStyle=e.strokeStyle="black",g=0,w=t.length;w>g;g++)i=t[g],h=u(i),d=a(i),p=s(i),l=f(i),void 0!==h&&void 0!==d&&void 0!==p&&void 0!==l&&(Ei(e,h,d,p,l),c&&(e.lineWidth=o(i),e.stroke()),r&&e.fill());return e.restore()},ko=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w;for(s=n.positionX1,c=n.positionX2,l=n.positionY,o=n.height,r=n.fill,f=n.stroke,a=n.lineWidth,e.save(),v=0,m=t.length;m>v;v++)u=t[v],h=s(u),d=c(u),p=l(u),i=o(u),void 0!==h&&void 0!==d&&void 0!==p&&void 0!==i&&(Oi(e,h,d,p,i),e.lineWidth=2+(f?a(u):1),e.stroke());for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.fillStyle=e.strokeStyle="black",g=0,w=t.length;w>g;g++)u=t[g],h=s(u),d=c(u),p=l(u),i=o(u),void 0!==h&&void 0!==d&&void 0!==p&&void 0!==i&&(Oi(e,h,d,p,i),f&&(e.lineWidth=a(u),e.stroke()),r&&e.fill());return e.restore()},Ao=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m;for(a=n.positionX,s=n.positionY1,c=n.positionY2,h=n.width,l=n.stroke,o=n.lineWidth,e.save(),g=0,m=t.length;m>g;g++)i=t[g],d=a(i),p=s(i),v=c(i),f=h(i),void 0!==d&&void 0!==p&&void 0!==v&&void 0!==f&&(u=r.put(i),Ei(e,d,p,v,f),Wi(e,u),l&&Ii(e,u,o(i)));return e.restore()},zo=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m;for(c=n.positionX1,l=n.positionX2,f=n.positionY,o=n.height,h=n.stroke,a=n.lineWidth,e.save(),g=0,m=t.length;m>g;g++)u=t[g],d=c(u),p=l(u),v=f(u),i=o(u),void 0!==d&&void 0!==p&&void 0!==v&&void 0!==i&&(s=r.put(u),Oi(e,d,p,v,i),Wi(e,s),h&&Ii(e,s,a(u)));return e.restore()},Qu=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(u=n.positionX,a=n.positionY1,s=n.positionY2,f=n.width,r=n.fill,c=n.stroke,o=n.lineWidth,e.save(),v=0,g=t.length;g>v;v++)i=t[v],h=u(i),d=a(i),p=s(i),l=f(i),void 0!==h&&void 0!==d&&void 0!==p&&void 0!==l&&(Ei(e,h,d,p,l),c&&Ii(e,c(i),o(i)),r&&Wi(e,r(i)));return e.restore()},Ju=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(s=n.positionX1,c=n.positionX2,l=n.positionY,o=n.height,r=n.fill,f=n.stroke,a=n.lineWidth,e.save(),v=0,g=t.length;g>v;v++)u=t[v],h=s(u),d=c(u),p=l(u),i=o(u),void 0!==h&&void 0!==d&&void 0!==p&&void 0!==i&&(Oi(e,h,d,p,i),f&&Ii(e,f(u),a(u)),r&&Wi(e,r(u)));return e.restore()},pa=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d,p,v,g,m,w,b,y;for(a=n.positionX,s=n.positionY1,c=n.positionY2,h=n.width,l=[],b=0,y=t.length;y>b;b++)u=t[b],d=a(u),g=s(u),m=c(u),g>m&&(w=g,g=m,m=w),f=h(u),void 0!==d&&void 0!==g&&void 0!==m&&void 0!==f&&(p=d-f/2,v=d+f/2,e>v||p>i||r>m||g>o||l.push(u));return l},da=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d,p,v,g,m,w,b,y;for(c=n.positionX1,l=n.positionX2,f=n.positionY,a=n.height,h=[],b=0,y=t.length;y>b;b++)s=t[b],d=c(s),p=l(s),g=f(s),d>p&&(v=d,d=p,p=v),u=a(s),void 0!==d&&void 0!==p&&void 0!==g&&void 0!==u&&(m=g-u/2,w=g+u/2,e>p||d>i||r>w||m>o||h.push(s));return h},vi=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b;switch(h=ba(n)){case"String, Number, Number, Number, Number, Number":return p=n[0],i=n[1],o=n[2],u=n[3],a=n[4],s=n[5],c=new be([p],[i,o,u,a,s]),d=null!=(g=t.width)?g:new P(.8),m=Yo(t.strokeColor,t.strokeOpacity,t.lineWidth),l=m[0],f=m[1],r=m[2],new ue(c,p,i,o,u,a,s,d,l,f,r,t.tooltip);case"Number, Number, Number, Number, Number, String":return i=n[0],o=n[1],u=n[2],a=n[3],s=n[4],v=n[5],c=new be([i,o,u,a,s],[v]),e=null!=(w=t.height)?w:new P(.8),b=Yo(t.strokeColor,t.strokeOpacity,t.lineWidth),l=b[0],f=b[1],r=b[2],new re(c,i,o,u,a,s,v,e,l,f,r,t.tooltip)}},ro=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g;return u=eo(e,n.q0),a=eo(e,n.q1),s=eo(e,n.q2),c=eo(e,n.q3),l=eo(e,n.qn),v=eo(r,n.positionY),i=uo(t,n.height,r.rect.height/r.domain.length),g=ao(t,n),h=g[0],d=g[1],f=g[2],o=g[3],p=co(t,n.tooltip),new ne(u,a,s,c,l,v,i,f,h,d,o,p)},qo=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(u=n.positionY,a=n.q0,s=n.q1,c=n.q2,l=n.q3,f=n.qn,r=n.height,h=n.stroke,o=n.lineWidth,e.save(),d=0,v=t.length;v>d;d++)i=t[d],Yi(e,a(i),s(i),c(i),l(i),f(i),u(i),r(i),h(i),2+(h?o(i):1));for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.strokeStyle="black",p=0,g=t.length;g>p;p++)i=t[p],Yi(e,a(i),s(i),c(i),l(i),f(i),u(i),r(i),h(i),o(i));return e.restore()},jo=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y;for(c=n.positionY,l=n.q0,f=n.q1,h=n.q2,d=n.q3,p=n.qn,o=n.height,v=n.stroke,a=n.lineWidth,e.save(),b=0,y=t.length;y>b;b++)u=t[b],g=l(u),m=p(u),w=c(u),i=o(u),void 0!==g&&void 0!==m&&void 0!==w&&void 0!==i&&(s=r.put(u),Oi(e,g,m,w,i),Wi(e,s),Ii(e,s,a(u)));return e.restore()},sa=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p;for(u=n.positionY,a=n.q0,s=n.q1,c=n.q2,l=n.q3,f=n.qn,r=n.height,h=n.stroke,o=n.lineWidth,e.save(),d=0,p=t.length;p>d;d++)i=t[d],Yi(e,a(i),s(i),c(i),l(i),f(i),u(i),r(i),h(i),o(i));return e.restore()},ga=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,_,k,x,C,S;for(l=n.positionY,f=n.q0,h=n.q1,d=n.q2,p=n.q3,v=n.qn,a=n.height,m=n.stroke,c=n.lineWidth,g=[],C=0,S=t.length;S>C;C++)s=t[C],w=f(s),b=v(s),_=l(s),w>b&&(y=w,w=b,b=y),u=a(s),void 0!==w&&void 0!==b&&void 0!==_&&void 0!==u&&(k=_-u/2,x=_+u/2,e>b||w>i||r>x||k>o||g.push(s));return g},io=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g;return v=eo(e,n.positionX),o=eo(r,n.q0),u=eo(r,n.q1),a=eo(r,n.q2),s=eo(r,n.q3),c=eo(r,n.qn),p=uo(t,n.width,e.rect.width/e.domain.length),g=ao(t,n),f=g[0],h=g[1],l=g[2],i=g[3],d=co(t,n.tooltip),new ie(v,o,u,a,s,c,p,l,f,h,i,d)},No=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(o=n.positionX,u=n.q0,a=n.q1,s=n.q2,c=n.q3,l=n.qn,h=n.width,f=n.stroke,i=n.lineWidth,e.save(),d=0,v=t.length;v>d;d++)r=t[d],Xi(e,o(r),u(r),a(r),s(r),c(r),l(r),h(r),f(r),2+(f?i(r):1));for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.strokeStyle="black",p=0,g=t.length;g>p;p++)r=t[p],Xi(e,o(r),u(r),a(r),s(r),c(r),l(r),h(r),f(r),i(r));return e.restore()},Lo=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y;for(a=n.positionX,s=n.q0,c=n.q1,l=n.q2,f=n.q3,h=n.qn,v=n.width,d=n.stroke,o=n.lineWidth,e.save(),b=0,y=t.length;y>b;b++)i=t[b],g=a(i),m=s(i),w=h(i),p=v(i),void 0!==g&&void 0!==m&&void 0!==w&&void 0!==p&&(u=r.put(i),Ei(e,g,m,w,p),Wi(e,u),Ii(e,u,o(i)));return e.restore()},ca=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p;for(o=n.positionX,u=n.q0,a=n.q1,s=n.q2,c=n.q3,l=n.qn,h=n.width,f=n.stroke,i=n.lineWidth,e.save(),d=0,p=t.length;p>d;d++)r=t[d],Xi(e,o(r),u(r),a(r),s(r),c(r),l(r),h(r),f(r),i(r));return e.restore()},ma=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,_,k,x,C,S;for(s=n.positionX,c=n.q0,l=n.q1,f=n.q2,h=n.q3,d=n.qn,m=n.width,v=n.stroke,a=n.lineWidth,p=[],C=0,S=t.length;S>C;C++)u=t[C],w=s(u),_=c(u),k=d(u),_>k&&(x=_,_=k,k=x),g=m(u),void 0!==w&&void 0!==_&&void 0!==k&&void 0!==g&&(b=w-g/2,y=w+g/2,e>y||b>i||r>k||_>o||p.push(u));return p},fi=function(t,n){var e,r,i,o,u,a,s;return r=n[0],i=n[1],o=new be([r],[i]),s=Yo(t.strokeColor,t.strokeOpacity,t.lineWidth),u=s[0],a=s[1],e=s[2],new Mn(o,r,i,u,a,e,t.tooltip)},to=function(t,n,e,r){var i,o,u,a,s,c,l,f;return o=eo(e,n.positionX),u=eo(r,n.positionY),f=ao(t,n),s=f[0],c=f[1],a=f[2],i=f[3],l=co(t,n.tooltip),new Yn(o,u,a,s,c,i,l)},Co=function(t,n,e){var r,i,o,u,a,s,c;for(i=n.positionX,o=n.positionY,e.save(),s=0,c=t.length;c>s;s++)r=t[s],u=i(r),a=o(r),e.lineWidth=1.5,e.strokeStyle="black",void 0!==u&&void 0!==a&&(zi(e,u,a,64),e.stroke());return e.restore()},Po=function(t,n,e,r){var i,o,u,a,s,c,l;for(o=n.positionX,u=n.positionY,e.save(),c=0,l=t.length;l>c;c++)i=t[c],a=o(i),s=u(i),void 0!==a&&void 0!==s&&(zi(e,a,s,64),e.fillStyle=r.put(i),e.fill());return e.restore()},ia=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,_;if(u=n.positionX,a=n.positionY,s=n.stroke,o=n.lineWidth,s instanceof T&&o instanceof T){for(e.strokeStyle=s(),e.lineWidth=o(),e.save(),w=!1,m=0,y=t.length;y>m;m++)i=t[m],f=u(i),p=a(i),void 0!==f&&void 0!==p?w?e.lineTo(f,p):(e.beginPath(),w=!0,e.moveTo(f,p)):(w&&e.stroke(),w=!1);return e.restore()}for(e.save(),e.lineCap="round",w=!1,h=void 0,v=void 0,c=void 0,b=0,_=t.length;_>b;b++)i=t[b],d=u(i),g=a(i),void 0!==d&&void 0!==g?(l=s(i),w&&(l!==c?(r=e.createLinearGradient(h,v,d,g),r.addColorStop(0,c||Le),r.addColorStop(1,l||Le),e.strokeStyle=r):e.strokeStyle=l,e.lineWidth=o(i),e.beginPath(),e.moveTo(h,v),e.lineTo(d,g),e.stroke()),w=!0,h=d,v=g,c=l):w=!1;return e.restore()},ai=qi([Pn,Array,hi],[Xn,Array,fi],[Kn,Array,pi],[te,Array,vi]),jr=qi([yn,ii]),Fn=new sn(no,Fo,So,ua,va),In=new sn(to,Po,Co,ia,va),b=new sn($i,Ao,xo,Qu,pa),o=new sn(Hi,zo,ko,Ju,da),ee=new sn(ro,jo,qo,sa,ga),oe=new sn(io,Lo,No,ca,ma),Ko=qi([Number,null,function(t){return new s(t,void 0)}],[null,Number,function(t,n){return new s(void 0,n)}],[Number,Number,function(t,n){return new s(t,n)}],[null,null,function(){return new s(void 0,void 0)}]),tu=qi([Number,Number,function(t,n){return new G(t,n)}]),nu=qi([Number,Number,function(t,n){return new U(t,n)}]),uu=qi([an,_.identity],[Function,function(t){return new L(t)}]),Fu=qi([Number,function(t){return new On(t)}],[Boolean,function(t){return new a(t)}],[Date,function(t){return new R(t)}],[String,function(t){return new _e(t)}]),Nu=qi([Array,function(t){return new h(t)}],[Number,function(t){return t>0?new le(0,t):0>t?new le(t,0):new H(-1,0,1)}],[String,function(t){return new ce(t,"black")}],[Number,Number,function(t,n){return n>=t?new le(t,n):new le(n,t)}],[String,String,function(t,n){return new ce(t,n)}],[Number,Number,Number,function(t,n,e){var r,i,o,u;return u=_.sortBy([t,n,e],_.identity),r=u[0],i=u[1],o=u[2],new H(r,i,o)}],[String,String,String,function(t,n,e){return new D(t,n,e)}]),qr=function(t){var n,e,r,i,o;for(o=[],r=0,i=t.length;i>r;r++)if(n=t[r],n instanceof en)o.push(n);else{if(Me!==(e=ya(n)))throw new Error("Cannot create vector reference from ["+n+"] of type ["+e+"].");o.push(new en(n))}return o},qu=function(){var t,n,e;return n=1<=arguments.length?Ta.call(arguments,0):[],new Ln(_.every(n,function(t){return t instanceof Re})?function(){var e,r,i;for(i=[],e=0,r=n.length;r>e;e++)t=n[e],i.push(new W(t.value));return i}():function(){var t,r,i,o;for(i=qr(n),o=[],t=0,r=i.length;r>t;t++)e=i[t],o.push(new Be(e));return o}())},iu=qi([_e,function(t){return new O(chroma(t.value))}],[String,function(t){return new De(new en(t))}],[en,function(t){return new De(t)}],[String,q,function(t,n){return new De(new en(t),n)}],[en,q,function(t,n){return new De(t,n)}],[String,h,function(t,n){return new De(new en(t),n)}],[en,h,function(t,n){return new De(t,n)}]),ou=qi([On,function(t){return new E(t.value)}],[String,function(t){return new He(new en(t))}],[en,function(t){return new He(t)}],[String,le,function(t,n){return new He(new en(t),n)}],[en,le,function(t,n){return new He(t,n)}]),Mu=qi([_e,function(t){return new z(chroma(t.value))}],[String,function(t){return new Je(new en(t))}],[en,function(t){return new Je(t)}],[String,q,function(t,n){return new Je(new en(t),n)}],[en,q,function(t,n){return new Je(t,n)}],[String,h,function(t,n){return new Je(new en(t),n)}],[en,h,function(t,n){return new Je(t,n)}]),zu=qi([On,function(t){return new A(t.value)}],[String,function(t){return new Qe(new en(t))}],[en,function(t){return new Qe(t)}],[String,le,function(t,n){return new Qe(new en(t),n)}],[en,le,function(t,n){return new Qe(t,n)}]),Ni=function(t,n){return qi([On,function(n){return new t(n.value)}],[String,function(t){return new n(new en(t))}],[en,function(t){return new n(t)}],[String,le,function(t,e){return new n(new en(t),e)}],[en,le,function(t,e){return new n(t,e)}])},Xu=Ni(M,Ke),Lu=Ni(P,tr),fu=Ni(Y,$e),mu=qi([On,function(t){return new X(t.value)}],[String,function(t){return new Ge(new en(t))}],[en,function(t){return new Ge(t)}],[String,le,function(t,n){return new Ge(new en(t),n)}],[en,le,function(t,n){return new Ge(t,n)}]),Yu=qi([_e,function(t){return new I(t.value)}],[String,function(t){return new Ue(new en(t))}],[en,function(t){return new Ue(t)}],[String,h,function(t,n){return new Ue(new en(t),n)}],[en,h,function(t,n){return new Ue(t,n)}]),Pu=function(){var t;return t=1<=arguments.length?Ta.call(arguments,0):[],new Ze(qr(t))},Ou=function(){var t,n;return n=1<=arguments.length?Ta.call(arguments,0):[],1===n.length&&_.isNumber(t=_.head(n))?new Gn(t):new se(qr(n))},Hu=function(t){var n,e,r,i,o;for(o=[],e=0,r=t.length;r>e;e++)switch(n=t[e],n.type){case"string":o.push({label:n.name,type:"String",domain:null!=(i=n.lightningDomain)?i:[],parse:vr});break;case"integer":o.push({label:n.name,type:"Number",parse:gr});break;case"number":o.push({label:n.name,type:"Number",parse:mr});break;default:throw new Error("Invalid type ["+n.type+"] for schema field ["+n.name+"]")}return o},Du=function(t,n,e,r){var i,o,u,a,s,c,l,f;return a=Papa.parse(e,{skipEmptyLines:!0}),c=a.data,r&&c.shift(),f=function(){var t,r,a,f,h;for(h=[],u=t=0,a=n.length;a>t;u=++t){for(i=n[u],e=new Array(c.length),o=r=0,f=c.length;f>r;o=++r)s=c[o],void 0!==(l=i.parse(s[u]))&&(e[o]=l);switch(i.type){case"String":h.push(Zr(i.label,i.type,e,i.domain));break;case"Number":h.push(ki(i.label,i.type,e,_.identity));break;default:h.push(void 0)}}return h}(),ei(t,f,_.range(c.length))},Jo=function(t,n,e,r,i){return function(o){var u,a,s,c,l,f;return l=Math.floor((e-n)/r),u=function(t){return n+t*r},s=function(t,n){var e;return e=function(t){return n(u(t))},ri(t,t,"Number",l,e,_.identity)},f=function(){var t;t=[];for(c in i)a=i[c],t.push(s(c,a));return t}(),f.unshift(ri(t,t,"Number",l,u,_.identity)),o(null,ei("computed",f,_.range(l)))}},Zo=function(t){return function(n){return Mi("json",t+"/datapackage.json",function(e,r){var i,o;return e?n(e):(i=_.head(r.resources))?(o=i.path)?Mi("text",t+"/"+o,function(t,e){if(t)return n(t);try{return n(null,Du(r.name,Hu(i.schema),e,!0))}catch(o){return t=o,n(t)}}):n(new Error("Resource is missing attribute [path].")):n(new Error("No resources found in data package."))})}},Jr=function(){var t,n;return t=arguments[0],n=2<=arguments.length?Ta.call(arguments,1):[],function(){var e;return e=1<=arguments.length?Ta.call(arguments,0):[],dr(t,bo(e,n))}},Su=Jr(Pn,Ln,fe,ge,on,un,xe,Ce,_n,Fe),Wu=Jr(Kn,Ln,or,pn,on,un,xe,Ce,_n,Fe),Cu=Jr(Xn,Ln,xe,Ce,_n,Fe),Tu=Jr(te,Ln,or,pn,xe,Ce,_n,Fe),gu=Jr(yn,Ln,xe,Ce,_n),xu=function(t,n){var e;return e=function(t,n){var r,i,o,u;if(_.isArray(t)){for(i=t.length,o=[];i--;)r=t[i],null!==r&&_.isObject(r)?(e(r,n),o.push(n(r))):o.push(void 0);return o}u=[];for(i in t)Ea.call(t,i)&&(r=t[i],null!==r&&_.isObject(r)?(e(r,n),u.push(n(r))):u.push(void 0));return u},function(r){var i;return i=t.parse(r),e(i,function(t){var n;"CallExpression"===t.type&&"Identifier"===t.callee.type?_.isFunction(Do[n=t.callee.name])&&(t.callee={type:"MemberExpression",computed:!1,object:{type:"Identifier",name:"plot"},property:{type:"Identifier",name:n}}):"Identifier"===t.type&&_.isFunction(Do[n=t.name])&&(delete t.name,t.type="MemberExpression",t.computed=!1,t.object={type:"Identifier",name:"plot"},t.property={type:"Identifier",name:n})}),n.generate(i)}},Eu={maxCanvasSize:new ve(795,600),visualizationSize:new ve(300,300),axisLabelFont:"10px monospace",axisTickColor:"#4d4d4d",axisTitleFont:"bold 10px monospace",axisLabelColor:"#4d4d4d",gridLineColor:"#eee",originLineColor:"#ccc"},Ru=function(t){return Math.round(t)+"px"},$r=function(t,n){var e,r,i,o;e=document.createElement(t),i=e.style;for(r in n)o=n[r],i[r]=o;return e},$u=function(t){for(var n;n=t.firstChild;)t.removeChild(n)},yi=function(t){var n,e;n=document.createElement("style"),n.type="text/css",n.innerHTML=t,e=_.head(document.getElementsByTagName("head")),e.appendChild(n)},_i=function(t){var n,e,r,i,o,u,a,s,c;return c=diecut("table","tbody","tr","th","td"),r=c[0],i=c[1],a=c[2],u=c[3],o=c[4],e=function(){var e;e=[];for(n in t)s=t[n],e.push(a([o(n+":"),u(s)]));return e}(),ea(r(i(e)))},Br=function(t){var n,e,r,i,o,u,a;return a=t.width,o=t.height,i=document.createElement("canvas"),e=i.getContext("2d"),r=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,u=r/n,i.style.position="absolute",r!==n?(i.width=a*u,i.height=o*u,e.scale(u,u),i.style.width=Ru(a),i.style.height=Ru(o)):(i.width=a,i.height=o),new l(i,e,t,u)},xi=function(t){var n,e,r,i,o,u,a,s,c,l,f,h;return h=function(){var n,e;for(e=[],a=n=1;5>=n;a=++n)e.push(Br(t));return e}(),n=h[0],o=h[1],u=h[2],l=h[3],r=h[4],i=$r("div",{position:"relative",overflow:"visible",width:Ru(t.width),height:Ru(t.height)}),i.className="lz",s=$r("div",{position:"absolute",left:Ru(0),top:Ru(0),width:Ru(0),height:Ru(0),display:"none",outline:"1px dotted #999",background:"rgba(0, 0, 0, 0.05)"}),f=$r("div",{position:"absolute",left:Ru(0),top:Ru(0),"max-width":Ru(.9*t.width),display:"none"}),f.className="lz-tooltip",i.appendChild(n.element),i.appendChild(o.element),i.appendChild(s),i.appendChild(u.element),i.appendChild(f),c=si(l),e=Dr(r),new er(t,i,n,o,u,l,r,s,f,c,e)},_o=function(t){var n,e,r;return e=null!=(r=t.target)?r:t.srcElement,n=e.getBoundingClientRect(),[t.clientX-n.left,t.clientY-n.top]},yr=function(t,n,e,r,i){var o,u,a,s,c,l,f,h,d,p;u=$(document),o=$(t),s=n.style,c=h=l=d=f=p=0,a=!1,o.on("mousemove",function(t){var n;return c=t.offsetX,h=t.offsetY,(void 0===c||void 0===h)&&(n=_o(t),c=n[0],h=n[1]),a?(s.left=Ru(c>l?l:c),s.top=Ru(h>d?d:h),s.width=Ru(Math.abs(c-l)),s.height=Ru(Math.abs(h-d))):e(c,h)}),o.on("mousedown",function(t){var n;return t.preventDefault(),l=t.offsetX,d=t.offsetY,(void 0===l||void 0===d)&&(n=_o(t),l=n[0],d=n[1]),a=!0,s.display="block",s.left=Ru(l),s.top=Ru(d),u.on("mouseup",function(t){var n;return t.preventDefault(),f=t.offsetX,p=t.offsetY,(void 0===f||void 0===p)&&(n=_o(t),f=n[0],p=n[1]),a=!1,s.display="none",s.width=Ru(0),s.height=Ru(0),u.off("mouseup"),Math.abs(l-f)>5||Math.abs(d-p)>5?r(l,d,f,p):i(l,d)})})},Kr=function(){var t,n,e,r;return r={},n=function(t,n){var e;return(e=r[t])?e.push(n):r[t]=[n]},e=function(t,n){var e,i,o,u,a;if(t)if(n){if(o=r[t])for(e=u=0,a=o.length;a>u;e=++u)if(i=o[e],i===n){o.splice(e,1);break}}else delete r[t]},t=function(){var t,n,e,i,o,u;if(n=arguments[0],t=2<=arguments.length?Ta.call(arguments,1):[],i=r[n])for(o=0,u=i.length;u>o;o++)e=i[o],e.apply(null,t)},[n,e,t]},Ci=function(t,n,e,r,i,o,u){var a,s,c,l,f,h,d,p,v,g,m,w,b,y,k,x,C,S,q,N,W,T,O;return O=xi(t),a=O.baseCanvas,d=O.highlightCanvas,v=O.hoverCanvas,c=O.clipCanvas,w=O.maskCanvas,g=O.marquee,S=O.tooltip,m=O.mask,s=O.clip,q=t.regions.center,W=n.indices,N=void 0,C=function(n,r){var i,o,u,a,l;if(o=m.test(n,r),void 0!==o)for(i=c.context,i.clearRect(0,0,t.width,t.height),a=0,l=e.length;l>a;a++)if(u=e[a],i.save(),i.translate(q.left,q.top),u.mask([o],u.encoders,i,s),i.restore(),s.test(n,r))return o},l=function(t,n,e){var r;return r=_i(e),$u(S),S.appendChild(r),S.style.display="block",b(t,n)},T=7,b=function(n,e){var r,i,o,u;if("none"!==S.style.display)return u=S.clientWidth,o=S.clientHeight,r=n+T,i=e-T-o,r+u>t.width&&(r=n-T-u),0>i&&(i=e+T),0>r&&(r=0),0>i&&(i=0),S.style.left=Ru(r),S.style.top=Ru(i)},f=function(){return S.style.display="none"},p=function(r,i){var o,a,s,c,h,d,p,g,m,w,y,_,k,x,S;if(c=C(r,i),c!==N){if(N=c,s=v.context,s.clearRect(0,0,t.width,t.height),f(),void 0!==c){for(s.save(),s.translate(q.left,q.top),g=0,y=e.length;y>g;g++)h=e[g],h.highlight([c],h.encoders,s);for(s.restore(),u("markhover",new vn(n.vectors,c)),d={},m=0,_=e.length;_>m;m++){h=e[m],x=h.encodings;for(o in x)if(a=x[o])if(a instanceof Ve)(p=a.vector)&&(d[p.label]=p.format(c));else if(a instanceof je)for(S=a.vectors,w=0,k=S.length;k>w;w++)p=S[w],d[p.label]=p.format(c)}l(r,i,d)}}else b(r,i)},h=function(n){var r,i,o,u;if(r=d.context,r.clearRect(0,0,t.width,t.height),n.length){for(a.element.style.opacity=.5,r.save(),r.translate(q.left,q.top),o=0,u=e.length;u>o;o++)i=e[o],i.highlight(n,i.encoders,r),i.render(n,i.encoders,r);r.restore()}else a.element.style.opacity=1},k=function(t,e){var r;r=C(t,e),void 0!==r?(h([r]),u("markselect",new ae(n.vectors,[r]))):(h([]),u("markdeselect",new V(n.vectors)))},x=function(t,r,i,o){var a,s,c,l,f,d,p;f=-q.left+(t>i?i:t),l=-q.left+(t>i?t:i),p=-q.top+(r>o?o:r),d=-q.top+(r>o?r:o),c=function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)a=e[t],r.push(a.select(W,a.encoders,f,p,l,d));return r}(),s=e.length>1?_.unique(_.flatten(c,!0)):_.head(c),h(s),s.length?u("markselect",new ae(n.vectors,s)):u("markdeselect",new V(n.vectors))},y=function(){var n,u,s,c,l,f,h,d;for(u=a.context,c=w.context,ta(u,i,q),na(u,o,q),u.save(),u.translate(q.left,q.top),c.save(),c.translate(q.left,q.top),l=0,h=e.length;h>l;l++)s=e[l],s.render(W,s.encoders,u),s.mask(W,s.encoders,c,m);for(f=0,d=r.length;d>f;f++)n=r[f],n.render(n,i,o,u);c.restore(),u.restore(),Uu(u,i,t.regions.bottom),Ku(u,o,t.regions.left)},yr(v.element,g,p,x,k),new rr(O,n,C,h,p,k,x,y)},Gu=function(t,n,e,r,i){var o,u,a,s,c,l,h,d,p,v,g,m,w,b,y,_,k,x,C,S,q;if(t.font=Eu.axisLabelFont,t.fillStyle=Eu.axisLabelColor,t.strokeStyle=Eu.axisTickColor,t.textBaseline="middle",_=Sa+4,d=e-_,t.save(),xr(t,_,0,d,r),t.textAlign="right",y=e-5,l=e-6,n instanceof f){for(o=n.guide(),v=Math.floor(r/(Sa+2)),a=Math.floor(o.length/v),s=k=0,C=o.length;C>k;s=++k)u=o[s],m=n.scale(u),b=-.5+Math.round(m),Ti(t,y,b,e,b),(0===a||0!==s&&0===s%a)&&t.fillText(u.value,l,m,d-6);
Ti(t,e-.5,0,e-.5,r)}else{if(!(n instanceof Bn))throw new Error("Invalid axis type.");for(g=6,p=r-6,q=n.guide(),x=0,S=q.length;S>x;x++)w=q[x],c=w.label,m=n.scale(w.value),b=Math.max(.5,-.5+Math.round(m)),Ti(t,y,b,e,b),h=g>m?g:m>p?p:m,t.fillText(c,l,h,d-6);Ti(t,e-.5,0,e-.5,r)}return t.restore(),t.font=Eu.axisTitleFont,t.textAlign="center",t.translate(_/2,r/2),t.rotate(i*fn),t.fillText(n.label,0,0,r),t.restore()},Zu=function(t,n,e,r){var i,o,u,a,s;if(t.strokeStyle=Eu.gridLineColor,n instanceof f)Ti(t,0,.5,e,.5),Ti(t,0,r-.5,e,r-.5);else if(n instanceof Bn){for(s=n.guide(),u=0,a=s.length;a>u;u++)i=s[u],o=Math.max(.5,-.5+Math.round(n.scale(i.value))),Ti(t,0,o,e,o);n.domain.min<=0&&0<=n.domain.max&&(t.strokeStyle=Eu.originLineColor,o=Math.max(.5,-.5+Math.round(n.scale(0))),Ti(t,0,o,e,o))}},ta=function(t,n,e){return t.save(),t.translate(e.left,e.top+e.height),t.rotate(-fn),Zu(t,n,e.height,e.width),t.restore()},na=function(t,n,e){return t.save(),t.translate(e.left,e.top),Zu(t,n,e.width,e.height),t.restore()},Uu=function(t,n,e){return t.save(),t.translate(e.left,e.top+e.height),t.rotate(-fn),Gu(t,n,e.height,e.width,1),t.restore()},Ku=function(t,n,e){return t.save(),t.translate(e.left,e.top),Gu(t,n,e.width,e.height,-1),t.restore()},ea=function(t){var n;return n=document.createElement("div"),n.innerHTML=t,n.childNodes[0]},go=function(t,n){var e,r,i,o,u,a,s;for(r={},i=[],a=0,s=n.length;s>a;a++)o=n[a],u=(e=t.at(o)).key,r[u]||(r[u]=!0,i.push(e));return i},wi=function(t,n){var e,r,i,o,u,a;for(r=null,e=null,a=null,o=0,u=t.length;u>o;o++)if(i=t[o],null===r)switch(r=i.type){case Me:a=i,e=go(i,n);break;case Ye:e=i.domain;break;default:throw new Error("ni")}else{if(r!==i.type)throw new Error("Incompatible axis vector ["+i.label+"]. Expect type ["+r+"], got ["+i.type+"]");switch(r){case Me:if(a!==i)throw new Error("Incompatible categorical vector ["+i.label+"]. Expected ["+a.label+"].");break;case Ye:e=Wr(e,i.domain);break;default:throw new Error("ni")}}return new we(r,t,e)},Rr=function(t){var n,e;return n=function(){var n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(e.label);return i}(),_.unique(n).join(", ")},Tr=function(t,n){var e,r,i,o,u,a,c,l,h,d,p,v,g;if(c=new Un(0,0,400,400),e=Lr(t,"",n,new le(0,c.width),c),a=Sa+4+6+10,e instanceof f){for(u=0,r=e.guide(),h=0,p=r.length;p>h;h++)i=r[h],u<(o=(""+i.value).length)&&(u=o);return new s(Math.ceil(u*Sa+a),Math.ceil(r.length*(Sa+8)))}if(e instanceof Bn){for(u=0,r=e.guide(),g=e.guide(),d=0,v=g.length;v>d;d++)l=g[d],u<(o=l.label.length)&&(u=o);return new s(Math.ceil(u*Sa+a),Eu.visualizationSize.height)}throw new Error("Invalid axis type.")},Lr=function(t,n,e,r,i){var o,u,a,s,c;switch(t){case Me:return u=li(e,r),o=function(){return e},new f(t,n,u,e,r,i,o);case Ye:return c=ci(e,r),u=c[0],a=c[1],s=c[2],o=function(t){var n,e,r,i,o,u;for(null==t&&(t=10),n=a(t),o=s(t),u=[],r=0,i=o.length;i>r;r++)e=o[r],u.push(new Pe(e,n(e)));return u},new kn(t,n,u,e,r,i,o);default:throw new Error("Unhandled axis type ["+t+"].")}},fa=function(t,n){var e,r;return r=di(n),e=Vu(t,r),wo(n,se)?la(e,n):wo(n,Gn)?aa(e,n):oa(e,n)},aa=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p,v,g,m;return u=wo(n,Gn),i=u.index,m=diecut("table.lz-record","tbody","tr","th","td"),s=m[0],c=m[1],h=m[2],f=m[3],l=m[4],d=function(){var n,e;n=t.schema,e=[];for(o in n)g=n[o],v=g.format(i),r=function(){switch(g.type){case Me:return void 0!==v?v:"-";case Ye:return void 0!==v?_.escape(v):"-";case Xe:return void 0!==v?v:"-";default:throw new Error("Cannot render table cell of type "+g.type)}}(),e.push(h([f(_.escape(g.label)),l(r)]));return e}(),e=ea(s(c(d))),a=_.noop,p=_.noop,new zn(e,a,p)},la=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p,g,m,w,b,y,k,x,C,S,q,N;return u=wo(n,se),C=function(){var n,e,i,o;if(u.fields.length){for(i=u.fields,o=[],n=0,e=i.length;e>n;n++)r=i[n],o.push(t.evaluate(r));return o}return t.vectors}(),S=_.flatten(C),q=diecut("table.lz-table","thead","tbody","tr","th","th.lz-number","td","td.lz-number"),s=q[0],p=q[1],c=q[2],w=q[3],d=q[4],g=q[5],l=q[6],f=q[7],m=function(){var t,n,e;for(e=[],t=0,n=S.length;n>t;t++)switch(x=S[t],x.type){case Ye:e.push(g(_.escape(x.label)));break;default:e.push(d(_.escape(x.label)))}return e}(),b=function(){var n,e,r,o;for(r=t.indices,o=[],n=0,e=r.length;e>n;n++)i=r[n],h=function(){var t,n,e;for(e=[],t=0,n=S.length;n>t;t++)switch(x=S[t],k=x.format(i),x.type){case Me:e.push(l(void 0!==k?k:"-"));break;case Ye:e.push(f(void 0!==k?_.escape(k):"-"));break;case Xe:e.push(l(void 0!==k?k:"-"));break;default:throw new Error("Cannot render table cell of type "+x.type)}return e}(),o.push(w(h));return o}(),e=ea(s([p(w(m)),c(b)])),N=Kr(),a=N[0],y=N[1],o=N[2],$(e).on("click",function(n){var e,r,i,u,a,s;switch(r=$(n.target),e=r.parent(),u=e.prop("tagName").toLowerCase(),s=r.prop("tagName").toLowerCase(),a=r.index(),i=e.index(),s){case"td":o("cellselect",new v(S[a],t.indices[i]));break;case"th":o("headerselect",new dn(S[a]))}}),new zn(e,a,y)},Or=function(t,n,e){return t.type===Ye?e?Wr(t.domain,e):n.type===Me?Wo(t.domain):t.domain:t.domain},oa=function(t,n){var r,i,o,u,a,l,f,h,d,p,v,g,m,w,b,y,k,x,C,S,q,N,W,T,O,E,Y,X,I,M;return b=_.map(vo(n,Nn),function(n){var e,r;return r=function(){var r,i,o,u;for(o=n.position.coordinates,u=[],r=0,i=o.length;i>r;r++)e=o[r],u.push(t.evaluate(e.field));return u}(),ai(n,_.flatten(r))}),q=_.map(b,function(t){return t.space}),T=yo(q,function(t){return t.x}),O=yo(q,function(t){return t.y}),C=wi(T,t.indices),S=wi(O,t.indices),g=Or(C,S,wo(n,G)),m=Or(S,C,wo(n,U)),i=Tr(C.type,g),o=Tr(S.type,m),h=null!=(Y=wo(n,s))?Y:new s(void 0,void 0),p=null!=(X=h.width)?X:Math.min(Eu.maxCanvasSize.width,o.width+i.height),d=null!=(I=h.height)?I:Math.min(Eu.maxCanvasSize.height,i.width+o.height),v=new c(p,d,new Sn(Math.min(.3*Eu.maxCanvasSize.width,o.width),0,0,Math.min(.3*Eu.maxCanvasSize.height,i.width))),u=v.regions.bottom,a=v.regions.left,k=new le(0,u.width),x=S.type===Ye?new le(a.height,0):new le(0,a.height),l=Lr(C.type,Rr(T),g,k,u),f=Lr(S.type,Rr(O),m,x,a),w=_.map(b,function(n){var e,r,i,o,u;i=n.geometry,r=i.encode(t,n,l,f),e={};for(o in r)u=r[o],(null!=u?u.encode:void 0)&&(e[o]=u.encode);return new gn(r,e,i.mask,i.highlight,i.render,i.select)}),r=_.map(vo(n,e),function(t){return jr(t)}),M=Kr(),N=M[0],W=M[1],y=M[2],E=Ci(v,t,w,r,l,f,y),E.render(),new zn(E.viewport.container,N,W)},_a=qi([L,Array,Function,function(t,n,e){return t.read(function(t,r){return t?e(t):_a(r,n,e)})}],[an,Array,Function,function(t,n,e){var r;try{return e(null,fa(t,n))}catch(i){return r=i,e(r)}}]),Mo=function(){return yi(".lz-tooltip {\n  background: #2c2c2c;\n  color: #fff;\n  font-size: 12px;\n}\n.lz-tooltip th, .lz-tooltip td {\n  padding: 0px 4px;\n  vertical-align: middle;\n}\n.lz-tooltip th {\n  text-align: left;\n}\n.lz-table th, .lz-table td {\n  padding: 0px 8px;\n  vertical-align: middle;\n}\n.lz-table tbody > tr:nth-child(odd) {\n  background-color: #f3f3f3;\n}\n.lz-table .lz-number {\n  text-align: right;\n}\n.lz-record th, .lz-record td {\n  padding: 0px 8px;\n  vertical-align: middle;\n}\n.lz-record th {\n  text-align: right;\n}\n.lz-record tbody > tr:nth-child(odd) {\n  background-color: #f3f3f3;\n}")},Na=null,Sa=18,Io=function(){var t,n;return Na=t=Br(new s(100,100)),n=t.context,n.font=Eu.axisLabelFont,Sa=n.measureText("M").width},qa=!1,Xo=function(){return qa?void 0:(Mo(),Io(),qa=!0)},Do=function(){var t,n;return n=1<=arguments.length?Ta.call(arguments,0):[],(t=wo(n,L,an))?(Xo(),function(e){var r;return r=_.isElement(e)?function(t,n){return t?e.innerHTML=t.message:e.appendChild(n.element)}:_.isFunction(e)?e:void 0,r?_a(t,_.without(n,t),r):void 0}):function(){var t;return t=1<=arguments.length?Ta.call(arguments,0):[],Do.apply(null,n.concat(t))}},Do.VERSION="0.1.16",Do.settings=Eu,Do.bounds=Ko,Do.from=uu,Do.value=Fu,Do.range=Nu,Do.position=qu,Do.fillColor=iu,Do.fillOpacity=ou,Do.strokeColor=Mu,Do.strokeOpacity=zu,Do.size=Xu,Do.width=Lu,Do.height=fu,Do.lineWidth=mu,Do.shape=Yu,Do.tooltip=Pu,Do.factor=ru,Do.stack=Iu,Do.groupBy=su,Do.where=ju,Do.limit=vu,Do.having=lu,Do.eq=eu,Do.ne=_u,Do.lt=wu,Do.gt=cu,Do.le=du,Do.ge=au,Do.like=pu,Do.avg=Uo,Do.count=Qo,Do.max=bu,Do.min=yu,Do.sum=Au,Do.parse=xu,Do.point=Su,Do.rect=Wu,Do.path=Cu,Do.schema=Tu,Do.line=gu,Do.select=Ou,Do.dataPackage=Zo,Do.computed=Jo,Do.createFrame=ei,Do.createVector=ki,Do.createList=ui,Do.createFactor=Zr,Do.domainX_HACK=tu,Do.domainY_HACK=nu,null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=Do:window.plot=Do}).call(this);
