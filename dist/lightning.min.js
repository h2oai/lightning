(function(){var t,n,e,r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,k,x,C,S,q,N,W,T,O,E,Y,X,I,M,z,A,P,F,j,L,R,B,V,D,H,G,U,K,J,Q,Z,tt,nt,et,rt,it,ot,ut,at,st,ct,lt,ft,ht,dt,pt,vt,gt,mt,wt,bt,yt,_t,kt,xt,Ct,St,qt,Nt,Wt,Tt,Ot,Et,Yt,Xt,It,Mt,zt,At,Pt,Ft,jt,Lt,Rt,Bt,Vt,Dt,Ht,$t,Gt,Ut,Kt,Jt,Qt,Zt,tn,nn,en,rn,on,un,an,sn,cn,ln,fn,hn,dn,pn,vn,gn,mn,wn,bn,yn,_n,kn,xn,Cn,Sn,qn,Nn,Wn,Tn,On,En,Yn,Xn,In,Mn,zn,An,Pn,Fn,jn,Ln,Rn,Bn,Vn,Dn,Hn,$n,Gn,Un,Kn,Jn,Qn,Zn,te,ne,ee,re,ie,oe,ue,ae,se,ce,le,fe,he,de,pe,ve,ge,me,we,be,ye,_e,ke,xe,Ce,Se,qe,Ne,We,Te,Oe,Ee,Ye,Xe,Ie,Me,ze,Ae,Pe,Fe,je,Le,Re,Be,Ve,De,He,$e,Ge,Ue,Ke,Je,Qe,Ze,tr,nr,er,rr,ir,or,ur,ar,sr,cr,lr,fr,hr,dr,pr,vr,gr,mr,wr,br,yr,_r,kr,xr,Cr,Sr,qr,Nr,Wr,Tr,Or,Er,Yr,Xr,Ir,Mr,zr,Ar,Pr,Fr,jr,Lr,Rr,Br,Vr,Dr,Hr,$r,Gr,Ur,Kr,Jr,Qr,Zr,ti,ni,ei,ri,ii,oi,ui,ai,si,ci,li,fi,hi,di,pi,vi,gi,mi,wi,bi,yi,_i,ki,xi,Ci,Si,qi,Ni,Wi,Ti,Oi,Ei,Yi,Xi,Ii,Mi,zi,Ai,Pi,Fi,ji,Li,Ri,Bi,Vi,Di,Hi,$i,Gi,Ui,Ki,Ji,Qi,Zi,to,no,eo,ro,io,oo,uo,ao,so,co,lo,fo,ho,po,vo,go,mo,wo,bo,yo,_o,ko,xo,Co,So,qo,No,Wo,To,Oo,Eo,Yo,Xo,Io,Mo,zo,Ao,Po,Fo,jo,Lo,Ro,Bo,Vo,Do,Ho,$o,Go,Uo,Ko,Jo,Qo,Zo,tu,nu,eu,ru,iu,ou,uu,au,su,cu,lu,fu,hu,du,pu,vu,gu,mu,wu,bu,yu,_u,ku,xu,Cu,Su,qu,Nu,Wu,Tu,Ou=[].slice,Eu=function(t,n){function e(){this.constructor=t}for(var r in n)Yu.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},Yu={}.hasOwnProperty;Wu=Math.PI,Tu=2*Wu,lt=Wu/2,Nu=1e-6,Q=Nu*Nu,Ht=Wu/180,B=180/Wu,Pn=Math.tan(30*Ht),_n=Math.sqrt(3),C=16581375,Rn="transparent",Tt="&middot;",An="undefined",Yn="null",Wn="Boolean",zn="String",Xn="Number",En="Function",In="Object",Nn="Array",qn="Arguments",Tn="Date",Mn="RegExp",On="Error",Su=function(t){var n;if(n=Object.prototype.toString.call(t),null===t)return Yn;if(void 0===t)return An;if(t===!0||t===!1||"[object Boolean]"===n)return Wn;switch(n){case"[object String]":return zn;case"[object Number]":return Xn;case"[object Function]":return En;case"[object Object]":return In;case"[object Array]":return Nn;case"[object Arguments]":return qn;case"[object Date]":return Tn;case"[object RegExp]":return Mn;case"[object Error]":return On;default:return n}},Wt=function(){function t(t,n){this.match=t,this.func=n}return t}(),Er=function(){var t,n;return t=function(n){var e,r,i;switch(r=Su(n)){case An:return function(t){return void 0===t};case Yn:return function(t){return null===t};case Wn:return function(t){return n===Boolean||t===n};case zn:return function(t){return n===String||t===n};case Xn:return function(t){return n===Number||t===n||_.isNaN(t)&&_.isNaN(n)};case Mn:return function(){return n===RegExp};case Error:return function(){return n===Error};case Tn:return function(t){return n===Date||t===n};case Nn:return 1===n.length&&En===(i=Su(n[0]))?(e=t(n[0]),function(t){var n,r,i;if(Nn!==Su(t))return!1;for(n=0,r=t.length;r>n;n++)if(i=t[n],!e(i))return!1;return!0}):function(t){return n===Array||be(n,t)};case En:return function(t){var e;return t instanceof n?!0:t&&t.constructor===n?!0:(e=Su(t),n===Boolean&&e===Wn||n===String&&e===zn||n===Number&&e===Xn)};case In:return function(t){var e,r;for(e in n)if(r=n[e],t[e]!==r)return!1;return!0};default:return function(){return!1}}},n=function(n){var e;return e=_.map(n,t),function(t){var n,r,i,o;if(0===t.length)return!1;if(t.length!==e.length)return!1;for(r=i=0,o=e.length;o>i;r=++i)if(n=e[r],!n(t[r]))return!1;return!0}},function(){var t,e;return t=1<=arguments.length?Ou.call(arguments,0):[],e=_.map(t,function(t){var e,r,i;return i=2<=t.length?Ou.call(t,0,r=t.length-1):(r=0,[]),e=t[r++],new Wt(n(i),e)}),function(){var t,n,r,i;for(t=1<=arguments.length?Ou.call(arguments,0):[],n=0,r=e.length;r>n;n++)if(i=e[n],i.match(t))return i.func.apply(null,t);throw new Error("Pattern match failure for args [ "+_.map(t,function(t){return""+t+":"+Su(t)}).join(", ")+" ]")}}}(),we=function(t,n){return new(t.bind.apply(t,[null].concat(n)))},m=function(){function t(t,n){this.put=t,this.test=n}return t}(),Nt=function(){function t(t,n){this.put=t,this.test=n}return t}(),gn=function(){function t(t,n){this.width=t,this.height=n}return t}(),Ut=function(){function t(t,n,e,r){this.left=t,this.top=n,this.width=e,this.height=r}return t}(),ee=function(){function t(t,n,e,r,i,o,u){this.name=t,this.label=n,this.type=e,this.at=r,this.count=i,this.domain=o,this.format=u}return t}(),tt=function(t){function n(t,e,r,i,o,u,a,s){this.valueAt=o,n.__super__.constructor.call(this,t,e,r,i,u,a,s)}return Eu(n,t),n}(ee),kt=function(t){function n(t,e,r,i,o,u){n.__super__.constructor.call(this,t,e,In,r,i,o,u)}return Eu(n,t),n}(ee),st=function(){function t(){}return t}(),ut=function(){function t(t,n,e,r,i,o,u,a,s){this.label=t,this.vectors=n,this.schema=e,this.indices=r,this.cube=i,this.at=o,this.evaluate=u,this.attach=a,this.metadata=s}return t}(),Bn=function(){function t(t){this.value=t}return t}(),Ot=function(t){function n(t){n.__super__.constructor.call(this,t)}return Eu(n,t),n}(Bn),kn=function(t){function n(t){n.__super__.constructor.call(this,t)}return Eu(n,t),n}(Bn),R=function(t){function n(t){n.__super__.constructor.call(this,t)}return Eu(n,t),n}(Bn),a=function(t){function n(t){n.__super__.constructor.call(this,t)}return Eu(n,t),n}(Bn),et=function(){function t(t){this.name=t}return t}(),xt=function(t){function n(t){this.evaluate=t}return Eu(n,t),n}(et),Jt=function(t){function n(t){this.evaluate=t}return Eu(n,t),n}(et),rt=function(){function t(t,n){this.color=t,this.opacity=n}return t}(),xn=function(){function t(t,n,e){this.color=t,this.opacity=n,this.size=e}return t}(),cn=function(){function t(t){this.fields=t}return t}(),Gt=function(){function t(t){this.index=t}return t}(),qt=function(){function t(){}return t}(),Pt=function(t){function n(t,n,e,r,i,o,u,a,s){this.position=t,this.shape=n,this.size=e,this.fillColor=r,this.fillOpacity=i,this.strokeColor=o,this.strokeOpacity=u,this.lineWidth=a,this.tooltip=s}return Eu(n,t),n}(qt),Xt=function(t){function n(t,n,e,r,i){this.position=t,this.strokeColor=n,this.strokeOpacity=e,this.lineWidth=r,this.tooltip=i}return Eu(n,t),n}(qt),tn=function(t){function n(t,n,e,r,i){this.position=t,this.strokeColor=n,this.strokeOpacity=e,this.lineWidth=r,this.tooltip=i}return Eu(n,t),n}(qt),Kt=function(t){function n(t,n,e,r,i,o,u,a,s){this.position=t,this.width=n,this.height=e,this.fillColor=r,this.fillOpacity=i,this.strokeColor=o,this.strokeOpacity=u,this.lineWidth=a,this.tooltip=s}return Eu(n,t),n}(qt),e=function(){function t(){}return t}(),bt=function(t){function n(t,n,e,r){this.position=t,this.strokeColor=n,this.strokeOpacity=e,this.lineWidth=r}return Eu(n,t),n}(e),n=function(){function t(){}return t}(),wt=function(t){function n(t,n,e,r,i){this.slope=t,this.intercept=n,this.strokeColor=e,this.strokeOpacity=r,this.lineWidth=i,this.render=su}return Eu(n,t),n}(n),St=function(){function t(){}return t}(),jt=function(t){function n(t,n,e,r,i,o,u,a,s,c,l){this.space=t,this.positionX=n,this.positionY=e,this.shape=r,this.size=i,this.fillColor=o,this.fillOpacity=u,this.strokeColor=a,this.strokeOpacity=s,this.lineWidth=c,this.tooltip=l,this.geometry=Ft}return Eu(n,t),n}(St),rn=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.space=t,this.q0=n,this.q1=e,this.q2=r,this.q3=i,this.qn=o,this.positionY=u,this.height=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f,this.geometry=en}return Eu(n,t),n}(St),an=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.space=t,this.positionX=n,this.q0=e,this.q1=r,this.q2=i,this.q3=o,this.qn=u,this.width=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f,this.geometry=un}return Eu(n,t),n}(St),y=function(t){function n(t,n,e,r,i,o,u,a,s,c,l){this.space=t,this.positionX=n,this.positionY1=e,this.positionY2=r,this.width=i,this.fillColor=o,this.fillOpacity=u,this.strokeColor=a,this.strokeOpacity=s,this.lineWidth=c,this.tooltip=l,this.geometry=b}return Eu(n,t),n}(St),u=function(t){function n(t,n,e,r,i,u,a,s,c,l,f){this.space=t,this.positionX1=n,this.positionX2=e,this.positionY=r,this.height=i,this.fillColor=u,this.fillOpacity=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f,this.geometry=o}return Eu(n,t),n}(St),Mt=function(t){function n(t,n,e,r,i,o,u){this.space=t,this.positionX=n,this.positionY=e,this.strokeColor=r,this.strokeOpacity=i,this.lineWidth=o,this.tooltip=u,this.geometry=It}return Eu(n,t),n}(St),J=function(){function t(){}return t}(),At=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.positionX=t,this.positionY=n,this.shape=e,this.size=r,this.fill=i,this.fillColor=o,this.fillOpacity=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Eu(n,t),n}(J),nn=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.q0=t,this.q1=n,this.q2=e,this.q3=r,this.qn=i,this.positionY=o,this.height=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Eu(n,t),n}(J),on=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.positionX=t,this.q0=n,this.q1=e,this.q2=r,this.q3=i,this.qn=o,this.width=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Eu(n,t),n}(J),w=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.positionX=t,this.positionY1=n,this.positionY2=e,this.width=r,this.fill=i,this.fillColor=o,this.fillOpacity=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Eu(n,t),n}(J),i=function(t){function n(t,n,e,r,i,o,u,a,s,c,l,f){this.positionX1=t,this.positionX2=n,this.positionY=e,this.height=r,this.fill=i,this.fillColor=o,this.fillOpacity=u,this.stroke=a,this.strokeColor=s,this.strokeOpacity=c,this.lineWidth=l,this.tooltip=f}return Eu(n,t),n}(J),Yt=function(t){function n(t,n,e,r,i,o,u){this.positionX=t,this.positionY=n,this.stroke=e,this.strokeColor=r,this.strokeOpacity=i,this.lineWidth=o,this.tooltip=u}return Eu(n,t),n}(J),yn=function(){function t(t,n){this.x=t,this.y=n}return t}(),bn=function(){function t(t,n,e){this.type=t,this.vectors=n,this.domain=e}return t}(),r=function(){function t(){}return t}(),f=function(t){function n(t,n,e,r,i,o,u){this.type=t,this.label=n,this.scale=e,this.domain=r,this.range=i,this.rect=o,this.guide=u}return Eu(n,t),n}(r),Bt=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}(r),_t=function(t){function n(t,n,e,r,i,o,u){this.type=t,this.label=n,this.scale=e,this.domain=r,this.range=i,this.rect=o,this.guide=u}return Eu(n,t),n}(Bt),Fn=function(){function t(t,n){this.value=t,this.label=n}return t}(),K=function(){function t(t,n){this.label=t,this.encode=n}return t}(),T=function(t){function n(t){this.value=t,n.__super__.constructor.call(this,"Constant",me(this.value))}return Eu(n,t),n}(K),Dn=function(t){function n(t,e,r){this.vector=r,n.__super__.constructor.call(this,t,e)}return Eu(n,t),n}(K),Ln=function(t){function n(t){this.vectors=t,n.__super__.constructor.call(this,"tooltips")}return Eu(n,t),n}(K),Rt=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Eu(n,t),n}(Dn),x=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Eu(n,t),n}(Dn),Et=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Eu(n,t),n}(Dn),wn=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Eu(n,t),n}(Dn),dn=function(t){function n(t,e,r,i,o,u){this.domain=i,this.range=o,this.guide=u,n.__super__.constructor.call(this,t,e,r)}return Eu(n,t),n}(Dn),g=function(){function t(){}return t}(),k=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}(g),F=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}(g),Lt=function(t){function n(t){this.coordinates=t}return Eu(n,t),n}(g),it=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}(g),ot=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}(g),Cn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}(g),Sn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}(g),mn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}(g),ue=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}(g),dt=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}(g),yt=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}(g),hn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}(g),jn=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}(g),W=function(t){function n(t){this.value=t}return Eu(n,t),n}(F),Vn=function(t){function n(t){this.field=t}return Eu(n,t),n}(F),O=function(t){function n(t){this.value=t}return Eu(n,t),n}(it),Hn=function(t){function n(t,n){this.field=t,this.range=n}return Eu(n,t),n}(it),E=function(t){function n(t){this.value=t}return Eu(n,t),n}(ot),$n=function(t){function n(t,n){this.field=t,this.range=n}return Eu(n,t),n}(ot),z=function(t){function n(t){this.value=t}return Eu(n,t),n}(Cn),Qn=function(t){function n(t,n){this.field=t,this.range=n}return Eu(n,t),n}(Cn),A=function(t){function n(t){this.value=t}return Eu(n,t),n}(Sn),Zn=function(t){function n(t,n){this.field=t,this.range=n}return Eu(n,t),n}(Sn),M=function(t){function n(t){this.value=t}return Eu(n,t),n}(mn),Jn=function(t){function n(t,n){this.field=t,this.range=n}return Eu(n,t),n}(mn),P=function(t){function n(t){this.value=t}return Eu(n,t),n}(ue),ne=function(t){function n(t,n){this.field=t,this.range=n}return Eu(n,t),n}(ue),Y=function(t){function n(t){this.value=t}return Eu(n,t),n}(dt),Gn=function(t){function n(t,n){this.field=t,this.range=n}return Eu(n,t),n}(dt),X=function(t){function n(t){this.value=t}return Eu(n,t),n}(yt),Un=function(t){function n(t,n){this.field=t,this.range=n}return Eu(n,t),n}(yt),I=function(t){function n(t){this.value=t}return Eu(n,t),n}(hn),Kn=function(t){function n(t,n){this.field=t,this.range=n}return Eu(n,t),n}(hn),te=function(t){function n(t){this.fields=t}return Eu(n,t),n}(jn),Z=function(){function t(t,n){this.min=t,this.max=n}return t}(),G=function(){function t(t,n){this.min=t,this.max=n}return t}(),U=function(){function t(t,n){this.min=t,this.max=n}return t}(),$t=function(){function t(){}return t}(),h=function(t){function n(t){this.values=t}return Eu(n,t),n}($t),Vt=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}($t),fn=function(t){function n(t,n){this.min=t,this.max=n}return Eu(n,t),n}(Vt),H=function(t){function n(t,n,e){this.min=t,this.mid=n,this.max=e}return Eu(n,t),n}(Vt),q=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Eu(n,t),n}($t),ln=function(t){function n(t,n){this.min=t,this.max=n}return Eu(n,t),n}(q),D=function(t){function n(t,n,e){this.min=t,this.mid=n,this.max=e}return Eu(n,t),n}(q),at=function(){function t(t,n,e,r,i){this.encode=t,this.mask=n,this.highlight=e,this.render=r,this.select=i}return t}(),L=function(){function t(t){this.read=t}return t}(),l=function(){function t(t,n,e,r){this.element=t,this.context=n,this.bounds=e,this.ratio=r}return t}(),re=function(){function t(t,n,e,r,i,o,u,a,s,c,l){this.box=t,this.container=n,this.baseCanvas=e,this.highlightCanvas=r,this.hoverCanvas=i,this.maskCanvas=o,this.clipCanvas=u,this.marquee=a,this.tooltip=s,this.mask=c,this.clip=l}return t}(),vt=function(){function t(t,n,e,r,i,o){this.encodings=t,this.encoders=n,this.mask=e,this.highlight=r,this.render=i,this.select=o}return t}(),ie=function(){function t(t,n,e,r,i,o,u,a){this.viewport=t,this.frame=n,this.test=e,this.highlight=r,this.hover=i,this.selectAt=o,this.selectWithin=u,this.render=a}return t}(),zt=function(){function t(t,n,e){this.element=t,this.subscribe=n,this.unsubscribe=e}return t}(),s=function(){function t(t,n){this.width=t,this.height=n}return t}(),Qt=function(){function t(t,n,e,r,i){this.center=t,this.left=n,this.top=e,this.right=r,this.bottom=i}return t}(),Ct=function(){function t(t,n,e,r){this.left=t,this.top=n,this.right=e,this.bottom=r}return t}(),c=function(){function t(t,n,e){var r;this.width=t,this.height=n,this.margin=e,this.regions=new Qt(r=new Ut(e.left,e.top,t-e.left-e.right,n-e.top-e.bottom),new Ut(0,e.top,e.left,r.height),new Ut(e.left+r.width,e.top,e.right,r.height),new Ut(e.left,0,r.width,e.top),new Ut(e.left,e.top+r.height,r.width,e.bottom))}return t}(),Dt=function(){function t(t,n,e,r){this.where=t,this.limit=n,this.group=e,this.having=r}return t}(),d=function(){function t(t,n){this.key=t,this.value=n}return t}(),t=new d(0,"All"),j=function(){function t(t,n,e,r){this.frame=t,this.hierarchy=n,this.cells=e,this.dimension=r}return t}(),gt=function(){function t(t,n,e){this.category=t,this.indices=n,this.children=e}return t}(),p=function(){function t(t,n){this.levels=t,this.indices=n}return t}(),nt=function(){function t(t,n,e,r,i){this.at=t,this.valueAt=n,this.count=e,this.domain=r,this.format=i}return t}(),ct=function(){function t(t){this.fields=t}return t}(),oe=function(){function t(t,n){this.fields=t,this.predicate=n}return t}(),mt=function(){function t(t,n){this.offset=t,this.length=n}return t}(),ft=function(){function t(t,n){this.fields=t,this.predicate=n}return t}(),pt=function(){function t(t,n){this.vectors=t,this.index=n}return t}(),sn=function(){function t(t,n){this.vectors=t,this.indices=n}return t}(),V=function(){function t(t){this.vectors=t}return t}(),N=function(){function t(t){this.vector=t}return t}(),ht=function(){function t(t){this.vector=t}return t}(),Zt=function(){function t(t){this.index=t}return t}(),v=function(){function t(t,n){this.vector=t,this.index=n}return t}(),ke=function(t){var n;return n=parseFloat(t),_.isNaN(n)?void 0:n},_e=function(t){var n;return n=parseInt(t,10),_.isNaN(n)?void 0:n},ye=function(t){return null!=t?t:void 0},xu=function(t){return t*t},Ne=function(t,n){return function(e){return t>e?t:e>n?n:e}},qe=Ne(0,1),Or=8,Le=function(t){return t.slice(0)},Ci=function(t,n){var e,r,i,o,u,a,s,c;for(c=[],e=0,r=t.length;r>e;e++)for(a=t[e],u=n(a),o=0,i=u.length;i>o;o++)s=u[o],c.push(s);return c},Hi=function(){var t,n;return n=arguments[0],t=2<=arguments.length?Ou.call(arguments,1):[],function(){return n.apply(null,t)}},me=function(t){return function(){return t}},be=function(t,n){var e,r,i,o;if(t&&n&&t.length===n.length){for(e=r=0,i=t.length;i>r;e=++r)if(o=t[e],o!==n[e])return!1;return!0}return!1},bi=function(){var t,n,e,r,i,o,u,a,s;for(n=arguments[0],s=2<=arguments.length?Ou.call(arguments,1):[],e=[],r=0,i=n.length;i>r;r++)for(t=n[r],u=0,o=s.length;o>u;u++)a=s[u],t instanceof a&&e.push(t);return e},ki=function(){var t,n,e,r,i,o,u,a;for(n=arguments[0],a=2<=arguments.length?Ou.call(arguments,1):[],e=0,r=n.length;r>e;e++)for(t=n[e],o=0,i=a.length;i>o;o++)if(u=a[o],t instanceof u)return t},xi=function(t,n){var e,r,i,o;for(i=[],e=0,r=n.length;r>e;e++)o=n[e],i.push(ki(t,o));return i},rr=function(t,n){return n>t?new Z(t,n):new Z(n,t)},ze=function(t){var n,e,r,i,o;for(i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=0,e=t.length;e>n;n++)o=t[n],void 0!==o&&(i>=o&&(i=o),o>=r&&(r=o));return new Z(i,r)},Ae=function(t,n){var e,r,i,o,u,a;for(o=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,e=r=0,u=t;u>=0?u>r:r>u;e=u>=0?++r:--r)void 0!==(a=n(e))&&(o>=a&&(o=a),a>=i&&(i=a));return new Z(o,i)},je=function(t){return function(n){return n.min>=t&&n.max>t?1:n.min<t&&n.max<=t?-1:0}},Fe=je(0),Xe=function(t,n){return new Z(Math.min(t.min,n.min),Math.max(t.max,n.max))},Xi=function(t){return function(n){return n.min>t&&n.max>t?new Z(t,n.max):n.min<t&&n.max<t?new Z(n.min,t):n}},Yi=Xi(0),jr=function(t,n,e){return $.ajax({dataType:t,url:n,success:function(t,n,r){return e(null,t)},error:function(t,n,r){return e(r)}})},fr=function(t,n,e){var r,i,o;return i=function(){return n.length},r=function(t){return n[t]},o=e?function(t){return e(n[t],t)}:r,new kt(t,t,r,i,n,o)},Nr=function(t,n,e,r){return le(t,t,n,e,r)},le=function(t,n,e,r,i){var o,u,a,s;return a=ze(r),u=function(){return r.length},o=function(t){return r[t]},s=i?function(t){return i(r[t],t)}:o,new ee(t,n,e,o,u,a,s)},sr=function(t,n,e,r,i,o){var u,a;return u=Ae(r,i),a=o?function(t){return o(i(t),t)}:i,new ee(t,n,e,i,r,u,a)},wi=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,p,v,g,m,w;for(o=0,i={},v=n(),s=new Array(v),c=function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)m=e[t],r.push(i[m]=new d(o++,m));return r}(),h=p=0,g=v;g>=0?g>p:p>g;h=g>=0?++p:--p)l=t(h),m=void 0!==l?l:"?",(a=i[m])||c.push(i[m]=a=new d(o++,m)),s[h]=a;return u=function(t){return s[t]},w=function(t){return s[t].value},f=r?function(t){return r(s[t].value)}:function(t){return void 0!==(m=s[t].value)?_.escape(m):m},new nt(u,w,n,c,f)},ir=function(t,n,e,r,i){var o,u,a;return u=function(){return e.length},o=function(t){return e[t]},a=wi(o,u,r||[],i),new tt(t,t,n,a.at,a.valueAt,u,a.domain,a.format)},Be=function(t,n){var e,r,i,o,u,a;return i="All",r=new d(0,i),a=function(t){return i},e=function(){return r},o=function(){return n},u=function(){return i},new tt(t,t,zn,e,a,o,[r],u)},ar=function(t,n,e,r,i){var o,u;return u=_.indexBy(n,function(t){return t.name}),o=new ut(t,n,u,e,r,null,null,null,i||{}),o.evaluate=function(n){var e,i,a,s;return i=_.isArray(n)?n:[n],a=function(){var a,c,l;for(l=[],a=0,c=i.length;c>a;a++)if(e=i[a],e instanceof xt)l.push(o.evaluate(e.evaluate(o)));else if(e instanceof Jt){if(!r)throw new Error("Cannot compute aggregate ["+e.name+"] on an unaggregated frame.");l.push(o.evaluate(e.evaluate(o,r)))}else{if(!(e instanceof et))throw new Error("Cannot evaluate ["+n+"] on frame ["+t+"].");if(!(s=u[e.name]))throw new Error("Vector ["+e.name+"] does not exist in frame ["+t+"].");l.push(s)}return l}(),_.flatten(a)},o.attach=function(e){if(u[e.name])throw new Error("Cannot attach vector ["+e.name+"]: a vector by that name already exists in frame ["+t+"]");return n.push(e),u[e.name]=e,e},o.exists=function(t){return u[t]?!0:!1},o},Ur=function(t){var n,e,r,i,o,u,a,s,c,l,f;for(f=new Array(t.indices.length),e=_.map(t.vectors,function(t){return t instanceof tt?t.valueAt:t.at}),c=t.indices,i=0,o=c.length;o>i;i++)for(r=c[i],f[r]=l=new Array(t.vectors.length),s=a=0,u=e.length;u>a;s=++a)n=e[s],l[s]=n(r);return f},wr=function(t){return new Dt(bi(t,oe),bi(t,mt),bi(t,ct),bi(t,ft))},ur=function(t){return _.map(t,function(t){return new et(t)})},or=function(t){return new xt(function(n){var e,r,i,o,u,a,s,c,l;if(l=_.head(n.evaluate(t)),l instanceof tt)return t;for(a=l.count(),e=l.at,i=new Array(a),o=u=0,s=a;s>=0?s>u:u>s;o=s>=0?++u:--u)void 0!==(c=e(o))&&(i[o]=""+c);return n.attach(r=ir("factor("+l.label+")",zn,i)),[new et(r.name)]})},Ve=function(t){return new xt(function(n){return n.attach(Be(t,n.indices.length)),[new et(t)]})},ao=Er([String,function(t){return ao(new et(t))}],[et,function(t){return or(t)}],[kn,function(t){var n;return n=t.value,Ve(n)}]),Cr=function(t,n){return new xt(function(e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,k,x,C,S,q,N,W;if(W=_.head(e.evaluate(t)),W instanceof tt)throw new Error("Cannot stack factor ["+W.label+"]: expecting vector.");for(g=W.count(),y=new Array(g),l=new Array(g),b="low("+W.name+", "+n+")",c="high("+W.name+", "+n+")",i=W.at,u=e.cube,n=Math.min(n,u.dimension),o=u.cells,w=s=0,r=new Array(n),C=e.indices,p=0,v=C.length;v>p;p++){for(f=C[p],m=o[f].levels,h=k=0,S=n;S>=0?S>k:k>S;h=S>=0?++k:--k)if(r[h]!==m[h].category){for(w=s=0,d=x=0,q=n;q>=0?q>x:x>q;d=q>=0?++x:--x)r[d]=m[d].category;break}N=i(f),0>N?(y[f]=w,l[f]=w+=N):(y[f]=s,l[f]=s+=N)}return a=function(t,n){return W.format(n)},e.attach(le(b,W.name,W.type,y,a)),e.attach(le(c,W.name,W.type,l,a)),[new et(b),new et(c)]})},Fo=Er([String,Number,function(t,n){return Fo(new et(t),n)}],[et,Number,function(t,n){return Cr(t,n)}]),Go=function(t){var n;return n=Ne(0,t.length-1),function(e){return t[n(-1+Math.round(e*t.length))]}},Pe=function(t){var n,e,r,i,o,u,a,s;return s=function(){var n,e,r;for(r=[],n=0,e=t.length;e>n;n++)a=t[n],(a||0===a)&&r.push(a);return r}(),s.sort(function(t,n){return t-n}),e=s[0],n=s[s.length-1],u=Go(s),r=u(.25),i=u(.5),o=u(.75),[e,r,i,o,n]},he=function(t){var n,e,r,i,o;for(i=0,n=0,e=0,r=t.length;r>e;e++)o=t[e],void 0!==o&&(i+=o,n++);return i/n},de=function(t){var n,e,r,i;for(n=0,e=0,r=t.length;r>e;e++)i=t[e],void 0!==i&&n++;return n},pe=function(t){var n,e,r,i;for(r=Number.NEGATIVE_INFINITY,n=0,e=t.length;e>n;n++)i=t[n],void 0!==i&&i>=r&&(r=i);return r},ve=function(t){var n,e,r,i;for(r=Number.POSITIVE_INFINITY,n=0,e=t.length;e>n;n++)i=t[n],void 0!==i&&r>=i&&(r=i);return r},ge=function(t){var n,e,r,i;for(r=0,n=0,e=t.length;e>n;n++)i=t[n],void 0!==i&&(r+=i);return r},Re=function(t,n,e,r,i){return new Jt(function(o,u){var a,s,c,l,f,h,d,p,v,g,m,w,b,y,k,x;if(m=n+"("+t.name+")",o.exists(m))return new et(m);for(x=_.head(u.frame.evaluate(t)),a=x.at,l=new Array(u.cells.length),w=u.cells,h=d=0,p=w.length;p>d;h=++d){for(s=w[h],k=[],b=s.indices,g=0,v=b.length;v>g;g++)f=b[g],void 0!==(y=a(f))&&k.push(y);l[h]=i(k)}return o.attach(c=Nr(m,e,l,r)),[new et(c.name)]})},Qi=function(t,n,e,r){return Er([String,function(i){return Re(new et(i),t,n,e,r)}],[et,function(i){return Re(i,t,n,e,r)}])},eo=Qi("count",Xn,_.identity,de),Zi=Qi("avg",Xn,_.identity,he),Co=Qi("max",Xn,_.identity,pe),So=Qi("min",Xn,_.identity,ve),Ro=Qi("sum",Xn,_.identity,ge),ho=function(){var t,n,e;return n=1<=arguments.length?Ou.call(arguments,0):[],e=function(){var e,r,i;for(i=[],e=0,r=n.length;r>e;e++)if(t=n[e],t instanceof et)i.push(t);else{if(!_.isString(t))throw new Error("Cannot group by ["+t+"]");i.push(new et(t))}return i}(),new ct(e)},Ji=Er([[String],Function,function(t,n){return new oe(ur(t),n)}]),Do=function(){var t,n,e;return e=2<=arguments.length?Ou.call(arguments,0,n=arguments.length-1):(n=0,[]),t=arguments[n++],Ji(e,t)},yo=Er([Number,Number,function(t,n){return new mt(t,n)}],[Number,function(t){return new mt(0,t)}]),Ki=Er([[String],Function,function(t,n){return new ft(ur(t),n)}],[[et],Function,function(t,n){return new ft(t,n)}]),vo=function(){var t,n,e;return e=2<=arguments.length?Ou.call(arguments,0,n=arguments.length-1):(n=0,[]),t=arguments[n++],Ki(e,t)},uo=function(t){return function(n){return n===t}},qo=function(t){return function(n){return n!==t}},xo=function(t){return function(n){return t>n}},po=function(t){return function(n){return n>t}},wo=function(t){return function(n){return t>=n}},fo=function(t){return function(n){return n>=t}},bo=function(t){if(Mn!==Su(t))throw new Error("like ["+t+"]: expecting RegExp");return function(n){return t.test(n)}},mo=function(t){return function(n){var e,r,i;for(r=0,i=t.length;i>r;r++)if(e=t[r],e===n)return!0;return!1}},No=function(t){return function(n){var e,r,i;for(r=0,i=t.length;i>r;r++)if(e=t[r],e===n)return!1;return!0}},Uo=function(n,e){var r,i,o,u,a,s,c,l,f,h,d;return c=e.where.length?ar(n.label,n.vectors,_i(n,e.where)):n,h=e.group.length?(s=Ci(e.group,function(t){return t.fields}),u=function(){var t,n,e;for(e=[],t=0,n=s.length;n>t;t++){if(a=s[t],d=_.head(c.evaluate(a)),!(d instanceof tt))throw new Error("Cannot group by ["+a.name+"]: not a Factor.");e.push(d)}return e}(),l={0:new gt(t,c.indices,{})},xe(l,u,0),i=[],Oe(l[0].children,s.length-1,i,0,new Array(s.length)),o=new j(c,l,i,s.length),r=fe(c.label+"'",o,u),e.having.length?ar(r.label,r.vectors,_i(r,e.having),r.cube):r):c,e.limit.length?(f=e.limit[e.limit.length-1],ar(h.label,h.vectors,h.indices.slice(f.offset,f.offset+f.length))):h},_i=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p,v,g,m;for(e=t.indices,l=0,f=n.length;f>l;l++){for(g=n[l],s=[],m=function(){var n,e,r,i;for(r=g.fields,i=[],e=0,n=r.length;n>e;e++)u=r[e],i.push(_.head(t.evaluate(u)));return i}(),o=_.map(m,function(t){return t instanceof tt?t.valueAt:t.at}),p=0,h=e.length;h>p;p++){for(a=e[p],r=new Array(m.length),c=v=0,d=o.length;d>v;c=++v)i=o[c],r[c]=i(a);g.predicate.apply(null,r)&&s.push(a)}e=s}return e},fe=function(t,n,e){var r,i,o;return r=_.range(n.cells.length),o=function(){var t,r,o;for(o=[],i=t=0,r=n.dimension;r>=0?r>t:t>r;i=r>=0?++t:--t)o.push(mi(n,e[i],i));return o}(),ar(t,o,r,n)},xe=function(t,n,e){var r,i,o,u,a,s,c,l,f,h;r=n[e].at;for(s in t){for(f=t[s],u=f.children,h=f.indices,c=0,l=h.length;l>c;c++)a=h[c],i=r(a),(o=u[i.key])||(u[i.key]=o=new gt(i,[],{})),o.indices.push(a);e<n.length-1&&xe(u,n,e+1)}},Oe=function(t,n,e,r,i){var o,u;for(o in t)u=t[o],i[r]=u,r===n?e.push(new p(Le(i),u.indices)):Oe(u.children,n,e,r+1,i)},mi=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v;for(a=new Array(t.cells.length),s={},c=[],p=t.cells,f=h=0,d=p.length;d>h;f=++h)o=p[f],a[f]=i=o.levels[e].category,s[i.value]||(s[i.value]=i,c.push(i));return r=function(t){return a[t]},v=function(t){return a[t].value},l=function(t){return a[t].value},u=function(){return a.length},new tt(n.label,n.label,n.type,r,v,u,c,l)},S={c10:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],c20:["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],c20b:["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],c20c:["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"]},$i=function(t){return t>10?S.c20:S.c10},Te=function(t){var n,e,r,i;return i=t.rgb(),r=i[0],e=i[1],n=i[2],chroma.rgb(r,e,n)},Ye=function(t,n){return n>=0&&1>n?Te(t).alpha(n).css():t.css()},Lr=function(t,n,e,r){var i;return i=Math.sqrt(r/Wu),t.beginPath(),t.arc(n,e,i,0,Tu,!1),t.closePath()},Vr=function(t,n,e,r){var i;return i=.5*Math.sqrt(r),t.save(),t.translate(n,e),t.beginPath(),t.moveTo(i,i),t.lineTo(-i,i),t.lineTo(-i,-i),t.lineTo(i,-i),t.closePath(),t.restore()},Rr=function(t,n,e,r){var i,o;return i=.5*Math.sqrt(r/5),o=3*i,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(o,i),t.lineTo(i,i),t.lineTo(i,o),t.lineTo(-i,o),t.lineTo(-i,i),t.lineTo(-o,i),t.lineTo(-o,-i),t.lineTo(-i,-i),t.lineTo(-i,-o),t.lineTo(i,-o),t.lineTo(i,-i),t.lineTo(o,-i),t.closePath(),t.restore()},Br=function(t,n,e,r){var i,o;return o=Math.sqrt(r/(2*Pn)),i=o*Pn,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(i,0),t.lineTo(0,o),t.lineTo(-i,0),t.lineTo(0,-o),t.closePath(),t.restore()},Gr=function(t,n,e,r){var i,o;return i=Math.sqrt(r/_n),o=i*_n/2,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(0,-o),t.lineTo(i,o),t.lineTo(-i,o),t.closePath(),t.restore()},Dr=function(t,n,e,r){var i,o;return i=Math.sqrt(r/_n),o=i*_n/2,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(0,o),t.lineTo(i,-o),t.lineTo(-i,-o),t.closePath(),t.restore()},$r=function(t,n,e,r){var i,o;return o=Math.sqrt(r/_n),i=o*_n/2,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(i,0),t.lineTo(-i,o),t.lineTo(-i,-o),t.closePath(),t.restore()},Hr=function(t,n,e,r){var i,o;return o=Math.sqrt(r/_n),i=o*_n/2,t.save(),t.translate(n,e),t.beginPath(),t.moveTo(-i,0),t.lineTo(i,-o),t.lineTo(i,o),t.closePath(),t.restore()},vn={circle:Lr,square:Vr,cross:Rr,diamond:Br,triangleUp:Gr,triangleDown:Dr,triangleLeft:Hr,triangleRight:$r},pn={c8:["circle","square","cross","diamond","triangleUp","triangleDown","triangleLeft","triangleRight"]},Gi=function(){return pn.c8},mu=function(t){return function(n){return void 0!==n?t(n):void 0}},pr=function(t,n){var e;return e=d3.scale.linear().domain([t.min,t.max]).range([n.min,n.max]).nice(),[mu(e),e.tickFormat,e.ticks]},vr=function(t,n){var e,r,i,o,u,a,s;for(r=0,e={},o=0,u=t.length;u>o;o++)i=t[o],e[i.key]=r++;return a=(n.max-n.min)/t.length/2,
s=n.min,mu(function(t){return s+2*e[t.key]*a+a})},Ue=function(t,n){var e,r;return r=n.values,e=r.length,mu(function(t){return r[t.key%e]})},kr=function(t,n){return mu(d3.scale.linear().domain([t.min,t.max]).range([n.min,n.max]))},tr=function(t,n){return mu(d3.scale.linear().domain([t.min,t.mid,t.max]).range([n.min,n.mid,n.max]))},_r=function(t,n){return mu(chroma.scale([n.min,n.max]).domain([t.min,t.max]).mode("lch"))},Ze=function(t,n){var e,r;return e=chroma.scale([n.min,n.mid]).domain([t.min,t.mid]).mode("lch"),r=chroma.scale([n.mid,n.max]).domain([t.mid,t.max]).mode("lch"),function(n){return void 0!==n?n<t.mid?e(n):r(n):void 0}},Je=Er([fn,q,_r],[H,q,Ze]),lr=Er([fn,fn,kr],[H,H,tr]),Ce=function(t){var n;return n=t.toString(16),1===n.length?"0"+n:n},Ke=function(t){var n,e,r,i;return n=t.context,r=t.ratio,e=function(){return"#fff"},i=function(t,e){var i,o,u,a,s;return s=n.getImageData(t*r,e*r,1,1).data,a=s[0],u=s[1],o=s[2],i=s[3],255===a&&255===u&&255===o&&255===i},new m(e,i)},dr=function(t){var n,e,r,i,o,u;return e=t.context,o=t.ratio,n=0,r={},i=function(t){var e,i,o,u;return i=n++,n>=C&&(n=0),r[i]=t,u=i>>16&255,o=i>>8&255,e=255&i,"#"+Ce(u)+Ce(o)+Ce(e)},u=function(t,n){var i,u,a,s,c,l;return l=e.getImageData(t*o,n*o,1,1).data,c=l[0],s=l[1],u=l[2],i=l[3],255===i?(a=(c<<16)+(s<<8)+u,r[a]):void 0},new Nt(i,u)},ai=function(t,n){var e,r,i,o,u,a,s;return s=t.scale,r=t.domain,a=t.range,o=t.guide,u=n.label,e=n.at,i=function(t){return s(e(t))},new Rt(u,i,n,r,a,o)},ti=function(t,n){return new T(t.scale(n))},Zr=function(t,n){var e,r,i,o,u,a,s;return n instanceof Hn||n instanceof Qn?(s=_.head(t.evaluate(n.field)),s instanceof tt?(n.range||(n.range=new h($i(s.domain.length))),u=Ue(s.domain,n.range),e=s.at,i=function(t){return chroma(u(e(t)))},new x(s.label,i,s,s.domain,n.range,null)):(r=function(){switch(Fe(s.domain)){case 1:return new fn(s.domain.min,s.domain.max);case-1:return new fn(s.domain.min,s.domain.max);default:return new H(s.domain.min,0,s.domain.max)}}(),a=Fe(r),o=n.range?n.range instanceof D?r instanceof fn?1===a?new ln(n.range.mid,n.range.max):new ln(n.range.min,n.range.mid):n.range:(r instanceof H?r=new fn(r.min,r.max):void 0,n.range):r instanceof fn?1===a?new ln("#deebf7","#3182bd"):new ln("#e6550d","#fee6ce"):new D("#fc8d59","#ffffbf"),u=Je(r,o),e=s.at,i=function(t){return u(e(t))},new x(s.label,i,s,r,o,null))):new T(n.value)},ii=function(t,n){var e,r,i,o,u,a;if(n instanceof $n||n instanceof Zn){if(a=_.head(t.evaluate(n.field)),a instanceof tt)throw new Error("Could not encode opacity. Vector ["+a.label+"] is a Factor.");return r=new fn(a.domain.min,a.domain.max),o=n.range?new fn(qe(n.range.min),qe(n.range.max)):n.range=new fn(.05,1),u=lr(r,o),e=a.at,i=function(t){return u(e(t))},new Et(a.label,i,a,r,o,null)}return new T(qe(n.value))},di=function(t,n){var e,r;return t&&n?(e=t.encode,r=n.encode,new Dn("("+t.label+", "+n.label+")",function(t){return Ye(e(t),r(t))})):void 0},gi=function(t,n){return function(e,r,i){var o,u,a,s,c,l;if(r instanceof t){if(l=_.head(e.evaluate(r.field)),l instanceof tt)throw new Error("Could not encode size. Vector ["+l.label+"] is a Factor.");return u=new fn(l.domain.min,l.domain.max),s=r.range?new fn(qe(r.range.min),qe(r.range.max)):r.range=new fn(.05,1),c=lr(u,s),o=l.at,a=function(t){return i*c(o(t))},new n(l.label,a,u,s,null)}return new T(i*qe(r.value))}},fi=gi(Jn,wn),vi=gi(ne,wn),ei=gi(Gn,wn),Kr=function(t,n){var e,r,i,o,u,a;if(n instanceof Jn){if(a=_.head(t.evaluate(n.field)),a instanceof tt)throw new Error("Could not encode size. Vector ["+a.label+"] is a Factor.");return r=new fn(a.domain.min,a.domain.max),o=n.range?new fn(xu(n.range.min),xu(n.range.max)):n.range=new fn(xu(Or),xu(30)),u=lr(r,o),e=a.at,i=function(t){return u(e(t))},new wn(a.label,i,a,r,o,null)}return new T(xu(n.value))},ri=function(t,n){var e,r,i,o,u,a;if(n instanceof Un){if(a=_.head(t.evaluate(n.field)),a instanceof tt)throw new Error("Could not encode lineWidth. Vector ["+a.label+"] is a Factor.");return r=new fn(a.domain.min,a.domain.max),o=n.range?new fn(n.range.min,n.range.max):n.range=new fn(1.5,15),u=lr(r,o),e=a.at,i=function(t){return u(e(t))},new wn(a.label,i,a,r,o,null)}return new T(n.value)},li=function(t,n){var e,r,i,o;if(n instanceof Kn){if(o=_.head(t.evaluate(n.field)),!(o instanceof tt))throw new Error("Could not encode shape. Vector ["+o.label+"] is not a Factor.");return n.range||(n.range=new h(Gi(o.domain.length))),i=Ue(o.domain,n.range),e=o.at,r=function(t){return vn[i(e(t))]},new dn(o.label,r,o,o.domain,n.range,null)}return new T(vn[n.value]||vn.circle)},pi=function(t,n){var e,r;return n?(r=function(){var r,i,o,u;for(o=n.fields,u=[],r=0,i=o.length;i>r;r++)e=o[r],u.push(_.head(t.evaluate(e)));return u}(),new Ln(r)):void 0},Ii=function(t,n){return[null!=t?t:new O(chroma(_.head(S.c10))),null!=n?n:new E(1)]},zi=function(t,n,e){return[null!=t?t:new z(chroma(_.head(S.c10))),null!=n?n:new A(1),null!=e?e:new X(1.5)]},Mi=function(t,n,e,r,i,o,u){var a,s,c,l;return a=t||n,s=e||r||i,a||s||(o&&(a=!0),u&&(s=!0)),a&&(c=Ii(t,n),t=c[0],n=c[1]),s&&(l=zi(e,r,i),e=l[0],r=l[1],i=l[2]),[t,n,e,r,i]},ni=function(t,n){var e,r;return n.fillColor||n.fillOpacity?[e=Zr(t,n.fillColor),r=ii(t,n.fillOpacity),di(e,r)]:[]},hi=function(t,n){var e,r;return n.strokeColor||n.strokeOpacity||n.lineWidth?[e=Zr(t,n.strokeColor),r=ii(t,n.strokeOpacity),di(e,r),ri(t,n.lineWidth)]:[]},We=function(t,n,e,r,i){return t.beginPath(),t.rect(n,e,r,i),t.clip()},Fr=function(t,n,e){return t.lineWidth=e,t.strokeStyle=n,t.stroke()},Xr=function(t,n){return t.fillStyle=n,t.fill()},Ir=function(t,n,e,r,i){return t.beginPath(),t.moveTo(n,e),t.lineTo(r,i),t.stroke()},zr=function(t,n,e,r,i){return t.beginPath(),r>e?t.rect(n-i/2,e,i,r-e):t.rect(n-i/2,r,i,e-r),t.closePath()},Mr=function(t,n,e,r,i){return t.beginPath(),e>n?t.rect(n,r-i/2,e-n,i):t.rect(e,r-i/2,n-e,i),t.closePath()},Ar=function(t,n,e,r,i,o,u,a,s,c){var l,f;return void 0!==n&&void 0!==e&&void 0!==r&&void 0!==i&&void 0!==o&&void 0!==u&&void 0!==a&&void 0!==s&&void 0!==c?(t.strokeStyle=s,t.lineWidth=c,Mr(t,e,i,u,a),t.stroke(),l=a/2,f=a/4,Ir(t,r,u-l,r,u+l),Ir(t,e,u,n,u),Ir(t,i,u,o,u),Ir(t,n,u-f,n,u+f),Ir(t,o,u-f,o,u+f)):void 0},Pr=function(t,n,e,r,i,o,u,a,s,c){var l,f;return void 0!==n&&void 0!==e&&void 0!==r&&void 0!==i&&void 0!==o&&void 0!==u&&void 0!==a&&void 0!==s&&void 0!==c?(t.strokeStyle=s,t.lineWidth=c,zr(t,n,r,o,a),t.stroke(),l=a/2,f=a/4,Ir(t,n-l,i,n+l,i),Ir(t,n,r,n,e),Ir(t,n,o,n,u),Ir(t,n-f,e,n+f,e),Ir(t,n-f,u,n+f,u)):void 0},su=function(t,n,e,r){var i,o,u,a,s,c,l,f,h;u=t.slope,i=t.intercept,a=t.strokeColor,s=t.strokeOpacity,o=t.lineWidth,void 0!==i?0===u?e instanceof Bt&&(c=n.range.min,l=n.range.max,f=h=e.scale(i)):n instanceof Bt&&e instanceof Bt&&(c=n.scale(n.domain.min),l=n.scale(n.domain.max),f=e.scale(u*n.domain.min+i),h=e.scale(u*e.domain.max+i)):n instanceof Bt&&(c=l=n.scale(u),f=e.range.min,h=e.range.max),void 0!==c&&void 0!==f&&void 0!==l&&void 0!==h&&(r.save(),r.strokeStyle=Ye(a,s),r.lineWidth=o,Ir(r,c,f,l,h),r.restore())},cr=function(t){var n,e,r,i,o,u;return r=t.position.coordinates,i=r[0],n=r[1],o=t.strokeColor,u=t.strokeOpacity,e=t.lineWidth,new wt(i?i.value:0,n?n.value:void 0,o?o.value:chroma("red"),u?u.value:1,e?e.value:1.5)},mr=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p;return o=n[0],u=n[1],h=new yn([o],[u]),l=null!=(a=t.shape)?a:new I("circle"),f=null!=(s=t.size)?s:new M(Or),c=Mi(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!1,!0),e=c[0],r=c[1],d=c[2],p=c[3],i=c[4],new jt(h,o,u,l,f,e,r,d,p,i,t.tooltip)},ui=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m;return s=ai(e,n.positionX),c=ai(r,n.positionY),h=li(t,n.shape),d=Kr(t,n.size),l=ni(t,n),o=l[0],u=l[1],i=l[2],f=hi(t,n),v=f[0],g=f[1],p=f[2],a=f[3],m=pi(t,n.tooltip),new At(s,c,h,d,i,o,u,p,v,g,a,m)},Ti=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(l=n.positionX,f=n.positionY,h=n.shape,d=n.size,r=n.fill,p=n.stroke,s=n.lineWidth,e.save(),o=0,u=t.length;u>o;o++)i=t[o],v=l(i),g=f(i),void 0!==v&&void 0!==g&&(h(i)(e,v,g,d(i)),e.lineWidth=2+(p?s(i):1),e.stroke());for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.fillStyle=e.strokeStyle="black",c=0,a=t.length;a>c;c++)i=t[c],v=l(i),g=f(i),void 0!==v&&void 0!==g&&(h(i)(e,v,g,d(i)),p&&(e.lineWidth=s(i),e.stroke()),r&&e.fill());return e.restore()},Bi=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v;for(c=n.positionX,l=n.positionY,f=n.shape,h=n.size,d=n.stroke,a=n.lineWidth,e.save(),o=0,u=t.length;u>o;o++)i=t[o],p=c(i),v=l(i),void 0!==p&&void 0!==v&&(s=r.put(i),f(i)(e,p,v,h(i)),e.fillStyle=s,e.fill(),d&&(e.lineWidth=a(i),e.strokeStyle=s,e.stroke()));return e.restore()},fu=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p;for(s=n.positionX,c=n.positionY,l=n.shape,f=n.size,r=n.fill,h=n.stroke,a=n.lineWidth,e.save(),o=0,u=t.length;u>o;o++)i=t[o],d=s(i),p=c(i),void 0!==d&&void 0!==p&&(l(i)(e,d,p,f(i)),h&&(e.lineWidth=a(i),e.strokeStyle=h(i),e.stroke()),r&&(e.fillStyle=r(i),e.fill()));return e.restore()},yu=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d;for(c=n.positionX,l=n.positionY,f=[],a=0,s=t.length;s>a;a++)u=t[a],h=c(u),d=l(u),void 0!==h&&void 0!==d&&h>=e&&i>=h&&d>=r&&o>=d&&f.push(u);return f},Cu=function(t){return _.map(t,function(t){return t.type}).join(", ")},br=function(t,n){var e,r,i,o,a,s,c,l,f,h,d,p,v,g,m,w,b,_,k,x,C,S,q;switch(S=Cu(n)){case"String, Number":return a=n[0],h=n[1],k=new yn([a],[h]),q=null!=(d=t.width)?d:new P(.8),p=Mi(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!0,!1),e=p[0],r=p[1],x=p[2],C=p[3],o=p[4],new y(k,a,void 0,h,q,e,r,x,C,o,t.tooltip);case"String, Number, Number":return a=n[0],f=n[1],h=n[2],k=new yn([a],[f,h]),q=null!=(v=t.width)?v:new P(.8),g=Mi(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!0,!1),e=g[0],r=g[1],x=g[2],C=g[3],o=g[4],new y(k,a,f,h,q,e,r,x,C,o,t.tooltip);case"Number, String":return c=n[0],l=n[1],k=new yn([c],[l]),i=null!=(m=t.height)?m:new Y(.8),w=Mi(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!0,!1),e=w[0],r=w[1],x=w[2],C=w[3],o=w[4],new u(k,void 0,c,l,i,e,r,x,C,o,t.tooltip);case"Number, Number, String":return s=n[0],c=n[1],l=n[2],k=new yn([s,c],[l]),i=null!=(b=t.height)?b:new Y(.8),_=Mi(t.fillColor,t.fillOpacity,t.strokeColor,t.strokeOpacity,t.lineWidth,!0,!1),e=_[0],r=_[1],x=_[2],C=_[3],o=_[4],new u(k,s,c,l,i,e,r,x,C,o,t.tooltip);default:throw new Error("Cannot create rect marks with vectors of type ["+S+"]")}},Qr=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m;return s=ai(e,n.positionX),c=n.positionY1?ai(r,n.positionY1):ti(r,0),l=ai(r,n.positionY2),m=fi(t,n.width,e.rect.width/e.domain.length),f=ni(t,n),o=f[0],u=f[1],i=f[2],h=hi(t,n),p=h[0],v=h[1],d=h[2],a=h[3],g=pi(t,n.tooltip),new w(s,c,l,m,i,o,u,d,p,v,a,g)},Jr=function(t,n,e,r){var o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,_,k;switch(n.space.x.length){case 1:_=n.space.x[0],l=ti(e,0),f=ai(e,_);break;default:d=n.space.x,y=d[0],_=d[1],l=ai(e,y),f=ai(e,_)}return k=n.space.y[0],h=ai(r,k),s=fi(t,n.height,r.rect.height/r.domain.length),p=ni(t,n),u=p[0],a=p[1],o=p[2],v=hi(t,n),m=v[0],w=v[1],g=v[2],c=v[3],b=pi(t,n.tooltip),new i(l,f,h,s,o,u,a,g,m,w,c,b)},Ni=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w;for(l=n.positionX,f=n.positionY1,h=n.positionY2,v=n.width,r=n.fill,d=n.stroke,s=n.lineWidth,e.save(),o=0,u=t.length;u>o;o++)i=t[o],g=l(i),m=f(i),w=h(i),p=v(i),void 0!==g&&void 0!==m&&void 0!==w&&void 0!==p&&(zr(e,g,m,w,p),e.lineWidth=2+(d?s(i):1),e.stroke());for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.fillStyle=e.strokeStyle="black",c=0,a=t.length;a>c;c++)i=t[c],g=l(i),m=f(i),w=h(i),p=v(i),void 0!==g&&void 0!==m&&void 0!==w&&void 0!==p&&(zr(e,g,m,w,p),d&&(e.lineWidth=s(i),e.stroke()),r&&e.fill());return e.restore()},qi=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w;for(h=n.positionX1,d=n.positionX2,p=n.positionY,o=n.height,r=n.fill,v=n.stroke,l=n.lineWidth,e.save(),a=0,s=t.length;s>a;a++)u=t[a],g=h(u),m=d(u),w=p(u),i=o(u),void 0!==g&&void 0!==m&&void 0!==w&&void 0!==i&&(Mr(e,g,m,w,i),e.lineWidth=2+(v?l(u):1),e.stroke());for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.fillStyle=e.strokeStyle="black",f=0,c=t.length;c>f;f++)u=t[f],g=h(u),m=d(u),w=p(u),i=o(u),void 0!==g&&void 0!==m&&void 0!==w&&void 0!==i&&(Mr(e,g,m,w,i),v&&(e.lineWidth=l(u),e.stroke()),r&&e.fill());return e.restore()},Li=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m;for(c=n.positionX,l=n.positionY1,f=n.positionY2,p=n.width,h=n.stroke,a=n.lineWidth,e.save(),o=0,u=t.length;u>o;o++)i=t[o],v=c(i),g=l(i),m=f(i),d=p(i),void 0!==v&&void 0!==g&&void 0!==m&&void 0!==d&&(s=r.put(i),zr(e,v,g,m,d),Xr(e,s),h&&Fr(e,s,a(i)));return e.restore()},ji=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m;for(f=n.positionX1,h=n.positionX2,d=n.positionY,o=n.height,p=n.stroke,c=n.lineWidth,e.save(),a=0,s=t.length;s>a;a++)u=t[a],v=f(u),g=h(u),m=d(u),i=o(u),void 0!==v&&void 0!==g&&void 0!==m&&void 0!==i&&(l=r.put(u),Mr(e,v,g,m,i),Xr(e,l),p&&Fr(e,l,c(u)));return e.restore()},ru=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(s=n.positionX,c=n.positionY1,l=n.positionY2,d=n.width,r=n.fill,f=n.stroke,a=n.lineWidth,e.save(),o=0,u=t.length;u>o;o++)i=t[o],p=s(i),v=c(i),g=l(i),h=d(i),void 0!==p&&void 0!==v&&void 0!==g&&void 0!==h&&(zr(e,p,v,g,h),f&&Fr(e,f(i),a(i)),r&&Xr(e,r(i)));return e.restore()},eu=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(l=n.positionX1,f=n.positionX2,h=n.positionY,o=n.height,r=n.fill,d=n.stroke,c=n.lineWidth,e.save(),a=0,s=t.length;s>a;a++)u=t[a],p=l(u),v=f(u),g=h(u),i=o(u),void 0!==p&&void 0!==v&&void 0!==g&&void 0!==i&&(Mr(e,p,v,g,i),d&&Fr(e,d(u),c(u)),r&&Xr(e,r(u)));return e.restore()},bu=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d,p,v,g,m,w,b,y;for(c=n.positionX,l=n.positionY1,f=n.positionY2,p=n.width,h=[],a=0,s=t.length;s>a;a++)u=t[a],v=c(u),w=l(u),b=f(u),w>b&&(y=w,w=b,b=y),d=p(u),void 0!==v&&void 0!==w&&void 0!==b&&void 0!==d&&(g=v-d/2,m=v+d/2,e>m||g>i||r>b||w>o||h.push(u));return h},wu=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d,p,v,g,m,w,b,y;for(f=n.positionX1,h=n.positionX2,d=n.positionY,a=n.height,p=[],c=0,l=t.length;l>c;c++)s=t[c],v=f(s),g=h(s),w=d(s),v>g&&(m=v,v=g,g=m),u=a(s),void 0!==v&&void 0!==g&&void 0!==w&&void 0!==u&&(b=w-u/2,y=w+u/2,e>g||v>i||r>y||b>o||p.push(s));return p},yr=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b;switch(g=Cu(n)){case"String, Number, Number, Number, Number, Number":return w=n[0],i=n[1],o=n[2],u=n[3],a=n[4],s=n[5],d=new yn([w],[i,o,u,a,s]),m=null!=(c=t.width)?c:new P(.8),l=zi(t.strokeColor,t.strokeOpacity,t.lineWidth),p=l[0],v=l[1],r=l[2],new an(d,w,i,o,u,a,s,m,p,v,r,t.tooltip);case"Number, Number, Number, Number, Number, String":return i=n[0],o=n[1],u=n[2],a=n[3],s=n[4],b=n[5],d=new yn([i,o,u,a,s],[b]),e=null!=(f=t.height)?f:new P(.8),h=zi(t.strokeColor,t.strokeOpacity,t.lineWidth),p=h[0],v=h[1],r=h[2],new rn(d,i,o,u,a,s,b,e,p,v,r,t.tooltip)}},si=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g;return u=ai(e,n.q0),a=ai(e,n.q1),s=ai(e,n.q2),c=ai(e,n.q3),l=ai(e,n.qn),g=ai(r,n.positionY),i=fi(t,n.height,r.rect.height/r.domain.length),f=hi(t,n),d=f[0],p=f[1],h=f[2],o=f[3],v=pi(t,n.tooltip),new nn(u,a,s,c,l,g,i,h,d,p,o,v)},Oi=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(l=n.positionY,f=n.q0,h=n.q1,d=n.q2,p=n.q3,v=n.qn,r=n.height,g=n.stroke,s=n.lineWidth,e.save(),o=0,u=t.length;u>o;o++)i=t[o],Ar(e,f(i),h(i),d(i),p(i),v(i),l(i),r(i),g(i),2+(g?s(i):1));for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.strokeStyle="black",c=0,a=t.length;a>c;c++)i=t[c],Ar(e,f(i),h(i),d(i),p(i),v(i),l(i),r(i),g(i),s(i));return e.restore()},Vi=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y;for(f=n.positionY,h=n.q0,d=n.q1,p=n.q2,v=n.q3,g=n.qn,o=n.height,m=n.stroke,c=n.lineWidth,e.save(),a=0,s=t.length;s>a;a++)u=t[a],w=h(u),b=g(u),y=f(u),i=o(u),void 0!==w&&void 0!==b&&void 0!==y&&void 0!==i&&(l=r.put(u),Mr(e,w,b,y,i),Xr(e,l),Fr(e,l,c(u)));return e.restore()},du=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p;for(s=n.positionY,c=n.q0,l=n.q1,f=n.q2,h=n.q3,d=n.qn,r=n.height,p=n.stroke,a=n.lineWidth,e.save(),o=0,u=t.length;u>o;o++)i=t[o],Ar(e,c(i),l(i),f(i),h(i),d(i),s(i),r(i),p(i),a(i));return e.restore()},_u=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,_,k,x,C,S;for(h=n.positionY,d=n.q0,p=n.q1,v=n.q2,g=n.q3,m=n.qn,a=n.height,b=n.stroke,f=n.lineWidth,w=[],c=0,l=t.length;l>c;c++)s=t[c],y=d(s),_=m(s),x=h(s),y>_&&(k=y,y=_,_=k),u=a(s),void 0!==y&&void 0!==_&&void 0!==x&&void 0!==u&&(C=x-u/2,S=x+u/2,e>_||y>i||r>S||C>o||w.push(s));return w},ci=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g;return g=ai(e,n.positionX),o=ai(r,n.q0),u=ai(r,n.q1),a=ai(r,n.q2),s=ai(r,n.q3),c=ai(r,n.qn),v=fi(t,n.width,e.rect.width/e.domain.length),l=hi(t,n),h=l[0],d=l[1],f=l[2],i=l[3],p=pi(t,n.tooltip),new on(g,o,u,a,s,c,v,f,h,d,i,p)},Ei=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g;for(c=n.positionX,l=n.q0,f=n.q1,h=n.q2,d=n.q3,p=n.qn,g=n.width,v=n.stroke,a=n.lineWidth,e.save(),i=0,o=t.length;o>i;i++)r=t[i],Pr(e,c(r),l(r),f(r),h(r),d(r),p(r),g(r),v(r),2+(v?a(r):1));for(e.restore(),e.save(),e.globalCompositeOperation="destination-out",e.strokeStyle="black",s=0,u=t.length;u>s;s++)r=t[s],Pr(e,c(r),l(r),f(r),h(r),d(r),p(r),g(r),v(r),a(r));return e.restore()},Di=function(t,n,e,r){var i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y;for(c=n.positionX,l=n.q0,f=n.q1,h=n.q2,d=n.q3,p=n.qn,m=n.width,v=n.stroke,a=n.lineWidth,e.save(),o=0,u=t.length;u>o;o++)i=t[o],w=c(i),b=l(i),y=p(i),g=m(i),void 0!==w&&void 0!==b&&void 0!==y&&void 0!==g&&(s=r.put(i),zr(e,w,b,y,g),Xr(e,s),Fr(e,s,a(i)));return e.restore()},pu=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p;for(a=n.positionX,s=n.q0,c=n.q1,l=n.q2,f=n.q3,h=n.qn,p=n.width,d=n.stroke,u=n.lineWidth,e.save(),i=0,o=t.length;o>i;i++)r=t[i],Pr(e,a(r),s(r),c(r),l(r),f(r),h(r),p(r),d(r),u(r));return e.restore()},ku=function(t,n,e,r,i,o){var u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,_,k,x,C,S;for(l=n.positionX,f=n.q0,h=n.q1,d=n.q2,p=n.q3,v=n.qn,b=n.width,m=n.stroke,c=n.lineWidth,g=[],a=0,s=t.length;s>a;a++)u=t[a],y=l(u),x=f(u),C=v(u),x>C&&(S=x,x=C,C=S),w=b(u),void 0!==y&&void 0!==x&&void 0!==C&&void 0!==w&&(_=y-w/2,k=y+w/2,e>k||_>i||r>C||x>o||g.push(u));return g},gr=function(t,n){var e,r,i,o,u,a,s;return r=n[0],i=n[1],u=new yn([r],[i]),o=zi(t.strokeColor,t.strokeOpacity,t.lineWidth),a=o[0],s=o[1],e=o[2],new Mt(u,r,i,a,s,e,t.tooltip)},oi=function(t,n,e,r){var i,o,u,a,s,c,l,f;return o=ai(e,n.positionX),u=ai(r,n.positionY),a=hi(t,n),c=a[0],l=a[1],s=a[2],i=a[3],f=pi(t,n.tooltip),new Yt(o,u,s,c,l,i,f)},Wi=function(t,n,e){var r,i,o,u,a,s,c;for(u=n.positionX,a=n.positionY,e.save(),i=0,o=t.length;o>i;i++)r=t[i],s=u(r),c=a(r),e.lineWidth=1.5,e.strokeStyle="black",void 0!==s&&void 0!==c&&(Lr(e,s,c,64),e.stroke());return e.restore()},Ri=function(t,n,e,r){var i,o,u,a,s,c,l;for(a=n.positionX,s=n.positionY,e.save(),o=0,u=t.length;u>o;o++)i=t[o],c=a(i),l=s(i),void 0!==c&&void 0!==l&&(Lr(e,c,l,64),e.fillStyle=r.put(i),e.fill());return e.restore()},cu=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,d,p,v,g,m,w,b,y,_;if(f=n.positionX,h=n.positionY,d=n.stroke,c=n.lineWidth,d instanceof T&&c instanceof T){for(e.strokeStyle=d(),e.lineWidth=c(),e.save(),r=!1,u=0,a=t.length;a>u;u++)o=t[u],g=f(o),b=h(o),void 0!==g&&void 0!==b?r?e.lineTo(g,b):(e.beginPath(),r=!0,e.moveTo(g,b)):(r&&e.stroke(),r=!1);return e.restore()}for(e.save(),e.lineCap="round",r=!1,m=void 0,y=void 0,p=void 0,l=0,s=t.length;s>l;l++)o=t[l],w=f(o),_=h(o),void 0!==w&&void 0!==_?(v=d(o),r&&(v!==p?(i=e.createLinearGradient(m,y,w,_),i.addColorStop(0,p||Rn),i.addColorStop(1,v||Rn),e.strokeStyle=i):e.strokeStyle=v,e.lineWidth=c(o),e.beginPath(),e.moveTo(m,y),e.lineTo(w,_),e.stroke()),r=!0,m=w,y=_,p=v):r=!1;return e.restore()},hr=Er([Pt,Array,mr],[Xt,Array,gr],[Kt,Array,br],[tn,Array,yr]),De=Er([bt,cr]),Ft=new at(ui,Bi,Ti,fu,yu),It=new at(oi,Ri,Wi,cu,yu),b=new at(Qr,Li,Ni,ru,bu),o=new at(Jr,ji,qi,eu,wu),en=new at(si,Vi,Oi,du,_u),un=new at(ci,Di,Ei,pu,ku),to=Er([Number,null,function(t,n){return new s(t,void 0)}],[null,Number,function(t,n){return new s(void 0,n)}],[Number,Number,function(t,n){return new s(t,n)}],[null,null,function(){return new s(void 0,void 0)}]),io=Er([Number,Number,function(t,n){return new G(t,n)}]),oo=Er([Number,Number,function(t,n){return new U(t,n)}]),lo=Er([ut,_.identity],[Function,function(t){return new L(t)}]),Vo=Er([Number,function(t){return new Ot(t)}],[Boolean,function(t){return new a(t)}],[Date,function(t){return new R(t)}],[String,function(t){return new kn(t)}]),Yo=Er([Array,function(t){return new h(t)}],[Number,function(t){return t>0?new fn(0,t):0>t?new fn(t,0):new H(-1,0,1)}],[String,function(t){return new ln(t,"black")}],[Number,Number,function(t,n){return n>=t?new fn(t,n):new fn(n,t)}],[String,String,function(t,n){return new ln(t,n)}],[Number,Number,Number,function(t,n,e){var r,i,o,u;return u=_.sortBy([t,n,e],_.identity),r=u[0],i=u[1],o=u[2],new H(r,i,o)}],[String,String,String,function(t,n,e){return new D(t,n,e)}]),Ee=function(t){var n,e,r,i,o;for(i=[],e=0,r=t.length;r>e;e++)if(n=t[e],n instanceof et)i.push(n);else{if(zn!==(o=Su(n)))throw new Error("Cannot create vector reference from ["+n+"] of type ["+o+"].");i.push(new et(n))}return i},Eo=function(){var t,n,e;return n=1<=arguments.length?Ou.call(arguments,0):[],new Lt(_.every(n,function(t){return t instanceof Bn})?function(){var e,r,i;for(i=[],e=0,r=n.length;r>e;e++)t=n[e],i.push(new W(t.value));return i}():function(){var t,r,i,o;for(i=Ee(n),o=[],t=0,r=i.length;r>t;t++)e=i[t],o.push(new Vn(e));return o}())},so=Er([kn,function(t){return new O(chroma(t.value))}],[String,function(t){return new Hn(new et(t))}],[et,function(t){return new Hn(t)}],[String,q,function(t,n){return new Hn(new et(t),n)}],[et,q,function(t,n){return new Hn(t,n)}],[String,h,function(t,n){return new Hn(new et(t),n)}],[et,h,function(t,n){return new Hn(t,n)}]),co=Er([Ot,function(t){return new E(t.value)}],[String,function(t){return new $n(new et(t))}],[et,function(t){return new $n(t)}],[String,fn,function(t,n){return new $n(new et(t),n)}],[et,fn,function(t,n){return new $n(t,n)}]),jo=Er([kn,function(t){return new z(chroma(t.value))}],[String,function(t){return new Qn(new et(t))}],[et,function(t){return new Qn(t)}],[String,q,function(t,n){return new Qn(new et(t),n)}],[et,q,function(t,n){return new Qn(t,n)}],[String,h,function(t,n){return new Qn(new et(t),n)}],[et,h,function(t,n){return new Qn(t,n)}]),Lo=Er([Ot,function(t){return new A(t.value)}],[String,function(t){return new Zn(new et(t))}],[et,function(t){return new Zn(t)}],[String,fn,function(t,n){return new Zn(new et(t),n)}],[et,fn,function(t,n){return new Zn(t,n)}]),Yr=function(t,n){return Er([Ot,function(n){return new t(n.value)}],[String,function(t){return new n(new et(t))}],[et,function(t){return new n(t)}],[String,fn,function(t,e){return new n(new et(t),e)}],[et,fn,function(t,e){return new n(t,e)}])},Po=Yr(M,Jn),Ho=Yr(P,ne),go=Yr(Y,Gn),ko=Er([Ot,function(t){return new X(t.value)}],[String,function(t){return new Un(new et(t))}],[et,function(t){return new Un(t)}],[String,fn,function(t,n){return new Un(new et(t),n)}],[et,fn,function(t,n){return new Un(t,n)}]),Ao=Er([kn,function(t){return new I(t.value)}],[String,function(t){return new Kn(new et(t))}],[et,function(t){return new Kn(t)}],[String,h,function(t,n){return new Kn(new et(t),n)}],[et,h,function(t,n){return new Kn(t,n)}]),Bo=function(){var t;return t=1<=arguments.length?Ou.call(arguments,0):[],new te(Ee(t))},Mo=function(){var t,n;return n=1<=arguments.length?Ou.call(arguments,0):[],1===n.length&&_.isNumber(t=_.head(n))?new Gt(t):new cn(Ee(n))},Jo=function(t){var n,e,r,i,o;for(o=[],e=0,r=t.length;r>e;e++)switch(n=t[e],n.type){case"string":o.push({label:n.name,type:"String",domain:null!=(i=n.lightningDomain)?i:[],parse:ye});break;case"integer":o.push({label:n.name,type:"Number",parse:_e});break;case"number":o.push({label:n.name,type:"Number",parse:ke});break;default:throw new Error("Invalid type ["+n.type+"] for schema field ["+n.name+"]")}return o},Ko=function(t,n,e,r){var i,o,u,a,s,c,l,f;return a=Papa.parse(e,{skipEmptyLines:!0}),c=a.data,r&&c.shift(),f=function(){var t,r,a,f,h;for(h=[],u=t=0,r=n.length;r>t;u=++t){for(i=n[u],e=new Array(c.length),o=f=0,a=c.length;a>f;o=++f)s=c[o],void 0!==(l=i.parse(s[u]))&&(e[o]=l);switch(i.type){case"String":h.push(ir(i.label,i.type,e,i.domain));break;case"Number":h.push(Nr(i.label,i.type,e,_.identity));break;default:h.push(void 0)}}return h}(),ar(t,f,_.range(c.length))},no=function(t,n,e,r,i){return function(o){var u,a,s,c,l,f;return l=Math.floor((e-n)/r),u=function(t){return n+t*r},s=function(t,n){var e;return e=function(t){return n(u(t))},sr(t,t,"Number",l,e,_.identity)},f=function(){var t;t=[];for(c in i)a=i[c],t.push(s(c,a));return t}(),f.unshift(sr(t,t,"Number",l,u,_.identity)),o(null,ar("computed",f,_.range(l)))}},ro=function(t){return function(n){return jr("json",t+"/datapackage.json",function(e,r){var i,o;return e?n(e):(i=_.head(r.resources))?(o=i.path)?jr("text",t+"/"+o,function(t,e){if(t)return n(t);try{return n(null,Ko(r.name,Jo(i.schema),e,!0))}catch(o){return t=o,n(t)}}):n(new Error("Resource is missing attribute [path].")):n(new Error("No resources found in data package."))})}},er=function(){var t,n;return t=arguments[0],n=2<=arguments.length?Ou.call(arguments,1):[],function(){var e;return e=1<=arguments.length?Ou.call(arguments,0):[],we(t,xi(e,n))}},Oo=er(Pt,Lt,hn,mn,it,ot,Cn,Sn,yt,jn),Xo=er(Kt,Lt,ue,dt,it,ot,Cn,Sn,yt,jn),To=er(Xt,Lt,Cn,Sn,yt,jn),Io=er(tn,Lt,ue,dt,Cn,Sn,yt,jn),_o=er(bt,Lt,Cn,Sn,yt),Wo=function(t,n){var e;return e=function(t,n){var r,i,o,u;if(_.isArray(t)){for(i=t.length,o=[];i--;)r=t[i],null!==r&&_.isObject(r)?(e(r,n),o.push(n(r))):o.push(void 0);return o}u=[];for(i in t)Yu.call(t,i)&&(r=t[i],null!==r&&_.isObject(r)?(e(r,n),u.push(n(r))):u.push(void 0));return u},function(r){var i;return i=t.parse(r),e(i,function(t){var n;"CallExpression"===t.type&&"Identifier"===t.callee.type?_.isFunction(Ui[n=t.callee.name])&&(t.callee={type:"MemberExpression",computed:!1,object:{type:"Identifier",name:"plot"},property:{type:"Identifier",name:n}}):"Identifier"===t.type&&_.isFunction(Ui[n=t.name])&&(delete t.name,t.type="MemberExpression",t.computed=!1,t.object={type:"Identifier",name:"plot"},t.property={type:"Identifier",name:n})}),n.generate(i)}},zo={maxCanvasSize:new gn(795,600),visualizationSize:new gn(300,300),axisLabelFont:"10px monospace",axisTickColor:"#4d4d4d",axisTitleFont:"bold 10px monospace",axisLabelColor:"#4d4d4d",gridLineColor:"#eee",originLineColor:"#ccc"},$o=function(t){return Math.round(t)+"px"},Qe=function(t,n){var e,r,i,o;e=document.createElement(t),i=e.style;for(r in n)o=n[r],i[r]=o;return e},Qo=function(t){for(var n;n=t.firstChild;)t.removeChild(n)},Sr=function(t){var n,e;n=document.createElement("style"),n.type="text/css",n.innerHTML=t,e=_.head(document.getElementsByTagName("head")),e.appendChild(n)},qr=function(t){var n,e,r,i,o,u,a,s,c;return e=diecut("table","tbody","tr","th","td"),i=e[0],o=e[1],s=e[2],a=e[3],u=e[4],r=function(){var e;e=[];for(n in t)c=t[n],e.push(s([u(n+":"),a(c)]));return e}(),au(i(o(r)))},Ge=function(t){var n,e,r,i,o,u,a;return a=t.width,o=t.height,i=document.createElement("canvas"),e=i.getContext("2d"),r=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,u=r/n,i.style.position="absolute",r!==n?(i.width=a*u,i.height=o*u,e.scale(u,u),i.style.width=$o(a),i.style.height=$o(o)):(i.width=a,i.height=o),new l(i,e,t,u)},Wr=function(t){var n,e,r,i,o,u,a,s,c,l,f,h;return f=function(){var n,e;for(e=[],a=n=1;5>=n;a=++n)e.push(Ge(t));return e}(),n=f[0],o=f[1],u=f[2],l=f[3],r=f[4],i=Qe("div",{position:"relative",overflow:"visible",width:$o(t.width),height:$o(t.height)}),i.className="lz",s=Qe("div",{position:"absolute",left:$o(0),top:$o(0),width:$o(0),height:$o(0),display:"none",outline:"1px dotted #999",background:"rgba(0, 0, 0, 0.05)"}),h=Qe("div",{position:"absolute",left:$o(0),top:$o(0),"max-width":$o(.9*t.width),display:"none"}),h.className="lz-tooltip",i.appendChild(n.element),i.appendChild(o.element),i.appendChild(s),i.appendChild(u.element),i.appendChild(h),c=dr(l),e=Ke(r),new re(t,i,n,o,u,l,r,s,h,c,e)},Si=function(t){var n,e,r;return r=null!=(e=t.target)?e:t.srcElement,n=r.getBoundingClientRect(),[t.clientX-n.left,t.clientY-n.top]},Se=function(t,n,e,r,i){var o,u,a,s,c,l,f,h,d,p;u=$(document),o=$(t),s=n.style,c=h=l=d=f=p=0,a=!1,o.on("mousemove",function(t){var n;return c=t.offsetX,h=t.offsetY,(void 0===c||void 0===h)&&(n=Si(t),c=n[0],h=n[1]),a?(s.left=$o(c>l?l:c),s.top=$o(h>d?d:h),s.width=$o(Math.abs(c-l)),s.height=$o(Math.abs(h-d))):e(c,h)}),o.on("mousedown",function(t){var n;return t.preventDefault(),l=t.offsetX,d=t.offsetY,(void 0===l||void 0===d)&&(n=Si(t),l=n[0],d=n[1]),a=!0,s.display="block",s.left=$o(l),s.top=$o(d),u.on("mouseup",function(t){var n;return t.preventDefault(),f=t.offsetX,p=t.offsetY,(void 0===f||void 0===p)&&(n=Si(t),f=n[0],p=n[1]),a=!1,s.display="none",s.width=$o(0),s.height=$o(0),u.off("mouseup"),Math.abs(l-f)>5||Math.abs(d-p)>5?r(l,d,f,p):i(l,d)})})},nr=function(){var t,n,e,r;return t={},e=function(n,e){var r;return(r=t[n])?r.push(e):t[n]=[e]},r=function(n,e){var r,i,o,u,a;if(n)if(e){if(a=t[n])for(r=i=0,o=a.length;o>i;r=++i)if(u=a[r],u===e){a.splice(r,1);break}}else delete t[n]},n=function(){var n,e,r,i,o,u;if(e=arguments[0],n=2<=arguments.length?Ou.call(arguments,1):[],u=t[e])for(r=0,i=u.length;i>r;r++)o=u[r],o.apply(null,n)},[e,r,n]},Tr=function(t,n,e,r,i,o,u){var a,s,c,l,f,h,d,p,v,g,m,w,b,y,k,x,C,S,q,N,W,T,O;return l=Wr(t),f=l.baseCanvas,m=l.highlightCanvas,b=l.hoverCanvas,d=l.clipCanvas,x=l.maskCanvas,y=l.marquee,T=l.tooltip,k=l.mask,h=l.clip,O=t.regions.center,s=n.indices,a=void 0,W=function(n,r){var i,o,u,a,s;if(o=k.test(n,r),void 0!==o)for(i=d.context,i.clearRect(0,0,t.width,t.height),u=0,s=e.length;s>u;u++)if(a=e[u],i.save(),i.translate(O.left,O.top),a.mask([o],a.encoders,i,h),i.restore(),h.test(n,r))return o},p=function(t,n,e){var r;return r=qr(e),Qo(T),T.appendChild(r),T.style.display="block",C(t,n)},c=7,C=function(n,e){var r,i,o,u;if("none"!==T.style.display)return u=T.clientWidth,o=T.clientHeight,r=n+c,i=e-c-o,r+u>t.width&&(r=n-c-u),0>i&&(i=e+c),0>r&&(r=0),0>i&&(i=0),T.style.left=$o(r),T.style.top=$o(i)},v=function(){return T.style.display="none"},w=function(r,i){var o,s,c,l,f,h,d,g,m,w,y,_,k,x,S;if(l=W(r,i),l!==a){if(a=l,c=b.context,c.clearRect(0,0,t.width,t.height),v(),void 0!==l){for(c.save(),c.translate(O.left,O.top),f=0,d=e.length;d>f;f++)h=e[f],h.highlight([l],h.encoders,c);for(c.restore(),u("markhover",new pt(n.vectors,l)),x={},w=0,g=e.length;g>w;w++){h=e[w],_=h.encodings;for(o in _)if(s=_[o])if(s instanceof Dn)(S=s.vector)&&(x[S.label]=S.format(l));else if(s instanceof Ln)for(k=s.vectors,y=0,m=k.length;m>y;y++)S=k[y],x[S.label]=S.format(l)}p(r,i,x)}}else C(r,i)},g=function(n){var r,i,o,u;if(r=m.context,r.clearRect(0,0,t.width,t.height),n.length){for(f.element.style.opacity=.5,r.save(),r.translate(O.left,O.top),i=0,u=e.length;u>i;i++)o=e[i],o.highlight(n,o.encoders,r),o.render(n,o.encoders,r);r.restore()}else f.element.style.opacity=1},q=function(t,e){var r;r=W(t,e),void 0!==r?(g([r]),u("markselect",new sn(n.vectors,[r]))):(g([]),u("markdeselect",new V(n.vectors)))},N=function(t,r,i,o){var a,c,l,f,h,d,p;h=-O.left+(t>i?i:t),f=-O.left+(t>i?t:i),p=-O.top+(r>o?o:r),d=-O.top+(r>o?r:o),l=function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)a=e[t],r.push(a.select(s,a.encoders,h,p,f,d));return r}(),c=e.length>1?_.unique(_.flatten(l,!0)):_.head(l),g(c),c.length?u("markselect",new sn(n.vectors,c)):u("markdeselect",new V(n.vectors))},S=function(){var n,u,a,c,l,h,d,p;for(u=f.context,p=x.context,ou(u,i,O),uu(u,o,O),u.save(),u.translate(O.left,O.top),p.save(),p.translate(O.left,O.top),a=0,l=e.length;l>a;a++)c=e[a],c.render(s,c.encoders,u),c.mask(s,c.encoders,p,k);for(d=0,h=r.length;h>d;d++)n=r[d],n.render(n,i,o,u);p.restore(),u.restore(),tu(u,i,t.regions.bottom),nu(u,o,t.regions.left)},Se(b.element,y,w,N,q),new ie(l,n,W,g,w,q,N,S)},Zo=function(t,n,e,r,i){var o,u,a,s,c,l,h,d,p,v,g,m,w,b,y,_,k,x,C,S,q;

if(t.font=zo.axisLabelFont,t.fillStyle=zo.axisLabelColor,t.strokeStyle=zo.axisTickColor,t.textBaseline="middle",q=ae+4,m=e-q,t.save(),We(t,q,0,m,r),t.textAlign="right",S=e-5,h=e-6,n instanceof f){for(o=n.guide(),b=Math.floor(r/(ae+2)),a=Math.floor(o.length/b),s=c=0,p=o.length;p>c;s=++c)u=o[s],_=n.scale(u),C=-.5+Math.round(_),Ir(t,S,C,e,C),(0===a||0!==s&&0===s%a)&&t.fillText(u.value,h,_,m-6);Ir(t,e-.5,0,e-.5,r)}else{if(!(n instanceof Bt))throw new Error("Invalid axis type.");for(y=6,w=r-6,k=n.guide(),g=0,v=k.length;v>g;g++)x=k[g],l=x.label,_=n.scale(x.value),C=Math.max(.5,-.5+Math.round(_)),Ir(t,S,C,e,C),d=y>_?y:_>w?w:_,t.fillText(l,h,d,m-6);Ir(t,e-.5,0,e-.5,r)}return t.restore(),t.font=zo.axisTitleFont,t.textAlign="center",t.translate(q/2,r/2),t.rotate(i*lt),t.fillText(n.label,0,0,r),t.restore()},iu=function(t,n,e,r){var i,o,u,a,s;if(t.strokeStyle=zo.gridLineColor,n instanceof f)Ir(t,0,.5,e,.5),Ir(t,0,r-.5,e,r-.5);else if(n instanceof Bt){for(u=n.guide(),i=0,o=u.length;o>i;i++)a=u[i],s=Math.max(.5,-.5+Math.round(n.scale(a.value))),Ir(t,0,s,e,s);n.domain.min<=0&&0<=n.domain.max&&(t.strokeStyle=zo.originLineColor,s=Math.max(.5,-.5+Math.round(n.scale(0))),Ir(t,0,s,e,s))}},ou=function(t,n,e){return t.save(),t.translate(e.left,e.top+e.height),t.rotate(-lt),iu(t,n,e.height,e.width),t.restore()},uu=function(t,n,e){return t.save(),t.translate(e.left,e.top),iu(t,n,e.width,e.height),t.restore()},tu=function(t,n,e){return t.save(),t.translate(e.left,e.top+e.height),t.rotate(-lt),Zo(t,n,e.height,e.width,1),t.restore()},nu=function(t,n,e){return t.save(),t.translate(e.left,e.top),Zo(t,n,e.width,e.height,-1),t.restore()},au=function(t){var n;return n=document.createElement("div"),n.innerHTML=t,n.childNodes[0]},yi=function(t,n){var e,r,i,o,u,a,s;for(r={},i=[],a=0,s=n.length;s>a;a++)o=n[a],u=(e=t.at(o)).key,r[u]||(r[u]=!0,i.push(e));return i},xr=function(t,n){var e,r,i,o,u,a;for(u=null,r=null,e=null,i=0,o=t.length;o>i;i++)if(a=t[i],null===u)switch(u=a.type){case zn:e=a,r=yi(a,n);break;case Xn:r=a.domain;break;default:throw new Error("ni")}else{if(u!==a.type)throw new Error("Incompatible axis vector ["+a.label+"]. Expect type ["+u+"], got ["+a.type+"]");switch(u){case zn:if(e!==a)throw new Error("Incompatible categorical vector ["+a.label+"]. Expected ["+e.label+"].");break;case Xn:r=Xe(r,a.domain);break;default:throw new Error("ni")}}return new bn(u,t,r)},$e=function(t){var n,e;return n=function(){var n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(e.label);return i}(),_.unique(n).join(", ")},Ie=function(t,n){var e,r,i,o,u,a,c,l,h,d,p,v,g;if(p=new Ut(0,0,400,400),e=He(t,"",n,new fn(0,p.width),p),d=ae+4+6+10,e instanceof f){for(l=0,r=e.guide(),o=0,u=r.length;u>o;o++)i=r[o],l<(c=(""+i.value).length)&&(l=c);return new s(Math.ceil(l*ae+d),Math.ceil(r.length*(ae+8)))}if(e instanceof Bt){for(l=0,r=e.guide(),v=e.guide(),h=0,a=v.length;a>h;h++)g=v[h],l<(c=g.label.length)&&(l=c);return new s(Math.ceil(l*ae+d),zo.visualizationSize.height)}throw new Error("Invalid axis type.")},He=function(t,n,e,r,i){var o,u,a,s,c;switch(t){case zn:return a=vr(e,r),o=function(){return e},new f(t,n,a,e,r,i,o);case Xn:return u=pr(e,r),a=u[0],s=u[1],c=u[2],o=function(t){var n,e,r,i,o,u;for(null==t&&(t=10),n=s(t),i=c(t),o=[],e=0,r=i.length;r>e;e++)u=i[e],o.push(new Fn(u,n(u)));return o},new _t(t,n,a,e,r,i,o);default:throw new Error("Unhandled axis type ["+t+"].")}},gu=function(t,n){var e,r;return r=wr(n),e=Uo(t,r),ki(n,cn)?vu(e,n):ki(n,Gt)?hu(e,n):lu(e,n)},hu=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p,v,g,m;return u=ki(n,Gt),i=u.index,a=diecut("table.lz-record","tbody","tr","th","td"),c=a[0],l=a[1],d=a[2],h=a[3],f=a[4],p=function(){var n,e;n=t.schema,e=[];for(o in n)m=n[o],g=m.format(i),r=function(){switch(m.type){case zn:return void 0!==g?g:Tt;case Xn:return void 0!==g?_.escape(g):Tt;case In:return void 0!==g?g:Tt;default:throw new Error("Cannot render table cell of type "+m.type)}}(),e.push(d([h(_.escape(m.label)),f(r)]));return e}(),e=au(c(l(p))),s=_.noop,v=_.noop,new zt(e,s,v)},vu=function(t,n){var e,r,i,o,u,a,s,c,l,f,h,d,p,g,m,w,b,y,k,x,C,S,q,N;return s=ki(n,cn),q=function(){var n,e,i,o;if(s.fields.length){for(i=s.fields,o=[],n=0,e=i.length;e>n;n++)r=i[n],o.push(t.evaluate(r));return o}return t.vectors}(),N=_.flatten(q),u=diecut("table.lz-table","thead","tbody","tr","th","th.lz-number","td","td.lz-number"),l=u[0],m=u[1],f=u[2],y=u[3],g=u[4],w=u[5],h=u[6],d=u[7],b=function(){var t,n,e;for(e=[],t=0,n=N.length;n>t;t++)switch(S=N[t],S.type){case Xn:e.push(w(_.escape(S.label)));break;default:e.push(g(_.escape(S.label)))}return e}(),k=function(){var n,e,r,o;for(r=t.indices,o=[],n=0,e=r.length;e>n;n++)i=r[n],p=function(){var t,n,e;for(e=[],n=0,t=N.length;t>n;n++)switch(S=N[n],C=S.format(i),S.type){case zn:e.push(h(void 0!==C?C:Tt));break;case Xn:e.push(d(void 0!==C?_.escape(C):Tt));break;case In:e.push(h(void 0!==C?C:Tt));break;default:throw new Error("Cannot render table cell of type "+S.type)}return e}(),o.push(y(p));return o}(),e=au(l([m(y(b)),f(k)])),a=nr(),c=a[0],x=a[1],o=a[2],$(e).on("click",function(n){var e,r,i,u,a,s;switch(r=$(n.target),e=r.parent(),u=e.prop("tagName").toLowerCase(),s=r.prop("tagName").toLowerCase(),a=r.index(),i=e.index(),s){case"td":o("cellselect",new v(N[a],t.indices[i]));break;case"th":o("headerselect",new ht(N[a]))}}),new zt(e,c,x)},Me=function(t,n,e){return t.type===Xn?e?Xe(t.domain,e):n.type===zn?Yi(t.domain):t.domain:t.domain},lu=function(t,n){var r,i,o,u,a,l,f,h,d,p,v,g,m,w,b,y,k,x,C,S,q,N,W,T,O,E,Y,X,I,M;return b=_.map(bi(n,qt),function(n){var e,r;return r=function(){var r,i,o,u;for(o=n.position.coordinates,u=[],r=0,i=o.length;i>r;r++)e=o[r],u.push(t.evaluate(e.field));return u}(),hr(n,_.flatten(r))}),O=_.map(b,function(t){return t.space}),X=Ci(O,function(t){return t.x}),I=Ci(O,function(t){return t.y}),W=xr(X,t.indices),T=xr(I,t.indices),g=Me(W,T,ki(n,G)),m=Me(T,W,ki(n,U)),i=Ie(W.type,g),o=Ie(T.type,m),h=null!=(C=ki(n,s))?C:new s(void 0,void 0),p=null!=(S=h.width)?S:Math.min(zo.maxCanvasSize.width,o.width+i.height),d=null!=(q=h.height)?q:Math.min(zo.maxCanvasSize.height,i.width+o.height),v=new c(p,d,new Ct(Math.min(.3*zo.maxCanvasSize.width,o.width),0,0,Math.min(.3*zo.maxCanvasSize.height,i.width))),u=v.regions.bottom,a=v.regions.left,k=new fn(0,u.width),x=T.type===Xn?new fn(a.height,0):new fn(0,a.height),l=He(W.type,$e(X),g,k,u),f=He(T.type,$e(I),m,x,a),w=_.map(b,function(n){var e,r,i,o,u;i=n.geometry,r=i.encode(t,n,l,f),e={};for(o in r)u=r[o],(null!=u?u.encode:void 0)&&(e[o]=u.encode);return new vt(r,e,i.mask,i.highlight,i.render,i.select)}),r=_.map(bi(n,e),function(t){return De(t)}),N=nr(),E=N[0],Y=N[1],y=N[2],M=Tr(v,t,w,r,l,f,y),M.render(),new zt(M.viewport.container,E,Y)},qu=Er([L,Array,Function,function(t,n,e){return t.read(function(t,r){return t?e(t):qu(r,n,e)})}],[ut,Array,Function,function(t,n,e){var r;try{return e(null,gu(t,n))}catch(i){return r=i,e(r)}}]),Fi=function(){return Sr(".lz-tooltip {\n  background: #2c2c2c;\n  color: #fff;\n  font-size: 12px;\n}\n.lz-tooltip th, .lz-tooltip td {\n  padding: 0px 4px;\n  vertical-align: middle;\n}\n.lz-tooltip th {\n  text-align: left;\n}\n.lz-table th, .lz-table td {\n  padding: 0px 8px;\n  vertical-align: middle;\n}\n.lz-table tbody > tr:nth-child(odd) {\n  background-color: #f3f3f3;\n}\n.lz-table .lz-number {\n  text-align: right;\n}\n.lz-record th, .lz-record td {\n  padding: 0px 8px;\n  vertical-align: middle;\n}\n.lz-record th {\n  text-align: right;\n}\n.lz-record tbody > tr:nth-child(odd) {\n  background-color: #f3f3f3;\n}")},ce=null,ae=18,Pi=function(){var t,n;return ce=t=Ge(new s(100,100)),n=t.context,n.font=zo.axisLabelFont,ae=n.measureText("M").width},se=!1,Ai=function(){return se?void 0:(Fi(),Pi(),se=!0)},Ui=function(){var t,n;return n=1<=arguments.length?Ou.call(arguments,0):[],(t=ki(n,L,ut))?(Ai(),function(e){var r;return r=_.isElement(e)?function(t,n){return t?e.innerHTML=t.message:e.appendChild(n.element)}:_.isFunction(e)?e:void 0,r?qu(t,_.without(n,t),r):void 0}):function(){var t;return t=1<=arguments.length?Ou.call(arguments,0):[],Ui.apply(null,n.concat(t))}},Ui.VERSION="0.1.17",Ui.settings=zo,Ui.bounds=to,Ui.from=lo,Ui.value=Vo,Ui.range=Yo,Ui.position=Eo,Ui.fillColor=so,Ui.fillOpacity=co,Ui.strokeColor=jo,Ui.strokeOpacity=Lo,Ui.size=Po,Ui.width=Ho,Ui.height=go,Ui.lineWidth=ko,Ui.shape=Ao,Ui.tooltip=Bo,Ui.factor=ao,Ui.stack=Fo,Ui.groupBy=ho,Ui.where=Do,Ui.limit=yo,Ui.having=vo,Ui.eq=uo,Ui.ne=qo,Ui.lt=xo,Ui.gt=po,Ui.le=wo,Ui.ge=fo,Ui.like=bo,Ui.avg=Zi,Ui.count=eo,Ui.max=Co,Ui.min=So,Ui.sum=Ro,Ui.parse=Wo,Ui.point=Oo,Ui.rect=Xo,Ui.path=To,Ui.schema=Io,Ui.line=_o,Ui.select=Mo,Ui.dataPackage=ro,Ui.computed=no,Ui.createFrame=ar,Ui.createVector=Nr,Ui.createList=fr,Ui.createFactor=ir,Ui.domainX_HACK=io,Ui.domainY_HACK=oo,null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=Ui:window.plot=Ui}).call(this);
